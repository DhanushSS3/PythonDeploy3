2025-07-06 21:12:08,644 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-06 21:12:08,645 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-06 21:12:08,648 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-06 21:12:08,648 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-06 21:12:08,656 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 21:12:08,656 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 21:12:08,656 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 21:12:08,656 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 4, 47, 8, 656126), 'iat': datetime.datetime(2025, 7, 7, 4, 12, 8, 656128)}
2025-07-06 21:12:08,659 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 21:12:14,177 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 21:12:14,177 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 21:12:14,178 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751862751, 'iat': 1751860951}
2025-07-06 21:12:23,364 - INFO - app.core.security - Closing Redis connection...
2025-07-06 21:12:23,364 - INFO - app.core.security - Redis connection closed.
2025-07-06 21:12:32,244 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-06 21:12:32,244 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-06 21:12:32,247 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-06 21:12:32,247 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-06 21:12:32,251 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 21:12:32,251 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 21:12:32,251 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 21:12:32,251 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 4, 47, 32, 251756), 'iat': datetime.datetime(2025, 7, 7, 4, 12, 32, 251758)}
2025-07-06 21:12:32,252 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 21:12:36,212 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 21:12:36,212 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 21:12:36,212 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751862751, 'iat': 1751860951}
2025-07-06 21:29:55,730 - INFO - app.core.security - Closing Redis connection...
2025-07-06 21:29:55,731 - INFO - app.core.security - Redis connection closed.
2025-07-06 23:09:52,328 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-06 23:09:52,328 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-06 23:09:52,331 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-06 23:09:52,331 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-06 23:09:52,335 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:09:52,335 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:09:52,335 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:09:52,335 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 6, 44, 52, 335730), 'iat': datetime.datetime(2025, 7, 7, 6, 9, 52, 335732)}
2025-07-06 23:09:52,337 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:09:54,532 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:09:54,533 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:09:54,534 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:10:06,668 - INFO - app.core.security - Closing Redis connection...
2025-07-06 23:10:06,669 - INFO - app.core.security - Redis connection closed.
2025-07-06 23:10:08,508 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-06 23:10:08,509 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-06 23:10:08,511 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-06 23:10:08,511 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-06 23:10:08,514 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:10:08,514 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:10:08,514 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:10:08,514 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 6, 45, 8, 514353), 'iat': datetime.datetime(2025, 7, 7, 6, 10, 8, 514355)}
2025-07-06 23:10:08,514 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:10:11,183 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:10:11,183 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:10:11,184 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:10:45,889 - INFO - app.core.security - Closing Redis connection...
2025-07-06 23:10:45,891 - INFO - app.core.security - Redis connection closed.
2025-07-06 23:10:47,997 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-06 23:10:47,997 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-06 23:10:48,011 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-06 23:10:48,011 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-06 23:10:48,014 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:10:48,015 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:10:48,015 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:10:48,015 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 6, 45, 48, 14975), 'iat': datetime.datetime(2025, 7, 7, 6, 10, 48, 14977)}
2025-07-06 23:10:48,015 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:10:50,484 - INFO - app.core.security - Closing Redis connection...
2025-07-06 23:10:50,487 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:10:50,488 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:10:50,488 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:10:50,491 - INFO - app.core.security - Redis connection closed.
2025-07-06 23:10:53,349 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-06 23:10:53,350 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-06 23:10:53,354 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-06 23:10:53,354 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-06 23:10:53,359 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:10:53,359 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:10:53,359 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:10:53,359 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 6, 45, 53, 359666), 'iat': datetime.datetime(2025, 7, 7, 6, 10, 53, 359668)}
2025-07-06 23:10:53,360 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:10:57,171 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:10:57,171 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:10:57,172 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:11:02,002 - INFO - app.core.security - Closing Redis connection...
2025-07-06 23:11:02,005 - INFO - app.core.security - Redis connection closed.
2025-07-06 23:11:04,560 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-06 23:11:04,560 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-06 23:11:04,563 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-06 23:11:04,563 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-06 23:11:04,566 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:11:04,566 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:11:04,566 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:11:04,566 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 6, 46, 4, 566482), 'iat': datetime.datetime(2025, 7, 7, 6, 11, 4, 566485)}
2025-07-06 23:11:04,566 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:11:06,624 - INFO - app.core.security - Closing Redis connection...
2025-07-06 23:11:06,625 - INFO - app.core.security - Redis connection closed.
2025-07-06 23:11:08,425 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-06 23:11:08,426 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-06 23:11:08,427 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-06 23:11:08,427 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-06 23:11:08,430 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:11:08,430 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:11:08,430 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:11:08,430 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 6, 46, 8, 430757), 'iat': datetime.datetime(2025, 7, 7, 6, 11, 8, 430759)}
2025-07-06 23:11:08,431 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:11:10,100 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:11:10,101 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:11:10,101 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:12:43,444 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:12:43,445 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:12:43,445 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:12:43,445 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 7, 6, 42, 43, 444866), 'iat': datetime.datetime(2025, 7, 7, 6, 12, 43, 444869)}
2025-07-06 23:12:43,445 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:12:43,445 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTI0NzM1NjMsImlhdCI6MTc1MTg2ODc2M30.v25y5Mqi0dcF9OKjL7ajVEXkQOHCqaEKcUIdiPYY-Xk, Expiry (seconds): 604800
2025-07-06 23:12:43,446 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-06 23:13:10,520 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:10,520 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:10,520 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:10,621 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:10,621 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:10,622 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:10,727 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:10,727 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:10,728 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:10,837 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:10,837 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:10,838 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:10,946 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:10,946 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:10,946 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:11,046 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:11,047 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:11,048 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:11,152 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:11,152 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:11,152 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:11,254 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:11,254 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:11,254 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:11,356 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:11,356 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:11,356 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:11,768 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:11,769 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:11,769 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:40,897 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:40,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:40,897 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:40,950 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:40,950 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:40,950 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:41,003 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:41,003 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:41,003 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:41,071 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:41,071 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:41,072 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:41,134 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:41,134 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:41,134 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:41,191 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:41,191 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:41,191 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:41,270 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:41,271 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:41,271 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:41,345 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:41,345 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:41,345 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:41,393 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:41,393 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:41,393 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:41,444 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:41,444 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:41,445 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:53,744 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:53,745 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:53,745 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:53,802 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:53,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:53,802 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:53,861 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:53,861 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:53,861 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:53,930 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:53,930 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:53,930 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:54,000 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:54,000 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:54,000 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:54,067 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:54,067 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:54,067 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:54,134 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:54,134 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:54,134 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:54,205 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:54,205 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:54,205 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:54,266 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:54,266 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:54,266 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:54,335 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:54,335 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:54,335 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:54,398 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:54,398 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:54,398 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:54,466 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:54,466 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:54,466 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:54,523 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:54,523 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:54,523 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:54,593 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:54,593 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:54,594 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:54,663 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:54,663 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:54,663 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:54,722 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:54,722 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:54,722 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:54,786 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:54,787 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:54,787 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:54,850 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:54,850 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:54,851 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:54,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:54,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:54,896 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:13:54,961 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:13:54,961 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:13:54,962 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:07,450 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:07,450 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:07,451 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:07,452 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:07,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:07,452 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:07,452 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:07,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:07,452 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:07,453 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:07,453 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:07,453 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:07,512 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:07,512 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:07,512 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:07,575 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:07,575 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:07,575 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:07,633 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:07,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:07,633 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:07,700 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:07,700 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:07,701 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:07,748 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:07,748 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:07,748 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:07,793 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:07,793 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:07,793 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:07,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:07,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:07,862 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,283 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,283 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,283 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,283 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,283 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,283 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,284 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,284 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,284 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,284 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,284 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,284 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,285 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,285 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,285 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,285 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,285 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,285 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,286 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,286 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,286 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,319 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,319 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,319 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,392 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,392 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,392 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,459 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,460 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,460 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,520 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,520 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,520 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,587 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,588 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,588 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,631 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,631 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,631 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,675 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,676 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,744 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,744 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,744 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,786 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,786 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,786 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,847 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,848 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,900 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,900 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,900 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:08,964 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:08,964 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:08,964 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:21,368 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:21,368 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:21,368 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:21,369 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:21,369 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:21,369 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:21,375 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:21,375 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:21,375 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:21,434 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:21,435 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:21,435 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:21,492 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:21,492 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:21,492 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:21,545 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:21,545 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:21,545 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:21,602 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:21,602 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:21,602 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:21,657 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:21,657 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:21,657 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:21,709 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:21,709 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:21,709 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:21,763 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:21,763 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:21,764 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:21,817 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:21,817 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:21,817 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:21,888 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:21,888 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:21,888 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:21,929 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:21,929 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:21,929 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:21,974 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:21,974 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:21,974 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,036 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,036 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,036 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,084 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,084 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,084 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,146 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,146 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,146 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,199 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,199 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,199 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,272 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,272 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,273 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,308 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,308 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,308 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,431 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,431 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,431 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,432 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,432 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,432 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,477 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,477 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,477 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,523 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,523 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,523 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,575 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,575 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,575 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,624 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,624 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,624 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,678 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,678 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,678 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,723 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,723 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,723 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,789 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,790 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,790 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,847 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,847 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,885 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,885 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,885 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,940 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,940 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,940 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:22,995 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:22,995 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:22,995 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:23,057 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:23,057 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:23,057 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:23,112 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:23,112 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:23,112 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:23,151 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:23,151 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:23,151 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:23,200 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:23,200 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:23,200 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:23,272 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:23,272 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:23,272 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:23,313 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:23,313 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:23,313 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:23,389 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:23,389 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:23,389 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:35,666 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:35,666 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:35,666 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:35,725 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:35,725 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:35,725 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:35,773 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:35,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:35,773 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:35,831 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:35,831 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:35,832 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:35,894 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:35,894 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:35,895 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:35,945 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:35,945 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:35,945 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,006 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,006 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,006 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,060 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,060 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,060 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,120 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,120 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,121 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,180 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,180 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,180 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,236 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,236 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,236 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,289 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,289 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,289 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,327 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,327 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,327 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,434 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,434 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,434 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,498 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,498 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,498 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,555 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,555 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,555 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,592 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,592 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,593 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,645 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,645 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,646 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,697 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,697 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,697 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,760 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,760 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,761 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,811 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,811 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,811 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,865 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,865 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,865 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,913 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,913 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,913 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:36,966 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:36,966 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:36,967 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,028 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,028 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,028 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,078 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,079 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,079 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,119 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,119 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,119 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,189 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,189 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,189 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,224 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,287 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,287 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,287 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,336 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,336 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,336 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,401 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,401 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,401 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,447 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,447 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,447 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,488 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,488 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,488 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,554 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,554 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,554 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,589 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,589 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,589 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,663 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,664 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,664 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,708 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,708 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,708 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,774 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,774 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,774 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,814 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,815 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,863 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,863 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,918 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,919 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,919 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:37,976 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:37,976 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:37,977 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:38,031 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:38,031 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:38,031 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:38,099 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:38,099 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:38,099 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:38,170 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:38,170 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:38,171 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:38,236 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:38,236 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:38,237 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:38,286 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:38,286 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:38,286 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:38,329 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:38,329 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:38,329 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:50,904 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:50,904 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:50,904 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:50,905 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:50,905 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:50,905 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:50,905 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:50,906 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:50,906 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:50,906 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:50,906 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:50,906 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:50,906 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:50,906 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:50,907 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:50,956 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:50,956 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:50,956 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:51,015 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:51,015 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:51,015 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:51,083 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:51,083 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:51,083 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:51,152 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:51,152 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:51,152 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:51,198 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:51,198 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:51,198 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:51,263 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:51,263 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:51,263 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:51,310 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:51,311 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:51,311 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:51,361 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:51,361 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:51,361 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:51,427 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:51,427 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:51,427 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:51,467 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:51,467 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:51,467 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:51,516 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:51,516 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:51,517 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:51,579 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:51,579 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:51,580 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:51,639 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:51,639 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:51,639 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:51,699 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:51,699 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:51,699 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:51,740 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:51,740 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:51,741 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:51,798 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:51,798 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:51,798 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:51,858 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:51,858 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:51,859 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:51,900 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:51,900 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:51,900 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:51,955 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:51,955 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:51,955 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:52,019 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:52,019 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:52,019 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:52,076 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:52,076 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:52,077 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:52,134 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:52,134 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:52,135 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:52,199 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:52,199 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:52,200 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:52,257 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:52,257 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:52,257 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:52,318 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:52,318 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:52,318 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:52,362 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:52,362 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:52,363 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:52,418 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:52,418 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:52,418 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:52,480 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:52,480 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:52,481 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:52,535 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:52,535 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:52,535 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:52,597 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:52,597 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:52,598 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:52,659 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:52,659 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:52,659 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:52,715 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:52,715 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:52,716 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:52,782 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:52,782 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:52,782 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:52,825 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:52,825 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:52,825 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:52,890 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:52,890 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:52,890 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:52,939 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:52,939 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:52,939 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:52,988 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:52,988 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:52,988 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:53,047 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:53,047 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:53,047 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:53,102 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:53,102 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:53,102 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:53,164 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:53,164 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:53,165 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:53,203 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:53,203 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:53,203 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:53,265 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:53,265 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:53,265 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:53,306 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:53,306 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:53,306 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:53,369 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:53,369 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:53,369 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:53,433 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:53,433 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:53,433 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:53,472 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:53,472 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:53,472 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:53,522 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:53,522 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:53,522 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:53,575 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:53,575 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:53,575 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:53,633 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:53,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:53,633 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:53,706 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:53,706 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:53,706 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:53,743 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:53,743 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:53,743 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:53,793 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:53,793 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:53,793 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:53,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:53,864 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:53,865 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:53,895 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:53,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:53,896 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:14:53,966 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:14:53,966 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:14:53,966 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:06,250 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:06,250 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:06,250 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:06,312 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:06,312 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:06,312 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:06,375 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:06,375 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:06,376 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:06,438 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:06,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:06,439 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:06,500 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:06,500 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:06,500 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:06,552 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:06,552 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:06,553 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:06,624 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:06,625 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:06,625 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:06,669 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:06,669 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:06,669 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:06,714 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:06,714 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:06,715 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:06,775 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:06,775 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:06,775 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:06,827 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:06,827 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:06,827 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:06,888 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:06,889 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:06,889 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:06,950 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:06,950 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:06,950 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:06,992 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:06,992 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:06,992 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:07,055 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:07,055 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:07,055 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:07,092 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:07,092 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:07,092 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:07,153 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:07,153 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:07,154 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:07,209 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:07,209 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:07,209 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:07,260 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:07,260 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:07,260 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:07,327 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:07,327 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:07,327 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:07,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:07,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:07,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:07,436 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:07,437 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:07,437 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:07,475 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:07,475 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:07,475 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:07,541 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:07,541 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:07,541 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:07,581 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:07,581 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:07,581 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:07,646 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:07,646 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:07,647 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:07,698 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:07,698 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:07,698 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,051 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,051 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,052 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,053 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,053 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,054 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,054 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,054 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,056 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,056 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,056 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,057 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,057 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,058 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,058 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,058 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,058 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,076 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,076 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,076 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,147 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,147 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,147 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,205 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,205 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,205 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,263 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,263 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,263 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,326 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,326 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,326 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,368 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,368 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,368 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,442 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,442 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,443 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,490 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,490 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,490 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,557 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,557 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,557 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,595 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,595 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,595 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,658 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,658 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,721 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,721 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,721 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,778 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,778 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,778 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,821 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,821 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,821 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,897 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,897 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,930 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,930 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,930 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:08,985 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:08,985 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:08,985 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:09,048 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:09,048 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:09,049 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:09,084 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:09,084 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:09,084 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:09,159 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:09,159 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:09,160 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:09,221 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:09,221 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:09,221 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:09,286 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:09,286 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:09,286 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:09,332 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:09,332 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:09,332 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:09,425 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:09,425 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:09,425 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:09,485 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:09,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:09,485 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:09,548 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:09,548 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:09,548 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:09,586 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:09,586 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:09,586 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:09,652 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:09,652 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:09,653 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:09,715 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:09,715 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:09,715 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:09,778 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:09,778 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:09,778 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:09,814 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:09,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:09,814 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:09,875 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:09,875 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:09,875 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:09,923 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:09,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:09,923 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:09,976 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:09,976 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:09,976 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:10,040 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:10,040 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:10,040 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:10,110 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:10,110 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:10,110 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:10,179 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:10,179 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:10,180 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:22,450 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:22,450 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:22,450 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:22,521 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:22,521 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:22,521 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:22,573 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:22,573 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:22,573 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:22,654 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:22,654 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:22,654 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:22,708 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:22,708 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:22,709 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:22,768 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:22,768 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:22,769 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:22,817 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:22,817 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:22,817 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:22,880 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:22,880 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:22,881 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:22,929 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:22,929 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:22,930 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,033 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,033 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,034 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,057 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,058 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,058 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,100 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,100 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,101 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,161 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,161 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,161 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,223 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,223 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,223 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,289 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,289 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,290 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,338 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,338 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,338 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,401 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,402 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,402 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,441 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,441 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,441 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,504 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,505 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,505 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,553 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,553 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,553 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,600 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,600 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,663 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,663 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,663 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,703 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,703 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,703 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,770 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,770 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,770 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,814 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,814 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,877 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,877 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,877 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,928 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,928 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,928 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:23,975 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:23,975 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:23,976 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,034 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,034 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,034 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,082 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,082 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,082 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,460 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,460 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,460 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,495 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,495 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,496 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,496 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,497 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,497 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,514 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,515 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,515 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,515 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,515 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,515 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,516 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,516 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,516 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,516 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,516 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,516 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,544 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,544 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,544 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,574 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,575 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,575 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,622 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,622 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,681 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,681 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,681 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,726 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,726 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,726 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,767 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,767 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,768 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,818 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,870 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,870 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,870 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,926 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,926 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,926 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:24,983 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:24,983 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:24,983 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,024 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,024 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,024 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,077 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,077 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,077 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,126 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,126 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,126 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,197 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,197 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,198 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,265 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,266 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,266 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,296 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,296 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,297 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,353 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,353 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,354 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,408 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,408 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,409 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,455 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,456 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,456 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,518 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,518 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,518 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,567 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,568 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,568 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,617 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,617 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,618 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,655 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,655 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,707 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,707 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,708 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,767 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,767 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,767 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,812 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,812 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,812 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,862 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,923 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,924 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:25,972 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:25,972 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:25,973 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:26,014 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:26,014 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:26,015 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:26,066 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:26,066 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:26,067 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:26,128 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:26,128 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:26,128 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:26,168 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:26,168 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:26,169 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:26,238 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:26,238 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:26,238 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:26,280 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:26,280 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:26,281 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:26,333 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:26,333 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:26,333 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:26,395 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:26,395 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:26,395 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:26,431 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:26,432 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:26,432 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:26,505 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:26,506 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:26,506 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:26,545 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:26,545 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:26,545 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:26,599 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:26,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:26,600 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:26,653 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:26,653 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:26,653 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:26,703 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:26,703 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:26,703 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:38,999 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:38,999 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:38,999 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:39,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:39,403 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:39,403 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:39,431 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:39,431 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:39,432 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:39,432 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:39,432 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:39,432 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:39,433 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:39,433 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:39,433 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:39,433 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:39,433 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:39,433 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:39,434 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:39,434 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:39,434 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:39,434 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:39,434 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:39,434 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:39,495 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:39,495 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:39,495 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:39,543 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:39,543 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:39,543 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:39,599 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:39,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:39,599 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:39,677 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:39,677 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:39,677 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:39,737 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:39,737 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:39,737 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:39,802 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:39,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:39,802 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:39,860 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:39,860 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:39,860 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:39,927 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:39,927 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:39,927 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:39,985 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:39,985 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:39,985 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:40,044 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:40,044 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:40,044 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:40,091 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:40,091 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:40,091 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:40,156 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:40,156 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:40,157 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:40,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:40,213 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:40,213 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:40,255 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:40,255 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:40,255 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:40,306 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:40,306 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:40,306 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:40,371 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:40,371 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:40,371 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:40,428 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:40,428 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:40,428 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:40,487 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:40,487 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:40,487 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:40,550 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:40,550 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:40,550 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:40,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:40,608 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:40,608 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:40,677 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:40,677 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:40,677 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:40,722 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:40,722 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:40,722 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:40,766 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:40,766 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:40,766 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:40,815 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:40,815 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:40,815 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:40,877 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:40,877 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:40,878 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:40,946 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:40,946 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:40,946 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:40,988 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:40,988 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:40,988 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:41,052 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:41,052 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:41,052 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:41,111 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:41,111 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:41,111 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:41,176 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:41,176 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:41,176 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:41,216 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:41,216 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:41,217 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:41,281 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:41,281 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:41,281 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:41,321 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:41,321 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:41,322 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:41,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:41,385 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:41,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:41,432 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:41,432 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:41,432 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:41,497 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:41,497 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:41,497 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:41,542 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:41,542 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:41,543 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:41,587 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:41,587 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:41,588 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:41,647 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:41,647 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:41,647 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:41,710 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:41,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:41,710 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:41,750 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:41,750 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:41,750 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:41,806 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:41,806 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:41,807 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:41,878 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:41,878 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:41,878 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:41,940 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:41,940 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:41,940 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:41,975 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:41,975 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:41,975 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:42,043 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:42,043 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:42,043 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:42,091 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:42,091 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:42,092 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:42,154 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:42,154 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:42,155 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:42,199 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:42,199 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:42,199 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:42,272 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:42,273 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:42,273 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:42,322 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:42,322 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:42,322 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:42,375 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:42,375 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:42,375 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:42,428 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:42,428 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:42,428 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:42,488 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:42,488 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:42,489 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:42,534 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:42,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:42,534 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:42,586 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:42,586 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:42,586 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:42,648 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:42,648 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:42,649 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:42,701 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:42,701 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:42,702 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:42,765 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:42,765 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:42,766 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:42,836 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:42,836 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:42,836 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:42,881 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:42,881 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:42,881 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:42,938 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:42,938 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:42,939 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:42,999 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:42,999 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:42,999 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:43,048 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:43,048 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:43,049 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:43,111 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:43,111 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:43,112 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:43,161 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:43,161 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:43,162 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:43,223 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:43,223 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:43,224 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:43,619 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:43,619 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:43,620 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:43,621 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:43,621 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:43,621 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:43,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:43,622 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:43,622 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:43,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:43,622 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:43,622 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:43,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:43,622 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:43,623 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:43,623 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:43,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:43,623 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:43,628 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:43,628 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:43,628 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:43,694 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:43,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:43,695 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:43,755 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:43,755 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:43,756 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:43,819 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:43,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:43,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:43,882 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:43,882 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:43,882 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:43,944 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:43,944 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:43,944 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:44,009 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:44,009 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:44,009 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:44,045 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:44,045 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:44,046 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:44,111 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:44,111 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:44,111 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:56,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:56,403 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:56,403 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:56,461 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:56,461 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:56,461 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:56,514 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:56,514 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:56,515 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:56,564 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:56,564 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:56,564 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:56,637 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:56,637 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:56,638 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:56,703 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:56,703 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:56,703 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:56,747 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:56,747 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:56,747 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:56,796 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:56,796 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:56,796 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:56,871 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:56,871 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:56,871 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:56,918 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:56,918 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:56,918 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:56,961 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:56,961 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:56,961 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:57,024 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:57,025 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:57,025 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:57,072 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:57,072 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:57,072 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:57,138 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:57,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:57,138 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:57,180 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:57,181 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:57,181 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:57,236 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:57,237 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:57,237 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:57,277 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:57,277 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:57,277 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:57,346 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:57,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:57,346 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:57,415 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:57,420 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:57,421 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:57,444 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:57,445 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:57,445 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:57,502 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:57,503 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:57,503 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:57,561 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:57,561 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:57,561 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:57,624 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:57,624 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:57,624 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:57,671 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:57,671 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:57,672 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:57,742 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:57,742 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:57,742 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:57,781 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:57,781 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:57,781 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:57,848 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:57,848 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:57,848 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:57,909 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:57,909 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:57,909 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:57,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:57,949 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:57,949 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,007 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,007 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,008 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,066 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,066 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,126 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,126 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,127 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,167 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,167 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,167 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,216 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,216 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,217 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,291 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,291 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,329 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,329 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,330 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,387 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,387 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,459 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,459 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,459 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,519 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,519 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,519 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,568 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,568 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,569 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,630 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,692 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,692 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,692 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,733 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,733 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,733 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,784 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,785 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,785 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,845 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,845 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,846 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,903 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,947 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,947 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,947 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:58,997 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:58,997 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:58,997 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:59,045 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:59,045 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:59,045 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:59,109 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:59,109 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:59,109 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:59,157 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:59,157 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:59,158 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:59,592 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:59,592 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:59,592 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:59,592 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:59,592 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:59,592 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:59,593 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:59,593 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:59,593 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:59,593 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:59,593 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:59,593 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:59,593 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:59,594 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:59,594 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:59,594 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:59,594 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:59,594 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:59,594 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:59,594 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:59,594 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:59,628 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:59,628 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:59,628 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:59,692 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:59,692 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:59,692 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:59,754 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:59,754 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:59,755 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:59,821 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:59,821 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:59,822 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:59,879 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:59,879 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:59,879 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:59,943 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:59,943 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:59,943 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:15:59,992 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:15:59,992 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:15:59,992 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:00,055 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:00,055 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:00,055 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:00,103 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:00,103 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:00,103 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:00,146 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:00,146 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:00,146 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:00,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:00,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:00,220 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:00,249 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:00,249 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:00,249 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:00,324 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:00,324 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:00,324 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:00,366 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:00,366 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:00,366 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:00,444 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:00,444 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:00,445 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:00,485 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:00,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:00,485 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:00,545 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:00,545 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:00,546 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:00,586 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:00,586 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:00,586 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:00,651 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:00,651 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:00,651 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:00,713 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:00,713 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:00,713 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:00,756 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:00,756 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:00,756 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:00,814 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:00,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:00,814 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:00,873 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:00,873 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:00,873 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:00,924 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:00,924 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:00,924 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:00,984 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:00,984 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:00,984 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:01,018 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:01,019 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:01,019 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:01,071 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:01,071 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:01,071 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:01,140 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:01,141 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:01,141 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:01,185 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:01,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:01,185 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:01,258 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:01,258 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:01,258 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:01,311 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:01,311 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:01,311 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:01,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:01,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:01,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:01,435 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:01,435 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:01,435 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:01,489 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:01,489 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:01,489 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:01,525 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:01,525 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:01,526 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:01,589 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:01,589 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:01,589 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:01,635 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:01,635 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:01,635 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:01,702 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:01,703 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:01,703 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:01,752 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:01,753 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:01,753 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:01,810 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:01,811 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:01,811 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:01,865 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:01,865 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:01,865 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:01,929 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:01,930 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:01,930 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:14,208 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:14,209 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:14,209 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:14,319 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:14,319 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:14,319 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:14,412 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:14,413 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:14,413 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:14,843 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:14,843 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:14,843 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:14,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:14,844 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:14,844 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:14,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:14,844 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:14,844 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:14,845 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:14,845 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:14,845 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:14,957 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:14,957 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:14,957 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:15,063 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:15,063 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:15,063 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:15,176 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:15,176 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:15,176 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:15,279 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:15,279 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:15,279 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:15,390 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:15,390 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:15,390 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:15,492 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:15,492 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:15,492 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:15,598 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:15,598 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:15,599 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:15,695 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:15,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:15,695 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:16,111 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:16,111 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:16,111 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:16,111 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:16,111 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:16,111 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:16,112 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:16,112 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:16,112 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:16,148 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:16,148 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:16,148 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:16,257 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:16,257 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:16,257 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:16,362 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:16,362 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:16,362 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:16,467 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:16,467 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:16,467 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:16,580 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:16,580 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:16,581 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:16,671 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:16,671 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:16,671 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:16,796 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:16,796 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:16,796 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:16,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:16,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:16,896 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:17,001 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:17,001 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:17,001 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:17,120 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:17,120 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:17,120 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:17,229 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:17,229 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:17,229 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:17,333 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:17,333 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:17,334 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:17,810 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:17,811 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:17,811 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:17,812 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:17,812 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:17,812 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:17,814 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:17,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:17,814 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:17,815 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:17,815 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:17,815 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:17,889 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:17,889 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:17,889 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:17,994 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:17,994 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:17,995 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:18,098 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:18,098 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:18,098 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:18,217 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:18,217 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:18,217 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:18,301 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:18,301 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:18,301 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:18,426 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:18,426 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:18,427 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:18,527 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:18,527 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:18,527 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:18,631 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:18,632 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:18,632 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:18,755 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:18,756 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:18,756 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:18,856 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:18,856 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:18,856 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:18,957 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:18,957 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:18,957 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:19,079 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:19,079 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:19,079 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:19,188 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:19,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:19,188 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:19,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:19,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:19,292 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:19,395 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:19,395 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:19,395 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:16:19,499 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:16:19,499 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:16:19,499 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751870563, 'iat': 1751868763}
2025-07-06 23:19:06,383 - INFO - app.core.security - Closing Redis connection...
2025-07-06 23:19:06,401 - INFO - app.core.security - Redis connection closed.
2025-07-06 23:19:08,683 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-06 23:19:08,683 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-06 23:19:08,687 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-06 23:19:08,687 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-06 23:19:08,691 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:19:08,691 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:19:08,691 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:19:08,692 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 6, 54, 8, 691875), 'iat': datetime.datetime(2025, 7, 7, 6, 19, 8, 691878)}
2025-07-06 23:19:08,692 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:19:10,267 - INFO - app.core.security - Closing Redis connection...
2025-07-06 23:19:10,268 - INFO - app.core.security - Redis connection closed.
2025-07-06 23:19:12,344 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-06 23:19:12,344 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-06 23:19:12,348 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-06 23:19:12,348 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-06 23:19:12,351 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:19:12,351 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:19:12,351 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:19:12,351 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 6, 54, 12, 351713), 'iat': datetime.datetime(2025, 7, 7, 6, 19, 12, 351716)}
2025-07-06 23:19:12,352 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:19:16,179 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:19:16,179 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:19:16,180 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:20:38,536 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:20:38,536 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:20:38,536 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:20:38,536 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:20:38,536 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-06 23:20:38,536 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:20:38,536 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:20:38,537 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:20:38,537 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:20:38,537 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-06 23:20:38,541 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-06 23:20:38,541 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-06 23:20:38,541 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-06 23:20:38,558 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:20:38,559 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:20:38,559 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:20:38,559 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:20:38,559 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-06 23:20:38,559 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:20:38,559 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:20:38,560 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:20:38,560 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:20:38,560 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-06 23:20:38,563 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-06 23:20:38,564 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-06 23:20:38,564 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-06 23:20:38,565 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:20:38,566 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:20:38,566 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:20:38,566 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:20:38,566 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-06 23:20:38,571 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-06 23:20:38,571 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-06 23:20:38,880 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:20:38,881 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:20:38,882 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:20:38,882 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:20:38,882 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-06 23:20:38,890 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-06 23:20:38,890 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-06 23:20:39,144 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:20:39,144 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:20:39,145 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:20:39,145 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:20:39,145 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-06 23:20:39,151 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-06 23:20:39,152 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-06 23:20:39,191 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:20:39,191 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:20:39,192 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751869658, 'iat': 1751867858}
2025-07-06 23:23:29,091 - INFO - app.core.security - Closing Redis connection...
2025-07-06 23:23:29,096 - INFO - app.core.security - Redis connection closed.
2025-07-06 23:23:33,564 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-06 23:23:33,564 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-06 23:23:33,567 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-06 23:23:33,568 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-06 23:23:33,573 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:23:33,573 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:23:33,573 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:23:33,574 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 6, 58, 33, 573838), 'iat': datetime.datetime(2025, 7, 7, 6, 23, 33, 573840)}
2025-07-06 23:23:33,574 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:23:36,000 - INFO - app.core.security - Closing Redis connection...
2025-07-06 23:23:36,001 - INFO - app.core.security - Redis connection closed.
2025-07-06 23:23:42,564 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-06 23:23:42,564 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-06 23:23:42,571 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-06 23:23:42,571 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-06 23:23:42,578 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:23:42,578 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:23:42,578 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:23:42,578 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 6, 58, 42, 578466), 'iat': datetime.datetime(2025, 7, 7, 6, 23, 42, 578476)}
2025-07-06 23:23:42,579 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:24:23,449 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:24:23,449 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:24:23,449 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:24:23,545 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:24:23,545 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:24:23,545 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:24:23,645 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:24:23,645 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:24:23,646 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:26:57,418 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:26:57,419 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:26:57,419 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:26:57,419 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 7, 6, 56, 57, 418698), 'iat': datetime.datetime(2025, 7, 7, 6, 26, 57, 418719)}
2025-07-06 23:26:57,419 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:26:57,420 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTI0NzQ0MTcsImlhdCI6MTc1MTg2OTYxN30.pbDqG98FPvefZXwY3kduIUJFUKLC_NB9fpU1bkIl3x4, Expiry (seconds): 604800
2025-07-06 23:26:57,420 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-06 23:27:13,325 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:27:13,325 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:27:13,325 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:27:13,426 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:27:13,426 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:27:13,426 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:28:03,416 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-06 23:28:03,416 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-06 23:28:03,419 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-06 23:28:03,419 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-06 23:28:13,408 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:28:13,409 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:28:13,409 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:48,895 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:48,895 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:48,895 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:49,010 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:49,010 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:49,010 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:49,121 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:49,121 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:49,121 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:49,230 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:49,230 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:49,231 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:49,345 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:49,345 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:49,345 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:49,442 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:49,442 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:49,443 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:49,552 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:49,552 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:49,552 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:49,655 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:49,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:49,655 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:49,750 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:49,750 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:49,750 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:49,851 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:49,851 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:49,852 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:49,970 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:49,971 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:49,971 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:50,073 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:50,073 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:50,074 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:50,171 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:50,171 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:50,172 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:50,312 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:50,313 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:50,313 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:50,413 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:50,414 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:50,414 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:50,504 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:50,505 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:50,505 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:50,587 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:50,587 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:50,587 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:50,815 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:50,815 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:50,815 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:50,818 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:50,818 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:50,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:29:50,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:29:50,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:29:50,903 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:31:19,191 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:31:19,191 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:31:19,192 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:31:25,182 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:31:25,182 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:31:25,183 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:31:31,169 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:31:31,169 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:31:31,169 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:31:37,184 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:31:37,184 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:31:37,184 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:31:43,313 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:31:43,313 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:31:43,313 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:31:49,186 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:31:49,187 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:31:49,187 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:31:53,057 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-06 23:31:53,057 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-06 23:31:53,060 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-06 23:31:53,060 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-06 23:31:55,179 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:31:55,179 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:31:55,180 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:32:00,679 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:00,679 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:00,679 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:00,774 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:00,774 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:00,775 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:00,891 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:00,891 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:00,892 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:01,002 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:01,002 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:01,003 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:01,108 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:01,108 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:01,109 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:01,217 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:01,217 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:01,217 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:01,219 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:01,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:01,219 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:32:01,317 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:01,317 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:01,317 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:01,469 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:01,470 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:01,470 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:01,530 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:01,531 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:01,531 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:01,642 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:01,642 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:01,642 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:01,748 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:01,748 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:01,748 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:01,845 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:01,845 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:01,845 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:01,931 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:01,931 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:01,931 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:02,040 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:02,040 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:02,040 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:02,147 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:02,147 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:02,148 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:02,266 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:02,266 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:02,267 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:02,375 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:02,375 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:02,376 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:02,496 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:02,496 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:02,496 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:02,600 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:02,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:02,600 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:02,723 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:02,723 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:02,723 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751871417, 'iat': 1751869617}
2025-07-06 23:32:07,208 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:07,208 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:07,209 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:32:13,237 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:13,237 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:13,237 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:32:19,185 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:19,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:19,185 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:32:25,168 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:25,168 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:25,168 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:32:31,182 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:31,182 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:31,183 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:32:37,172 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:37,172 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:37,173 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:32:43,288 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:43,288 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:43,288 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:32:49,185 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:49,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:49,185 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:32:55,190 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:32:55,190 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:32:55,191 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:33:01,189 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:33:01,189 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:33:01,190 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:33:07,177 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:33:07,177 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:33:07,177 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:33:13,173 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:33:13,173 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:33:13,173 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:33:19,180 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:33:19,180 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:33:19,180 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:33:25,183 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:33:25,183 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:33:25,183 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:33:31,180 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:33:31,180 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:33:31,180 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:33:37,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:33:37,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:33:37,178 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:33:43,282 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:33:43,282 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:33:43,282 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:33:49,175 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:33:49,175 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:33:49,175 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:33:55,197 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:33:55,198 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:33:55,198 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:34:01,173 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:34:01,173 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:34:01,173 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:34:07,189 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:34:07,189 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:34:07,189 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:34:13,182 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:34:13,182 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:34:13,183 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:34:19,177 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:34:19,177 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:34:19,178 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:34:25,174 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:34:25,174 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:34:25,175 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:34:31,172 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:34:31,172 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:34:31,173 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:34:37,196 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:34:37,196 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:34:37,197 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:34:43,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:34:43,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:34:43,203 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:34:49,184 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:34:49,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:34:49,185 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:34:55,175 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:34:55,175 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:34:55,176 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:35:01,180 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:35:01,180 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:35:01,181 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:35:07,190 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:35:07,190 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:35:07,191 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:35:13,183 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:35:13,183 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:35:13,184 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:35:19,185 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:35:19,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:35:19,185 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:35:25,177 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:35:25,177 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:35:25,178 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:35:31,183 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:35:31,183 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:35:31,183 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:35:37,172 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:35:37,172 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:35:37,172 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:35:43,502 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:35:43,502 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:35:43,503 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:35:49,180 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:35:49,180 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:35:49,180 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:35:55,172 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:35:55,172 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:35:55,173 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:36:01,179 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:36:01,180 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:36:01,180 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:36:07,187 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:36:07,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:36:07,188 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:36:13,177 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:36:13,177 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:36:13,178 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:36:19,177 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:36:19,177 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:36:19,177 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:36:25,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:36:25,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:36:25,203 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:36:31,185 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:36:31,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:36:31,185 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:36:37,182 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:36:37,182 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:36:37,183 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:36:43,445 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:36:43,446 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:36:43,446 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:36:49,186 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:36:49,186 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:36:49,186 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:36:55,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:36:55,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:36:55,214 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:37:01,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:37:01,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:37:01,203 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:37:07,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:37:07,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:37:07,179 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:37:13,184 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:37:13,184 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:37:13,184 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:37:19,179 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:37:19,179 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:37:19,179 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:37:25,185 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:37:25,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:37:25,185 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:37:31,181 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:37:31,181 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:37:31,182 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:37:37,181 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:37:37,182 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:37:37,182 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:37:43,185 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:37:43,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:37:43,186 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:37:49,183 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:37:49,184 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:37:49,184 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:37:55,196 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:37:55,196 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:37:55,196 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:38:01,196 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:38:01,196 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:38:01,197 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:38:07,192 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:38:07,192 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:38:07,193 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:38:13,173 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:38:13,173 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:38:13,174 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:38:19,188 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:38:19,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:38:19,188 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:38:25,184 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:38:25,184 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:38:25,184 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:38:31,176 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:38:31,176 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:38:31,176 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:38:37,174 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:38:37,174 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:38:37,174 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:38:43,362 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:38:43,362 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:38:43,362 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:38:49,175 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:38:49,175 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:38:49,175 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:38:55,199 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:38:55,199 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:38:55,199 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:39:01,188 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:39:01,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:39:01,188 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:39:07,193 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:39:07,193 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:39:07,193 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:39:13,199 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:39:13,199 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:39:13,200 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:39:19,183 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:39:19,183 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:39:19,184 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:39:25,204 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:39:25,204 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:39:25,205 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:39:31,194 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:39:31,194 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:39:31,194 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:39:37,193 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:39:37,193 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:39:37,194 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:39:43,198 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:39:43,198 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:39:43,199 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:39:49,195 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:39:49,196 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:39:49,197 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:39:55,189 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:39:55,189 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:39:55,189 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:39:59,239 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:39:59,240 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:39:59,240 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:39:59,240 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 7, 7, 9, 59, 239952), 'iat': datetime.datetime(2025, 7, 7, 6, 39, 59, 239956)}
2025-07-06 23:39:59,240 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:39:59,240 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTI0NzUxOTksImlhdCI6MTc1MTg3MDM5OX0.Ev2jSUfd6yLK0LImykvGFt7-3rSIFm2C9Nl6yjGFyYc, Expiry (seconds): 604800
2025-07-06 23:39:59,241 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-06 23:40:01,185 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:40:01,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:40:01,185 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:40:07,175 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:40:07,175 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:40:07,175 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:40:13,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:40:13,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:40:13,179 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:40:19,191 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:40:19,192 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:40:19,192 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:40:25,248 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:40:25,248 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:40:25,249 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:40:31,252 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:40:31,252 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:40:31,252 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:40:37,272 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:40:37,272 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:40:37,273 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:40:43,264 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:40:43,264 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:40:43,264 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:41:21,210 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:41:21,210 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:41:21,211 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:41:27,183 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:41:27,183 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:41:27,184 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:41:33,184 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:41:33,184 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:41:33,185 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:42:02,219 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:02,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:02,219 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:42:08,173 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:08,174 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:08,174 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:42:14,194 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:14,194 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:14,194 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:42:20,187 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:20,187 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:20,187 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:42:25,839 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:25,839 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:25,839 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:42:31,155 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:31,156 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:31,156 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:42:31,158 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-06 23:42:31,175 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:31,175 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:31,175 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:42:31,177 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-06 23:42:31,187 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:31,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:31,188 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:42:31,190 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-06 23:42:31,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:31,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:31,202 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-06 23:42:31,203 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-06 23:42:31,215 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:31,215 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:31,216 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1752472658, 'iat': 1751867858}
2025-07-06 23:42:31,216 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTI0NzI2NTgsImlhdCI6MTc1MTg2Nzg1OH0.GPm7u7v8pzBD67CDwT4weDlxSD6_kFnV1jTCH8g12Ik
2025-07-06 23:42:31,221 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:31,221 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:31,222 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1752472658, 'iat': 1751867858}
2025-07-06 23:42:31,222 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTI0NzI2NTgsImlhdCI6MTc1MTg2Nzg1OH0.GPm7u7v8pzBD67CDwT4weDlxSD6_kFnV1jTCH8g12Ik
2025-07-06 23:42:31,229 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:42:31,229 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:42:31,229 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:42:31,229 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 7, 7, 12, 31, 229105), 'iat': datetime.datetime(2025, 7, 7, 6, 42, 31, 229117)}
2025-07-06 23:42:31,230 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:42:31,230 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTI0NzUzNTEsImlhdCI6MTc1MTg3MDU1MX0.7Bd8lO4szIHyuk0oQ9L72F2uM5r_AEHYbTsP2AFoJUY, Expiry (seconds): 604800
2025-07-06 23:42:31,232 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:42:31,232 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:42:31,233 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:42:31,233 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 7, 7, 12, 31, 232749), 'iat': datetime.datetime(2025, 7, 7, 6, 42, 31, 232754)}
2025-07-06 23:42:31,233 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:42:31,233 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTI0NzUzNTEsImlhdCI6MTc1MTg3MDU1MX0.7Bd8lO4szIHyuk0oQ9L72F2uM5r_AEHYbTsP2AFoJUY, Expiry (seconds): 604800
2025-07-06 23:42:31,235 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-06 23:42:31,236 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-06 23:42:34,283 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:42:34,283 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:42:34,283 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:42:34,284 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 7, 7, 12, 34, 283472), 'iat': datetime.datetime(2025, 7, 7, 6, 42, 34, 283480)}
2025-07-06 23:42:34,284 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:42:34,284 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTI0NzUzNTQsImlhdCI6MTc1MTg3MDU1NH0.q9vjLboZAp09s0idYattaiHosOPmvYEBKwdxv2XoEFg, Expiry (seconds): 604800
2025-07-06 23:42:34,286 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-06 23:42:35,416 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:35,416 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:35,416 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872354, 'iat': 1751870554}
2025-07-06 23:42:35,417 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872354, 'iat': 1751870554}
2025-07-06 23:42:35,417 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-06 23:42:35,417 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:35,417 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:35,417 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872354, 'iat': 1751870554}
2025-07-06 23:42:35,417 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872354, 'iat': 1751870554}
2025-07-06 23:42:35,417 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-06 23:42:35,422 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-06 23:42:35,422 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-06 23:42:35,422 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-06 23:42:35,437 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:35,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:35,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872354, 'iat': 1751870554}
2025-07-06 23:42:35,438 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872354, 'iat': 1751870554}
2025-07-06 23:42:35,438 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-06 23:42:35,439 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:35,439 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:35,439 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872354, 'iat': 1751870554}
2025-07-06 23:42:35,439 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872354, 'iat': 1751870554}
2025-07-06 23:42:35,439 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-06 23:42:35,443 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:35,443 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:35,444 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872354, 'iat': 1751870554}
2025-07-06 23:42:35,444 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872354, 'iat': 1751870554}
2025-07-06 23:42:35,444 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-06 23:42:35,447 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-06 23:42:35,447 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-06 23:42:35,447 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-06 23:42:35,452 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-06 23:42:35,453 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-06 23:42:35,681 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:35,681 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:35,682 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872354, 'iat': 1751870554}
2025-07-06 23:42:35,682 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872354, 'iat': 1751870554}
2025-07-06 23:42:35,682 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-06 23:42:35,688 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-06 23:42:35,688 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-06 23:42:35,946 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:35,947 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:35,947 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872354, 'iat': 1751870554}
2025-07-06 23:42:35,947 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872354, 'iat': 1751870554}
2025-07-06 23:42:35,947 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-06 23:42:35,953 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-06 23:42:35,954 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-06 23:42:35,999 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:42:35,999 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:42:36,000 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872354, 'iat': 1751870554}
2025-07-06 23:47:39,187 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:47:39,187 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:47:39,187 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:47:39,187 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 7, 7, 17, 39, 187255), 'iat': datetime.datetime(2025, 7, 7, 6, 47, 39, 187261)}
2025-07-06 23:47:39,187 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:47:39,187 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTI0NzU2NTksImlhdCI6MTc1MTg3MDg1OX0.kDnp_FFz3eO9X61IZ1ruDjt_oIuv2xoUJtHTeWR4gnw, Expiry (seconds): 604800
2025-07-06 23:47:39,188 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-06 23:47:51,371 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:47:51,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:47:51,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872354, 'iat': 1751870554}
2025-07-06 23:47:51,372 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872354, 'iat': 1751870554}
2025-07-06 23:47:51,372 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-06 23:47:51,374 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-06 23:47:51,374 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-06 23:47:51,374 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE4NzIzNTQsImlhdCI6MTc1MTg3MDU1NH0.u3QpKlYI3_GdIrR0vWDaczr0VlH9or_Dfcz-Arfq1a0
2025-07-06 23:47:51,375 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE4NzIzNTQsImlhdCI6MTc1MTg3MDU1NH0.u3QpKlYI3_GdIrR0vWDaczr0VlH9or_Dfcz-Arfq1a0
2025-07-06 23:48:07,557 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:48:07,557 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:48:07,557 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872659, 'iat': 1751870859}
2025-07-06 23:48:37,583 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:48:37,583 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:48:37,583 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872659, 'iat': 1751870859}
2025-07-06 23:48:45,621 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:48:45,622 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:48:45,622 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872659, 'iat': 1751870859}
2025-07-06 23:53:42,582 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:53:42,582 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:53:42,582 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:53:42,583 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 7, 28, 42, 582771), 'iat': datetime.datetime(2025, 7, 7, 6, 53, 42, 582774)}
2025-07-06 23:53:42,583 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:53:57,479 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:53:57,479 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:53:57,480 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872659, 'iat': 1751870859}
2025-07-06 23:54:01,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:54:01,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:54:01,292 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872659, 'iat': 1751870859}
2025-07-06 23:54:05,345 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:54:05,345 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:54:05,345 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872659, 'iat': 1751870859}
2025-07-06 23:54:10,548 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:54:10,548 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:54:10,548 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872659, 'iat': 1751870859}
2025-07-06 23:54:15,958 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:54:15,958 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:54:15,959 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872659, 'iat': 1751870859}
2025-07-06 23:54:22,098 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:54:22,098 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:54:22,098 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872659, 'iat': 1751870859}
2025-07-06 23:54:53,031 - INFO - app.core.security - Closing Redis connection...
2025-07-06 23:54:53,035 - INFO - app.core.security - Redis connection closed.
2025-07-06 23:59:50,257 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-06 23:59:50,257 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-06 23:59:50,263 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-06 23:59:50,263 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-06 23:59:50,271 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-06 23:59:50,271 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-06 23:59:50,271 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-06 23:59:50,271 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 7, 34, 50, 271001), 'iat': datetime.datetime(2025, 7, 7, 6, 59, 50, 271003)}
2025-07-06 23:59:50,271 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-06 23:59:53,790 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:59:53,790 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:59:53,791 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872659, 'iat': 1751870859}
2025-07-06 23:59:59,486 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-06 23:59:59,486 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-06 23:59:59,487 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872659, 'iat': 1751870859}
2025-07-07 00:00:04,251 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 00:00:04,252 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 00:00:04,252 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751872659, 'iat': 1751870859}
2025-07-07 00:02:35,028 - INFO - app.core.security - Closing Redis connection...
2025-07-07 00:02:35,030 - INFO - app.core.security - Redis connection closed.
2025-07-07 00:06:11,129 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-07 00:06:11,129 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-07 00:06:11,135 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-07 00:06:11,135 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-07 00:06:11,141 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-07 00:06:11,141 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-07 00:06:11,141 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-07 00:06:11,141 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 7, 41, 11, 141123), 'iat': datetime.datetime(2025, 7, 7, 7, 6, 11, 141127)}
2025-07-07 00:06:11,141 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-07 00:06:18,615 - INFO - app.core.security - Closing Redis connection...
2025-07-07 00:06:18,616 - INFO - app.core.security - Redis connection closed.
2025-07-07 00:06:25,170 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-07 00:06:25,170 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-07 00:06:25,175 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-07 00:06:25,175 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-07 00:06:25,185 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-07 00:06:25,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-07 00:06:25,185 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-07 00:06:25,185 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 7, 41, 25, 185392), 'iat': datetime.datetime(2025, 7, 7, 7, 6, 25, 185394)}
2025-07-07 00:06:25,187 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-07 00:06:31,654 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 00:06:31,654 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 00:06:31,655 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-07 00:06:31,736 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 00:06:31,736 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 00:06:31,737 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-07 00:06:31,836 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 00:06:31,836 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 00:06:31,836 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-07 00:06:31,960 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 00:06:31,960 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 00:06:31,961 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-07 00:06:32,059 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 00:06:32,059 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 00:06:32,059 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-07 00:08:13,876 - INFO - app.core.security - Closing Redis connection...
2025-07-07 00:08:13,877 - INFO - app.core.security - Redis connection closed.
2025-07-07 00:13:00,879 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-07 00:13:00,879 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-07 00:13:00,884 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-07 00:13:00,884 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-07 00:13:00,888 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-07 00:13:00,888 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-07 00:13:00,888 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-07 00:13:00,888 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 7, 48, 0, 888706), 'iat': datetime.datetime(2025, 7, 7, 7, 13, 0, 888708)}
2025-07-07 00:13:00,889 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-07 00:13:12,001 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-07 00:13:12,002 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-07 00:13:12,002 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-07 00:13:12,003 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 7, 7, 43, 12, 1802), 'iat': datetime.datetime(2025, 7, 7, 7, 13, 12, 1829)}
2025-07-07 00:13:12,003 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-07 00:13:12,004 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTI0NzcxOTIsImlhdCI6MTc1MTg3MjM5Mn0.sUtlSfocEUiwO35d27zqOgr0zHwENPWosieJ_zcGahU, Expiry (seconds): 604800
2025-07-07 00:13:12,006 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-07 00:13:14,548 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 00:13:14,548 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 00:13:14,604 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751874192, 'iat': 1751872392}
2025-07-07 00:13:14,618 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751874192, 'iat': 1751872392}
2025-07-07 00:13:14,621 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 00:13:14,626 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 00:13:14,627 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 00:13:14,627 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751874192, 'iat': 1751872392}
2025-07-07 00:13:14,635 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751874192, 'iat': 1751872392}
2025-07-07 00:13:14,635 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 00:13:14,681 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 00:13:14,682 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 00:13:14,682 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-07 00:13:14,701 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 00:13:14,701 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 00:13:14,701 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751874192, 'iat': 1751872392}
2025-07-07 00:13:14,702 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751874192, 'iat': 1751872392}
2025-07-07 00:13:14,702 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 00:13:14,702 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 00:13:14,702 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 00:13:14,703 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751874192, 'iat': 1751872392}
2025-07-07 00:13:14,703 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751874192, 'iat': 1751872392}
2025-07-07 00:13:14,703 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 00:13:14,715 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 00:13:14,716 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 00:13:14,718 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751874192, 'iat': 1751872392}
2025-07-07 00:13:14,720 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751874192, 'iat': 1751872392}
2025-07-07 00:13:14,720 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 00:13:14,735 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 00:13:14,736 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 00:13:14,736 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-07 00:13:14,881 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 00:13:14,881 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 00:13:15,258 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 00:13:15,258 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 00:13:15,259 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751874192, 'iat': 1751872392}
2025-07-07 00:13:15,260 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751874192, 'iat': 1751872392}
2025-07-07 00:13:15,260 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 00:13:15,271 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 00:13:15,271 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 00:13:15,273 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751874192, 'iat': 1751872392}
2025-07-07 00:13:15,274 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751874192, 'iat': 1751872392}
2025-07-07 00:13:15,274 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 00:13:15,280 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 00:13:15,280 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 00:13:15,307 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 00:13:15,308 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 00:13:15,912 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 00:13:15,912 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 00:13:15,913 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751874192, 'iat': 1751872392}
2025-07-07 00:13:27,787 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 00:13:27,788 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 00:13:27,788 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751874192, 'iat': 1751872392}
2025-07-07 00:13:27,788 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751874192, 'iat': 1751872392}
2025-07-07 00:13:27,788 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 00:13:27,793 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 00:13:27,793 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 00:13:42,271 - INFO - app.core.security - Closing Redis connection...
2025-07-07 00:13:42,272 - INFO - app.core.security - Redis connection closed.
2025-07-07 01:36:37,203 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-07 01:36:37,204 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-07 01:36:37,210 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-07 01:36:37,210 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-07 01:36:37,217 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-07 01:36:37,217 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-07 01:36:37,217 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-07 01:36:37,217 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 9, 11, 37, 217576), 'iat': datetime.datetime(2025, 7, 7, 8, 36, 37, 217578)}
2025-07-07 01:36:37,218 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-07 01:36:42,599 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 01:36:42,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 01:36:42,601 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1752477192, 'iat': 1751872392}
2025-07-07 01:36:42,601 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTI0NzcxOTIsImlhdCI6MTc1MTg3MjM5Mn0.sUtlSfocEUiwO35d27zqOgr0zHwENPWosieJ_zcGahU
2025-07-07 01:36:42,623 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-07 01:36:42,624 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-07 01:36:42,624 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-07 01:36:42,624 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 7, 9, 6, 42, 623641), 'iat': datetime.datetime(2025, 7, 7, 8, 36, 42, 623657)}
2025-07-07 01:36:42,625 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-07 01:36:42,625 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTI0ODIyMDIsImlhdCI6MTc1MTg3NzQwMn0.FWkKlnRiHgtzQHC1XQXHyoI7K4Q-xNJeCMS16n70a0M, Expiry (seconds): 604800
2025-07-07 01:36:42,626 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-07 01:36:42,690 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 01:36:42,690 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 01:36:42,691 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-07 01:36:44,073 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 01:36:44,074 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 01:36:44,074 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879202, 'iat': 1751877402}
2025-07-07 01:36:44,074 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879202, 'iat': 1751877402}
2025-07-07 01:36:44,074 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 01:36:44,099 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 01:36:44,099 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 01:36:44,100 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE4NzkyMDIsImlhdCI6MTc1MTg3NzQwMn0.s_SjOxb-vfelQhHOq-J1hBCFv9RqHGj39xgRkFfBZGI
2025-07-07 01:36:44,108 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE4NzkyMDIsImlhdCI6MTc1MTg3NzQwMn0.s_SjOxb-vfelQhHOq-J1hBCFv9RqHGj39xgRkFfBZGI
2025-07-07 01:36:46,869 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-07 01:36:46,870 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-07 01:36:46,870 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-07 01:36:46,870 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 7, 9, 6, 46, 869707), 'iat': datetime.datetime(2025, 7, 7, 8, 36, 46, 869720)}
2025-07-07 01:36:46,871 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-07 01:36:46,871 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTI0ODIyMDYsImlhdCI6MTc1MTg3NzQwNn0.Lx_P03ZltZ4c--hp9xy-MG7Yzn6XA94ztm1Y1Vb9mmc, Expiry (seconds): 604800
2025-07-07 01:36:46,873 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-07 01:36:48,029 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 01:36:48,030 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 01:36:48,030 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:36:48,030 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:36:48,030 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 01:36:48,030 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 01:36:48,030 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 01:36:48,031 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:36:48,031 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:36:48,031 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 01:36:48,036 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 01:36:48,037 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 01:36:48,037 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-07 01:36:48,048 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 01:36:48,048 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 01:36:48,049 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:36:48,049 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:36:48,049 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 01:36:48,049 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 01:36:48,049 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 01:36:48,050 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:36:48,052 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:36:48,053 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 01:36:48,064 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 01:36:48,064 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 01:36:48,065 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-07 01:36:48,069 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 01:36:48,070 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 01:36:48,070 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:36:48,070 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:36:48,070 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 01:36:48,099 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 01:36:48,101 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 01:36:48,413 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 01:36:48,413 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 01:36:48,413 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:36:48,413 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:36:48,413 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 01:36:48,417 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 01:36:48,417 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 01:36:48,881 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 01:36:48,882 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 01:36:48,882 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:36:48,882 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:36:48,882 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 01:36:48,887 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 01:36:48,888 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 01:36:49,143 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 01:36:49,143 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 01:36:49,144 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:37:29,329 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 01:37:29,330 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 01:37:29,330 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:37:29,330 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:37:29,330 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 01:37:29,330 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 01:37:29,330 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 01:37:29,330 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:37:29,331 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751879206, 'iat': 1751877406}
2025-07-07 01:37:29,331 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 01:37:29,333 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 01:37:29,333 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 01:37:29,333 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-07 01:39:21,549 - INFO - app.core.security - Closing Redis connection...
2025-07-07 01:39:21,553 - INFO - app.core.security - Redis connection closed.
2025-07-07 03:09:41,471 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-07 03:09:41,471 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-07 03:09:41,475 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-07 03:09:41,475 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-07 03:09:41,487 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-07 03:09:41,487 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-07 03:09:41,487 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-07 03:09:41,487 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 10, 44, 41, 487352), 'iat': datetime.datetime(2025, 7, 7, 10, 9, 41, 487360)}
2025-07-07 03:09:41,488 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-07 03:09:46,761 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 03:09:46,762 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 03:09:46,762 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752485052, 'iat': 1751880252}
2025-07-07 03:09:46,763 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI0ODUwNTIsImlhdCI6MTc1MTg4MDI1Mn0.Kkeew9fqcshaxBGeS1RCZeno2XSj6QWEp9tmmknD0Z8
2025-07-07 03:09:46,770 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI0ODUwNTIsImlhdCI6MTc1MTg4MDI1Mn0.Kkeew9fqcshaxBGeS1RCZeno2XSj6QWEp9tmmknD0Z8
2025-07-07 03:09:46,770 - INFO - app.core.security - Refresh token deleted from Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI0ODUwNTIsImlhdCI6MTc1MTg4MDI1Mn0.Kkeew9fqcshaxBGeS1RCZeno2XSj6QWEp9tmmknD0Z8
2025-07-07 03:09:47,502 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 03:09:47,502 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 03:09:47,502 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-07 03:09:47,790 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 03:09:47,790 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 03:09:47,791 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-07 03:09:47,792 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-07 03:09:51,291 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-07 03:09:51,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-07 03:09:51,292 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-07 03:09:51,292 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 7, 10, 39, 51, 291159), 'iat': datetime.datetime(2025, 7, 7, 10, 9, 51, 291185)}
2025-07-07 03:09:51,293 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-07 03:09:51,293 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTI0ODc3OTEsImlhdCI6MTc1MTg4Mjk5MX0.JDljJ1UGkXAzt_BjcRePx2JeLdN5RsfmiG8utRpTmog, Expiry (seconds): 604800
2025-07-07 03:09:51,299 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-07 03:09:52,434 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 03:09:52,435 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 03:09:52,435 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:09:52,435 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:09:52,435 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 03:09:52,435 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 03:09:52,435 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 03:09:52,435 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:09:52,435 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:09:52,436 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 03:09:52,440 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 03:09:52,440 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 03:09:52,440 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-07 03:09:52,447 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 03:09:52,447 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 03:09:52,448 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:09:52,448 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:09:52,448 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 03:09:52,448 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 03:09:52,448 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 03:09:52,448 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:09:52,448 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:09:52,448 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 03:09:52,454 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 03:09:52,454 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 03:09:52,455 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:09:52,456 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:09:52,456 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 03:09:52,463 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 03:09:52,463 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 03:09:52,464 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-07 03:09:52,471 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 03:09:52,472 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 03:09:52,746 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 03:09:52,747 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 03:09:52,747 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:09:52,747 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:09:52,747 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 03:09:52,751 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 03:09:52,752 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 03:09:52,978 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 03:09:52,978 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 03:09:52,979 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:09:52,979 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:09:52,979 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 03:09:52,994 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 03:09:52,994 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 03:09:53,061 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 03:09:53,062 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 03:09:53,062 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:10:21,011 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 03:10:21,014 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 03:10:21,017 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:10:21,017 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:10:21,017 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 03:10:21,043 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 03:10:21,043 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 03:14:41,213 - INFO - app.core.security - Closing Redis connection...
2025-07-07 03:14:41,214 - INFO - app.core.security - Redis connection closed.
2025-07-07 03:22:56,480 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-07 03:22:56,480 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-07 03:22:56,484 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-07 03:22:56,484 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-07 03:22:56,487 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-07 03:22:56,487 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-07 03:22:56,487 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-07 03:22:56,487 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 10, 57, 56, 487737), 'iat': datetime.datetime(2025, 7, 7, 10, 22, 56, 487739)}
2025-07-07 03:22:56,488 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-07 03:23:00,283 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 03:23:00,283 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 03:23:00,284 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:23:37,897 - INFO - app.core.security - Closing Redis connection...
2025-07-07 03:23:37,898 - INFO - app.core.security - Redis connection closed.
2025-07-07 03:30:25,366 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-07 03:30:25,366 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-07 03:30:25,372 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-07 03:30:25,372 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-07 03:30:25,377 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-07 03:30:25,377 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-07 03:30:25,377 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-07 03:30:25,377 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 7, 11, 5, 25, 377077), 'iat': datetime.datetime(2025, 7, 7, 10, 30, 25, 377079)}
2025-07-07 03:30:25,377 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-07 03:30:27,317 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 03:30:27,317 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 03:30:27,318 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751884791, 'iat': 1751882991}
2025-07-07 03:30:41,499 - INFO - app.core.security - Closing Redis connection...
2025-07-07 03:30:41,503 - INFO - app.core.security - Redis connection closed.
2025-07-07 23:45:33,285 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-07 23:45:33,285 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-07 23:45:33,288 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-07 23:45:33,288 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-07 23:45:33,294 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-07 23:45:33,294 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-07 23:45:33,294 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-07 23:45:33,294 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 7, 20, 33, 294472), 'iat': datetime.datetime(2025, 7, 8, 6, 45, 33, 294474)}
2025-07-07 23:45:33,295 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-07 23:45:36,955 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:45:36,955 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:45:36,955 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:45:57,297 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:45:57,297 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:45:57,298 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:45:57,298 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:45:57,298 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:45:57,416 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:45:57,417 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:46:01,299 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:46:01,300 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:46:01,300 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:01,300 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:01,301 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 23:46:01,301 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:46:01,301 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:46:01,301 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:01,301 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:01,302 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:46:01,307 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:46:01,307 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:46:01,308 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:46:02,902 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:46:02,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:46:02,903 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:02,903 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:02,903 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 23:46:02,904 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:46:02,904 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:46:02,904 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:02,904 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:02,904 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:46:02,911 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:46:02,911 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:46:02,911 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:46:04,036 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:46:04,037 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:46:04,037 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:04,037 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:04,037 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 23:46:04,038 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:46:04,038 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:46:04,039 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:04,039 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:04,039 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:46:04,042 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:46:04,043 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:46:04,043 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:46:05,460 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:46:05,460 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:46:05,460 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:05,460 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:05,460 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 23:46:05,460 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:46:05,460 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:46:05,461 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:05,461 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:05,461 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:46:05,465 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:46:05,465 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:46:05,465 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:46:07,771 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:46:07,771 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:46:07,772 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:07,772 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:07,773 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 23:46:07,773 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:46:07,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:46:07,775 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:07,775 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:07,775 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:46:07,782 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:46:07,783 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:46:07,783 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:46:09,303 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:46:09,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:46:09,304 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:09,304 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:09,304 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 23:46:09,304 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:46:09,304 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:46:09,305 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:09,305 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:09,305 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:46:09,315 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:46:09,316 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:46:09,316 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:46:26,659 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:46:26,659 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:46:26,659 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:26,659 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:26,659 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 23:46:26,659 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:46:26,659 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:46:26,660 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:26,660 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:26,660 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:46:26,665 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:46:26,666 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:46:26,666 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:46:26,711 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:46:26,711 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:46:26,712 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:26,713 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:26,713 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 23:46:26,713 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:46:26,713 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:46:26,713 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:26,714 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:46:26,715 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:46:26,749 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:46:26,749 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:46:26,754 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:47:26,322 - INFO - app.core.security - Closing Redis connection...
2025-07-07 23:47:26,327 - INFO - app.core.security - Redis connection closed.
2025-07-07 23:51:47,077 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-07 23:51:47,077 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-07 23:51:47,081 - WARNING - app.core.security - AOF persistence is not enabled in Redis. Attempting to enable it...
2025-07-07 23:51:47,098 - INFO - app.core.security - AOF persistence has been enabled with appendfsync=everysec
2025-07-07 23:51:47,098 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-07 23:51:47,103 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-07 23:51:47,103 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-07 23:51:47,103 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-07 23:51:47,103 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 7, 26, 47, 103679), 'iat': datetime.datetime(2025, 7, 8, 6, 51, 47, 103681)}
2025-07-07 23:51:47,104 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-07 23:52:11,319 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:52:11,319 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:52:11,320 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:11,320 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:11,320 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 23:52:11,320 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:52:11,320 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:52:11,320 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:11,321 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:11,321 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:52:11,325 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:52:11,325 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:52:11,325 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:52:11,341 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:52:11,341 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:52:11,341 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:11,341 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:11,342 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 23:52:11,342 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:52:11,342 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:52:11,342 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:11,342 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:11,342 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:52:11,345 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:52:11,345 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:52:11,345 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:52:11,346 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:52:11,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:52:11,346 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:11,346 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:11,346 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:52:11,351 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:52:11,352 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:52:11,541 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:52:11,541 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:52:11,541 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:11,541 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:11,541 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:52:11,544 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:52:11,544 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:52:11,822 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:52:11,822 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:52:11,822 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:11,822 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:11,822 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:52:11,823 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:52:11,824 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:52:11,853 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:52:11,853 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:52:11,854 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:23,764 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:52:23,765 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:52:23,765 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:23,765 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:23,766 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 23:52:23,766 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:52:23,766 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:52:23,766 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:23,766 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:23,766 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:52:23,774 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:52:23,774 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:52:23,775 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:52:31,733 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:52:31,733 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:52:31,733 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:31,733 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:31,733 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 23:52:31,733 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:52:31,733 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:52:31,734 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:31,734 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:52:31,734 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:52:31,740 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:52:31,740 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:52:31,740 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:55:15,617 - INFO - app.core.security - Closing Redis connection...
2025-07-07 23:55:15,617 - INFO - app.core.security - Redis connection closed.
2025-07-07 23:57:46,706 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-07 23:57:46,707 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-07 23:57:46,710 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-07 23:57:46,710 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-07 23:57:46,715 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-07 23:57:46,715 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-07 23:57:46,715 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-07 23:57:46,715 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 7, 32, 46, 715144), 'iat': datetime.datetime(2025, 7, 8, 6, 57, 46, 715146)}
2025-07-07 23:57:46,716 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-07 23:57:51,131 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:57:51,131 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:57:51,133 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:57:51,133 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:57:51,133 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 23:57:51,133 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:57:51,134 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:57:51,134 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:57:51,134 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:57:51,134 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:57:51,144 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:57:51,144 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:57:51,145 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:57:53,691 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:57:53,691 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:57:53,692 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:57:53,910 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:57:53,911 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:57:53,911 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:57:53,912 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:57:53,912 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 23:57:53,912 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:57:53,912 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:57:53,913 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:57:53,913 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:57:53,914 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:57:53,940 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:57:53,940 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:57:53,940 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:58:18,024 - INFO - app.core.security - Closing Redis connection...
2025-07-07 23:58:18,025 - INFO - app.core.security - Redis connection closed.
2025-07-07 23:58:19,839 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-07 23:58:19,840 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-07 23:58:19,842 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-07 23:58:19,842 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-07 23:58:19,845 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-07 23:58:19,845 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-07 23:58:19,845 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-07 23:58:19,845 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 7, 33, 19, 845002), 'iat': datetime.datetime(2025, 7, 8, 6, 58, 19, 845004)}
2025-07-07 23:58:19,845 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-07 23:58:21,935 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:58:21,935 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:58:21,935 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:58:31,406 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:58:31,406 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:58:31,406 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:58:31,407 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751958118, 'iat': 1751956318}
2025-07-07 23:58:31,407 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-07 23:58:31,412 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-07 23:58:31,412 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-07 23:58:31,413 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NTgxMTgsImlhdCI6MTc1MTk1NjMxOH0.hEarfsq7Y2yVfMTB9e948GhHrMWSk2Yw5aPJg58fM64
2025-07-07 23:58:31,417 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NTgxMTgsImlhdCI6MTc1MTk1NjMxOH0.hEarfsq7Y2yVfMTB9e948GhHrMWSk2Yw5aPJg58fM64
2025-07-07 23:58:35,305 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-07 23:58:35,306 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-07 23:58:35,307 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-07 23:58:35,308 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 8, 7, 28, 35, 305855), 'iat': datetime.datetime(2025, 7, 8, 6, 58, 35, 305874)}
2025-07-07 23:58:35,308 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-07 23:58:35,309 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTI1NjI3MTUsImlhdCI6MTc1MTk1NzkxNX0.YilFwguRptbKL_oEMVfzWggNKQvpDkoGIU5-SzPYVHQ, Expiry (seconds): 604800
2025-07-07 23:58:35,313 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-07 23:58:36,473 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:58:36,474 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:58:36,474 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:36,474 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:36,474 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 23:58:36,475 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:58:36,475 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:58:36,475 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:36,475 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:36,476 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 23:58:36,490 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 23:58:36,490 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 23:58:36,490 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-07 23:58:36,504 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:58:36,504 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:58:36,504 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:36,504 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:36,504 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 23:58:36,504 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:58:36,504 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:58:36,505 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:36,505 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:36,505 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 23:58:36,511 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:58:36,511 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:58:36,511 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:36,511 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:36,511 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 23:58:36,516 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 23:58:36,516 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 23:58:36,516 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-07 23:58:36,559 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 23:58:36,559 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 23:58:36,810 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:58:36,810 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:58:36,810 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:36,810 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:36,810 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 23:58:36,814 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 23:58:36,814 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 23:58:37,029 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:58:37,030 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:58:37,031 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:37,031 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:37,031 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 23:58:37,039 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 23:58:37,040 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 23:58:37,119 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:58:37,119 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:58:37,124 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:44,607 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:58:44,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:58:44,607 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:44,607 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:44,607 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-07 23:58:44,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:58:44,608 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:58:44,608 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:44,608 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:58:44,608 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 23:58:44,612 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 23:58:44,613 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 23:58:44,613 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-07 23:59:48,323 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:59:48,323 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:59:48,324 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:59:48,325 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:59:48,325 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 23:59:48,343 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 23:59:48,345 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 23:59:58,326 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-07 23:59:58,326 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-07 23:59:58,326 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:59:58,326 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751959715, 'iat': 1751957915}
2025-07-07 23:59:58,327 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-07 23:59:58,332 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-07 23:59:58,332 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-07 23:59:58,332 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5NTk3MTUsImlhdCI6MTc1MTk1NzkxNX0.9pvuF8bvL-zKs7H7Lv6NWzCC-OHPk21OV4ZoGoHc6OA
2025-07-07 23:59:58,334 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5NTk3MTUsImlhdCI6MTc1MTk1NzkxNX0.9pvuF8bvL-zKs7H7Lv6NWzCC-OHPk21OV4ZoGoHc6OA
2025-07-08 00:00:01,388 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 00:00:01,388 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 00:00:01,389 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 00:00:01,389 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 8, 7, 30, 1, 388543), 'iat': datetime.datetime(2025, 7, 8, 7, 0, 1, 388551)}
2025-07-08 00:00:01,389 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 00:00:01,390 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NjI4MDEsImlhdCI6MTc1MTk1ODAwMX0.u7U9KoIMYMGh-EUg8PA-pyQlqf7xmIP1y8r8GnheaWs, Expiry (seconds): 604800
2025-07-08 00:00:01,395 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 00:00:02,537 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:02,537 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:02,538 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:02,538 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:02,538 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:00:02,538 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:02,538 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:02,539 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:02,539 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:02,539 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:00:02,545 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:00:02,546 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:02,546 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:02,555 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:02,555 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:02,556 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:02,556 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:02,556 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:00:02,556 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:02,556 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:02,557 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:02,557 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:02,557 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:00:02,562 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:02,562 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:02,563 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:02,563 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:02,563 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:00:02,567 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:00:02,567 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:02,567 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:02,573 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:00:02,574 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:02,834 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:02,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:02,835 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:02,835 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:02,835 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:00:02,839 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:00:02,840 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:03,165 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:03,165 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:03,165 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:03,200 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:03,200 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:03,201 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:03,201 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:03,201 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:00:03,224 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:00:03,225 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:08,354 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:08,354 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:08,355 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:08,357 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:08,357 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:00:08,373 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:00:08,374 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:11,810 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:11,811 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:11,811 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:11,811 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:11,811 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:00:11,811 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:11,812 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:11,812 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:11,812 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:11,812 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:00:11,816 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:00:11,816 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:11,816 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:19,409 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:19,409 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:19,410 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:19,410 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:19,410 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:00:19,410 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:19,410 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:19,410 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:19,410 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:19,411 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:00:19,417 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:00:19,417 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:19,417 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:20,768 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:20,768 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:20,768 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:20,769 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:20,769 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:00:20,769 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:20,769 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:20,769 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:20,770 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:20,770 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:00:20,774 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:00:20,774 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:20,775 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:23,253 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:23,253 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:23,253 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:23,253 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:23,253 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:00:23,254 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:23,254 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:23,254 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:23,254 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:23,254 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:00:23,263 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:00:23,263 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:23,263 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:27,139 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:27,140 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:27,141 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:27,141 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:27,141 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:00:27,141 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:27,141 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:27,142 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:27,142 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:27,142 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:00:27,146 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:00:27,146 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:27,146 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:28,000 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:28,000 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:28,000 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:28,000 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:28,000 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:00:28,000 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:28,000 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:28,000 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:28,001 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:28,001 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:00:28,004 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:00:28,005 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:28,005 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:32,591 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:32,591 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:32,592 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:32,592 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:32,592 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:00:32,592 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:32,592 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:32,592 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:32,592 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:32,592 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:00:32,599 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:00:32,600 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:32,601 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:00:51,150 - INFO - app.core.security - Closing Redis connection...
2025-07-08 00:00:51,151 - INFO - app.core.security - Redis connection closed.
2025-07-08 00:00:53,343 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 00:00:53,344 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 00:00:53,374 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 00:00:53,375 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-08 00:00:53,380 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 00:00:53,380 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 00:00:53,380 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 00:00:53,380 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 7, 35, 53, 380123), 'iat': datetime.datetime(2025, 7, 8, 7, 0, 53, 380124)}
2025-07-08 00:00:53,380 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 00:00:55,698 - INFO - app.core.security - Closing Redis connection...
2025-07-08 00:00:55,703 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:00:55,703 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:00:55,703 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:00:55,706 - INFO - app.core.security - Redis connection closed.
2025-07-08 00:06:48,312 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 00:06:48,313 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 00:06:48,317 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 00:06:48,317 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-08 00:06:48,322 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 00:06:48,322 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 00:06:48,322 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 00:06:48,322 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 7, 41, 48, 322522), 'iat': datetime.datetime(2025, 7, 8, 7, 6, 48, 322524)}
2025-07-08 00:06:48,322 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 00:06:54,237 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:06:54,238 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:06:54,238 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:06:56,364 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:06:56,364 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:06:56,364 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:06:56,364 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:06:56,364 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:06:56,365 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:06:56,365 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:06:56,365 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:06:56,365 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:06:56,365 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:06:56,374 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:06:56,374 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:06:56,374 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:06:56,394 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:06:56,395 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:06:56,395 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:06:56,395 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:06:56,395 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:06:56,395 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:06:56,395 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:06:56,396 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:06:56,396 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:06:56,396 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:06:56,402 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:06:56,403 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:06:56,403 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:06:56,535 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:06:56,535 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:06:56,536 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:06:56,536 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:06:56,536 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:06:56,540 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:06:56,540 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:06:56,690 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:06:56,690 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:06:56,691 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:06:56,691 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:06:56,691 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:06:56,694 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:06:56,694 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:06:56,803 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:06:56,803 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:06:56,804 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:06:56,804 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:06:56,804 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:06:56,806 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:06:56,806 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:06:57,000 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:06:57,000 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:06:57,000 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:07:31,322 - INFO - app.core.security - Closing Redis connection...
2025-07-08 00:07:31,323 - INFO - app.core.security - Redis connection closed.
2025-07-08 00:20:15,937 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 00:20:15,938 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 00:20:15,941 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 00:20:15,941 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-08 00:20:15,948 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 00:20:15,948 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 00:20:15,948 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 00:20:15,948 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 7, 55, 15, 948292), 'iat': datetime.datetime(2025, 7, 8, 7, 20, 15, 948294)}
2025-07-08 00:20:15,948 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 00:20:18,332 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:20:18,332 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:20:18,332 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:20:20,729 - INFO - app.core.security - Closing Redis connection...
2025-07-08 00:20:20,730 - INFO - app.core.security - Redis connection closed.
2025-07-08 00:20:23,385 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 00:20:23,385 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 00:20:23,388 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 00:20:23,388 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-08 00:20:23,391 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 00:20:23,391 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 00:20:23,391 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 00:20:23,391 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 7, 55, 23, 391095), 'iat': datetime.datetime(2025, 7, 8, 7, 20, 23, 391097)}
2025-07-08 00:20:23,391 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 00:20:25,285 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:20:25,285 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:20:25,285 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:23:10,885 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:23:10,886 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:23:10,887 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:23:10,888 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:23:10,888 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:23:10,888 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:23:10,888 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:23:10,889 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:23:10,889 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751959801, 'iat': 1751958001}
2025-07-08 00:23:10,889 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:23:10,913 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:23:10,914 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:23:10,914 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:29:13,480 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 00:29:13,480 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 00:29:13,485 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 00:29:13,485 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-08 00:29:13,490 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 00:29:13,490 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 00:29:13,490 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 00:29:13,490 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 8, 4, 13, 490718), 'iat': datetime.datetime(2025, 7, 8, 7, 29, 13, 490720)}
2025-07-08 00:29:13,491 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 00:30:05,421 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:30:05,421 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:30:05,422 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 00:30:05,429 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 00:30:05,460 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:30:05,461 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:30:05,461 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 00:30:05,463 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 00:30:05,484 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:30:05,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:30:05,489 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 00:30:05,498 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 00:30:05,527 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:30:05,527 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:30:05,527 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 00:30:05,531 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 00:30:05,558 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:30:05,558 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:30:05,559 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752562801, 'iat': 1751958001}
2025-07-08 00:30:05,562 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NjI4MDEsImlhdCI6MTc1MTk1ODAwMX0.u7U9KoIMYMGh-EUg8PA-pyQlqf7xmIP1y8r8GnheaWs
2025-07-08 00:30:05,569 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:30:05,569 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:30:05,570 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752562801, 'iat': 1751958001}
2025-07-08 00:30:05,570 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NjI4MDEsImlhdCI6MTc1MTk1ODAwMX0.u7U9KoIMYMGh-EUg8PA-pyQlqf7xmIP1y8r8GnheaWs
2025-07-08 00:30:05,587 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NjI4MDEsImlhdCI6MTc1MTk1ODAwMX0.u7U9KoIMYMGh-EUg8PA-pyQlqf7xmIP1y8r8GnheaWs
2025-07-08 00:30:05,589 - INFO - app.core.security - Refresh token deleted from Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NjI4MDEsImlhdCI6MTc1MTk1ODAwMX0.u7U9KoIMYMGh-EUg8PA-pyQlqf7xmIP1y8r8GnheaWs
2025-07-08 00:30:05,610 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NjI4MDEsImlhdCI6MTc1MTk1ODAwMX0.u7U9KoIMYMGh-EUg8PA-pyQlqf7xmIP1y8r8GnheaWs
2025-07-08 00:30:05,615 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NjI4MDEsImlhdCI6MTc1MTk1ODAwMX0.u7U9KoIMYMGh-EUg8PA-pyQlqf7xmIP1y8r8GnheaWs
2025-07-08 00:30:13,516 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 00:30:13,517 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 00:30:13,517 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 00:30:13,518 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 8, 8, 0, 13, 516777), 'iat': datetime.datetime(2025, 7, 8, 7, 30, 13, 516801)}
2025-07-08 00:30:13,518 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 00:30:13,519 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NjQ2MTMsImlhdCI6MTc1MTk1OTgxM30.j5uJC0JJH_W681QxHSW4--nINLKhKhNA3zLLE0QITjw, Expiry (seconds): 604800
2025-07-08 00:30:13,527 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 00:30:14,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:30:14,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:30:14,900 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:14,900 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:14,901 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:30:14,901 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:30:14,901 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:30:14,902 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:14,902 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:14,903 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:30:14,913 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:30:14,913 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:30:14,913 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:30:14,922 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:30:14,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:30:14,923 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:14,923 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:14,923 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:30:14,923 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:30:14,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:30:14,924 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:14,924 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:14,924 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:30:14,927 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:30:14,927 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:30:14,928 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:14,928 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:14,928 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:30:14,931 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:30:14,932 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:30:14,932 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:30:14,938 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:30:14,938 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:30:15,271 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:30:15,271 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:30:15,272 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:15,272 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:15,272 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:30:15,278 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:30:15,278 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:30:15,782 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:30:15,782 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:30:15,782 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:16,033 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:30:16,035 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:30:16,036 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:16,036 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:16,036 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:30:16,056 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:30:16,056 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:30:18,618 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:30:18,619 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:30:18,619 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:18,619 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:18,619 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:30:18,619 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:30:18,619 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:30:18,620 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:18,620 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:18,620 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:30:18,626 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:30:18,626 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:30:18,626 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:30:42,201 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:30:42,201 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:30:42,201 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:42,202 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:42,202 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:30:42,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:30:42,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:30:42,202 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:42,202 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:30:42,203 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:30:42,208 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:30:42,208 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:30:42,209 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:31:15,669 - INFO - app.core.security - Closing Redis connection...
2025-07-08 00:31:15,670 - INFO - app.core.security - Redis connection closed.
2025-07-08 00:34:51,416 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 00:34:51,421 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 00:34:51,439 - WARNING - app.core.security - AOF persistence is not enabled in Redis. Attempting to enable it...
2025-07-08 00:34:51,442 - INFO - app.core.security - AOF persistence has been enabled with appendfsync=everysec
2025-07-08 00:34:51,442 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 00:34:51,448 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 00:34:51,448 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 00:34:51,448 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 00:34:51,448 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 8, 9, 51, 448758), 'iat': datetime.datetime(2025, 7, 8, 7, 34, 51, 448761)}
2025-07-08 00:34:51,449 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 00:34:56,135 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:34:56,135 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:34:56,136 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:35:08,466 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:35:08,467 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:35:08,467 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:35:08,467 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961613, 'iat': 1751959813}
2025-07-08 00:35:08,467 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:35:08,470 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:35:08,470 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:35:08,470 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NjE2MTMsImlhdCI6MTc1MTk1OTgxM30.7x_fcEAu1vEQ48zRGrRL8JpnnkreW3xKU3S7JQbIE0w
2025-07-08 00:35:08,472 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NjE2MTMsImlhdCI6MTc1MTk1OTgxM30.7x_fcEAu1vEQ48zRGrRL8JpnnkreW3xKU3S7JQbIE0w
2025-07-08 00:35:11,272 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 00:35:11,272 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 00:35:11,272 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 00:35:11,272 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 8, 8, 5, 11, 272024), 'iat': datetime.datetime(2025, 7, 8, 7, 35, 11, 272031)}
2025-07-08 00:35:11,272 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 00:35:11,273 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NjQ5MTEsImlhdCI6MTc1MTk2MDExMX0.uNY7_ND4G7JDNROIGoMj4w2usmY7-Hyn4kx4MRofYkc, Expiry (seconds): 604800
2025-07-08 00:35:11,306 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 00:35:12,460 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:35:12,460 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:35:12,461 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:12,461 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:12,461 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:35:12,461 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:35:12,461 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:35:12,461 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:12,461 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:12,461 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:35:12,466 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:35:12,466 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:35:12,466 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:35:12,493 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:35:12,493 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:35:12,494 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:12,494 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:12,494 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:35:12,494 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:35:12,494 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:35:12,494 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:12,495 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:12,495 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:35:12,499 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:35:12,500 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:35:12,500 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:35:12,507 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:35:12,507 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:35:12,507 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:12,507 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:12,507 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:35:12,512 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:35:12,512 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:35:12,733 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:35:12,733 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:35:12,734 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:12,735 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:12,735 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:35:12,740 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:35:12,740 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:35:13,154 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:35:13,154 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:35:13,155 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:13,155 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:13,155 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:35:13,161 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:35:13,162 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:35:13,405 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:35:13,406 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:35:13,406 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:20,868 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:35:20,868 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:35:20,869 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:20,869 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:20,869 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 00:35:20,869 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:35:20,870 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:35:20,870 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:20,870 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 00:35:20,870 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 00:35:20,878 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 00:35:20,878 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:35:20,878 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 00:35:44,027 - INFO - app.core.security - Closing Redis connection...
2025-07-08 00:35:44,028 - INFO - app.core.security - Redis connection closed.
2025-07-08 00:38:18,917 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 00:38:18,920 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 00:38:18,932 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 00:38:18,932 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 00:38:18,948 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 00:38:18,948 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 00:38:18,948 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 00:38:18,948 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 8, 13, 18, 948539), 'iat': datetime.datetime(2025, 7, 8, 7, 38, 18, 948542)}
2025-07-08 00:38:18,949 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 00:38:20,737 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 00:38:20,737 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 00:38:20,737 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751961911, 'iat': 1751960111}
2025-07-08 01:31:36,668 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 01:31:36,671 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 01:31:38,718 - WARNING - app.core.security - AOF persistence is not enabled in Redis. Attempting to enable it...
2025-07-08 01:31:38,758 - INFO - app.core.security - AOF persistence has been enabled with appendfsync=everysec
2025-07-08 01:31:38,758 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 01:31:38,775 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 01:31:38,775 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 01:31:38,775 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 01:31:38,775 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 9, 6, 38, 775160), 'iat': datetime.datetime(2025, 7, 8, 8, 31, 38, 775163)}
2025-07-08 01:31:38,776 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 01:32:09,195 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:32:09,196 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:32:09,196 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 01:32:09,201 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 01:32:09,232 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:32:09,232 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:32:09,232 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 01:32:09,234 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 01:32:09,245 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:32:09,245 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:32:09,245 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 01:32:09,254 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 01:32:09,319 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:32:09,321 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:32:09,322 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 01:32:09,324 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 01:32:09,360 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:32:09,360 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:32:09,362 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752564911, 'iat': 1751960111}
2025-07-08 01:32:09,365 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NjQ5MTEsImlhdCI6MTc1MTk2MDExMX0.uNY7_ND4G7JDNROIGoMj4w2usmY7-Hyn4kx4MRofYkc
2025-07-08 01:32:09,373 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:32:09,374 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:32:09,377 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752564911, 'iat': 1751960111}
2025-07-08 01:32:09,383 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NjQ5MTEsImlhdCI6MTc1MTk2MDExMX0.uNY7_ND4G7JDNROIGoMj4w2usmY7-Hyn4kx4MRofYkc
2025-07-08 01:32:09,389 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NjQ5MTEsImlhdCI6MTc1MTk2MDExMX0.uNY7_ND4G7JDNROIGoMj4w2usmY7-Hyn4kx4MRofYkc
2025-07-08 01:32:09,407 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NjQ5MTEsImlhdCI6MTc1MTk2MDExMX0.uNY7_ND4G7JDNROIGoMj4w2usmY7-Hyn4kx4MRofYkc
2025-07-08 01:32:19,896 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 01:32:19,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 01:32:19,897 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 01:32:19,897 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 8, 9, 2, 19, 896923), 'iat': datetime.datetime(2025, 7, 8, 8, 32, 19, 896931)}
2025-07-08 01:32:19,897 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 01:32:19,898 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NjgzMzksImlhdCI6MTc1MTk2MzUzOX0.QwmDogM1Clkdz04Lh0q4cNHQ7up246rI9-TkKuMkieU, Expiry (seconds): 604800
2025-07-08 01:32:19,900 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 01:32:21,002 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:32:21,002 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:32:21,002 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:21,002 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:21,002 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 01:32:21,003 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:32:21,003 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:32:21,003 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:21,003 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:21,003 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:32:21,010 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:32:21,010 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:32:21,011 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:32:21,021 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:32:21,021 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:32:21,022 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:21,022 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:21,022 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 01:32:21,022 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:32:21,022 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:32:21,023 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:21,023 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:21,023 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:32:21,025 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:32:21,025 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:32:21,025 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:21,025 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:21,026 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:32:21,030 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:32:21,031 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:32:21,031 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:32:21,034 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:32:21,034 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:32:21,300 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:32:21,300 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:32:21,301 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:21,301 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:21,301 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:32:21,305 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:32:21,305 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:32:21,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:32:21,772 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:32:21,772 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:21,773 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:21,773 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:32:21,779 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:32:21,781 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:32:21,816 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:32:21,816 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:32:21,817 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:25,437 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:32:25,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:32:25,439 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:25,439 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:25,443 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 01:32:25,443 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:32:25,444 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:32:25,444 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:25,444 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:32:25,445 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:32:25,458 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:32:25,461 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:32:25,462 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:32:37,306 - INFO - app.core.security - Closing Redis connection...
2025-07-08 01:32:37,307 - INFO - app.core.security - Redis connection closed.
2025-07-08 01:34:22,151 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 01:34:22,154 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 01:34:24,202 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 01:34:24,202 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 01:34:24,273 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 01:34:24,273 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 01:34:24,273 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 01:34:24,273 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 9, 9, 24, 273622), 'iat': datetime.datetime(2025, 7, 8, 8, 34, 24, 273625)}
2025-07-08 01:34:24,275 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 01:34:27,314 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:34:27,314 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:34:27,314 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:34:45,552 - INFO - app.core.security - Closing Redis connection...
2025-07-08 01:34:45,554 - INFO - app.core.security - Redis connection closed.
2025-07-08 01:44:30,423 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 01:44:30,428 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6380
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 01:44:30,459 - WARNING - app.core.security - AOF persistence is not enabled in Redis. Attempting to enable it...
2025-07-08 01:44:30,465 - INFO - app.core.security - AOF persistence has been enabled with appendfsync=everysec
2025-07-08 01:44:30,465 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6380
2025-07-08 01:44:30,474 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 01:44:30,474 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 01:44:30,474 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 01:44:30,474 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 9, 19, 30, 474696), 'iat': datetime.datetime(2025, 7, 8, 8, 44, 30, 474699)}
2025-07-08 01:44:30,475 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 01:44:33,278 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:44:33,278 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:44:33,279 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:45:01,184 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:45:01,184 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:45:01,184 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:45:01,184 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:45:01,184 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 01:45:01,184 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:45:01,184 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:45:01,184 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:45:01,184 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:45:01,184 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:45:01,189 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:45:01,189 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:45:01,189 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:45:13,590 - INFO - app.core.security - Closing Redis connection...
2025-07-08 01:45:13,593 - INFO - app.core.security - Redis connection closed.
2025-07-08 01:47:49,794 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 01:47:49,799 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6380
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 01:47:49,822 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 01:47:49,823 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6380
2025-07-08 01:47:49,837 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 01:47:49,837 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 01:47:49,837 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 01:47:49,837 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 9, 22, 49, 837566), 'iat': datetime.datetime(2025, 7, 8, 8, 47, 49, 837572)}
2025-07-08 01:47:49,838 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 01:47:55,282 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:47:55,282 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:47:55,282 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:48:00,927 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:48:00,927 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:48:00,928 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:48:00,928 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:48:00,928 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 01:48:00,928 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:48:00,928 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:48:00,929 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:48:00,929 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:48:00,929 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:48:00,935 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:48:00,935 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:48:00,935 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:48:22,292 - INFO - app.core.security - Closing Redis connection...
2025-07-08 01:48:22,294 - INFO - app.core.security - Redis connection closed.
2025-07-08 01:48:27,285 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 01:48:27,290 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 01:48:29,324 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 01:48:29,324 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 01:48:29,371 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 01:48:29,371 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 01:48:29,371 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 01:48:29,371 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 9, 23, 29, 371680), 'iat': datetime.datetime(2025, 7, 8, 8, 48, 29, 371685)}
2025-07-08 01:48:29,372 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 01:48:35,291 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:48:35,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:48:35,292 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:48:49,591 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:48:49,592 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:48:49,592 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:48:49,592 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:48:49,592 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 01:48:49,592 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:48:49,592 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:48:49,592 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:48:49,592 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:48:49,592 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:48:49,595 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:48:49,595 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:48:49,595 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:49:26,795 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:49:26,795 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:49:26,796 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:49:26,796 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751965339, 'iat': 1751963539}
2025-07-08 01:49:26,796 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:49:26,807 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:49:26,808 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:49:26,808 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NjUzMzksImlhdCI6MTc1MTk2MzUzOX0._H0dYdKbGaK_fRVdwzarxTk9C1GdDt4Q2ZZIRhzKdZo
2025-07-08 01:49:26,811 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NjUzMzksImlhdCI6MTc1MTk2MzUzOX0._H0dYdKbGaK_fRVdwzarxTk9C1GdDt4Q2ZZIRhzKdZo
2025-07-08 01:49:33,045 - INFO - app.core.security - Closing Redis connection...
2025-07-08 01:49:33,048 - INFO - app.core.security - Redis connection closed.
2025-07-08 01:50:03,109 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 01:50:03,113 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 01:50:05,151 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 01:50:05,151 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 01:50:05,200 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 01:50:05,200 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 01:50:05,200 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 01:50:05,200 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 9, 25, 5, 200778), 'iat': datetime.datetime(2025, 7, 8, 8, 50, 5, 200781)}
2025-07-08 01:50:05,201 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 01:50:07,665 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 01:50:07,666 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 01:50:07,666 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 01:50:07,666 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 8, 9, 20, 7, 665827), 'iat': datetime.datetime(2025, 7, 8, 8, 50, 7, 665838)}
2025-07-08 01:50:07,666 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 01:50:07,667 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1Njk0MDcsImlhdCI6MTc1MTk2NDYwN30.wj1z_dvEnmwcWtSllH6nJ7I5qC2JIBThhabKJ1UWZ3U, Expiry (seconds): 604800
2025-07-08 01:50:11,053 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 01:50:12,203 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:50:12,203 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:50:12,204 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:12,204 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:12,204 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 01:50:12,204 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:50:12,204 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:50:12,205 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:12,205 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:12,205 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:50:12,214 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:50:12,214 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:50:12,214 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:50:12,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:50:12,225 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:50:12,225 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:12,225 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:12,225 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 01:50:12,225 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:50:12,225 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:50:12,226 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:12,226 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:12,226 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:50:12,246 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:50:12,246 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:50:12,247 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:12,247 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:12,247 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:50:12,268 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:50:12,269 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:50:12,270 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:50:12,298 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:50:12,298 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:50:12,522 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:50:12,523 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:50:12,523 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:12,523 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:12,523 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:50:12,526 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:50:12,526 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:50:12,722 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:50:12,723 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:50:12,724 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:12,725 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:12,725 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:50:12,731 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:50:12,732 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:50:12,837 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:50:12,837 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:50:12,838 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:26,157 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:50:26,157 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:50:26,158 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:26,158 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:26,158 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:50:26,165 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:50:26,165 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:50:28,886 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:50:28,887 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:50:28,887 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:28,888 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:28,889 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:50:28,898 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:50:28,898 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:50:40,938 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:50:40,938 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:50:40,938 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:40,939 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:50:40,939 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:50:40,947 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:50:40,948 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:51:20,043 - INFO - app.core.security - Closing Redis connection...
2025-07-08 01:51:20,044 - INFO - app.core.security - Redis connection closed.
2025-07-08 01:56:37,827 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 01:56:37,834 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 01:56:39,874 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 01:56:39,874 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 01:56:39,913 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 01:56:39,913 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 01:56:39,913 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 01:56:39,913 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 9, 31, 39, 913730), 'iat': datetime.datetime(2025, 7, 8, 8, 56, 39, 913733)}
2025-07-08 01:56:39,914 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 01:56:42,077 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:56:42,078 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:56:42,079 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:56:42,079 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:56:42,079 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:56:42,349 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:56:42,350 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:56:42,651 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:56:42,651 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:56:42,652 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:56:51,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:56:51,863 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:56:51,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:56:51,863 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:56:51,863 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 01:56:51,863 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:56:51,864 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:56:51,864 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:56:51,864 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:56:51,864 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:56:51,877 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:56:51,877 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:56:51,877 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:57:01,350 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:57:01,351 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:57:01,352 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:01,353 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:01,353 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 01:57:01,353 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:57:01,353 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:57:01,354 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:01,354 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:01,354 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:57:01,357 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:57:01,357 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:57:01,357 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:57:12,654 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:57:12,654 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:57:12,655 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:12,655 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:12,655 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:57:12,658 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:57:12,658 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:57:38,523 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:57:38,524 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:57:38,524 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:38,525 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:38,525 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 01:57:38,525 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:57:38,525 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:57:38,527 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:38,528 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:38,528 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:57:38,537 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:57:38,537 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:57:38,538 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:57:38,564 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:57:38,564 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:57:38,564 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:38,564 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:38,565 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 01:57:38,565 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:57:38,565 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:57:38,565 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:38,565 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:38,565 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:57:38,570 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:57:38,570 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:57:38,570 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:57:38,577 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:57:38,578 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:57:38,578 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:38,578 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:38,578 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:57:38,583 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:57:38,583 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:57:38,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:57:38,844 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:57:38,845 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:38,845 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:38,845 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:57:38,854 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:57:38,854 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:57:39,148 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:57:39,148 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:57:39,149 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:39,149 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:39,150 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:57:39,161 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:57:39,161 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:57:39,165 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:57:39,165 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:57:39,167 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:57:52,543 - INFO - app.core.security - Closing Redis connection...
2025-07-08 01:57:52,545 - INFO - app.core.security - Redis connection closed.
2025-07-08 01:59:41,440 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 01:59:41,444 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 01:59:43,483 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 01:59:43,483 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 01:59:43,518 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 01:59:43,518 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 01:59:43,518 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 01:59:43,518 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 9, 34, 43, 518490), 'iat': datetime.datetime(2025, 7, 8, 8, 59, 43, 518495)}
2025-07-08 01:59:43,519 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 01:59:46,329 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:59:46,330 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:59:46,331 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:59:46,331 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 01:59:46,331 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 01:59:46,522 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 01:59:46,523 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 01:59:47,638 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 01:59:47,638 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 01:59:47,638 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:19,066 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:00:19,066 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:00:19,067 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:19,067 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:19,067 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:00:19,089 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:00:19,089 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:00:24,147 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:00:24,147 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:00:24,148 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:24,149 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:24,149 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:00:24,149 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:00:24,149 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:00:24,149 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:24,150 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:24,150 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:00:24,156 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:00:24,156 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:00:24,156 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:00:24,188 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:00:24,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:00:24,190 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:24,190 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:24,191 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:00:24,191 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:00:24,191 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:00:24,191 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:24,191 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:24,192 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:00:24,195 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:00:24,195 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:00:24,195 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:00:24,205 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:00:24,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:00:24,206 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:24,206 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:24,206 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:00:24,213 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:00:24,213 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:00:24,411 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:00:24,411 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:00:24,411 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:24,411 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:24,411 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:00:24,414 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:00:24,414 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:00:24,729 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:00:24,729 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:00:24,729 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:25,083 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:00:25,083 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:00:25,083 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:25,084 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:25,084 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:00:25,088 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:00:25,088 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:00:35,394 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:00:35,394 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:00:35,394 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:35,394 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:00:35,394 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:00:35,397 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:00:35,397 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:01:09,976 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:01:09,976 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:01:09,976 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:01:09,976 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:01:09,976 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:01:09,982 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:01:09,982 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:01:51,141 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:01:51,141 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:01:51,141 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:01:51,141 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:01:51,141 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:01:51,160 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:01:51,160 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:01:58,799 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:01:58,799 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:01:58,800 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:01:58,800 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:01:58,800 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:01:58,805 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:01:58,805 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:02:03,284 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:02:03,284 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:02:03,284 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:03,284 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:03,284 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:02:03,296 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:02:03,297 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:02:10,519 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:02:10,519 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:02:10,520 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:10,520 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:10,520 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:02:10,532 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:02:10,532 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:02:18,685 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:02:18,686 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:02:18,687 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:18,688 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:18,688 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:02:18,698 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:02:18,698 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:02:34,561 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:02:34,562 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:02:34,562 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:34,562 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:34,562 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:02:34,562 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:02:34,562 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:02:34,563 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:34,563 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:34,563 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:02:34,569 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:02:34,570 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:02:34,570 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:02:34,585 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:02:34,585 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:02:34,586 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:34,587 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:34,588 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:02:34,588 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:02:34,588 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:02:34,588 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:34,588 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:34,589 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:02:34,592 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:02:34,593 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:02:34,593 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:02:34,888 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:02:34,888 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:02:34,888 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:34,888 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:34,889 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:02:34,893 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:02:34,893 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:02:35,169 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:02:35,169 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:02:35,169 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:35,169 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:35,169 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:02:35,176 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:02:35,176 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:02:35,488 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:02:35,488 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:02:35,492 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:35,519 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:02:35,520 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:02:35,520 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:35,520 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:02:35,521 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:02:35,533 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:02:35,533 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:03:55,987 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:03:55,988 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:05:31,455 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:05:31,459 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:05:33,502 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:05:33,502 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:05:33,540 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:05:33,540 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:05:33,540 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:05:33,540 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 9, 40, 33, 540393), 'iat': datetime.datetime(2025, 7, 8, 9, 5, 33, 540398)}
2025-07-08 02:05:33,541 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:05:37,293 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:05:37,293 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:05:37,293 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:05:48,383 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:05:48,384 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:05:51,738 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:05:51,741 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:05:53,767 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:05:53,768 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:05:53,842 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:05:53,843 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:05:53,843 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:05:53,843 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 9, 40, 53, 842958), 'iat': datetime.datetime(2025, 7, 8, 9, 5, 53, 842962)}
2025-07-08 02:05:53,844 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:05:55,409 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:05:55,409 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:05:55,409 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:06:22,317 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:06:22,317 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:06:22,318 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:06:22,318 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:06:22,318 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:06:22,323 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:06:22,323 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:06:28,315 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:06:28,316 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:06:28,316 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:06:28,316 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:06:28,316 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:06:28,320 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:06:28,321 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:06:39,516 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:06:39,516 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:06:39,516 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:06:39,516 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:06:39,517 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:06:39,521 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:06:39,521 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:07:05,650 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:07:05,650 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:07:05,651 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:05,651 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:05,651 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:07:05,651 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:07:05,651 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:07:05,651 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:05,652 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:05,652 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:07:05,657 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:07:05,658 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:07:05,658 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:07:05,682 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:07:05,682 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:07:05,683 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:05,683 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:05,683 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:07:05,683 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:07:05,683 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:07:05,683 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:05,683 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:05,683 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:07:05,694 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:07:05,694 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:07:05,695 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:07:05,714 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:07:05,715 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:07:05,715 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:05,716 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:05,716 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:07:05,723 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:07:05,723 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:07:06,013 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:07:06,013 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:07:06,014 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:06,014 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:06,014 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:07:06,018 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:07:06,018 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:07:06,256 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:07:06,256 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:07:06,257 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:06,257 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:06,257 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:07:06,261 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:07:06,261 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:07:06,329 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:07:06,329 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:07:06,329 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:16,511 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:07:16,511 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:07:16,511 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:16,511 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:16,511 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:07:16,517 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:07:16,517 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:07:25,094 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:07:25,094 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:07:25,095 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:25,095 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:07:25,095 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:07:25,098 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:07:25,099 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:08:18,811 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:08:18,812 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:09:23,432 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:09:23,437 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:09:25,492 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:09:25,493 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:09:25,551 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:09:25,551 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:09:25,551 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:09:25,551 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 9, 44, 25, 551017), 'iat': datetime.datetime(2025, 7, 8, 9, 9, 25, 551024)}
2025-07-08 02:09:25,551 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:09:27,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:09:27,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:09:27,293 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:09:29,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:09:29,845 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:09:29,845 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:09:29,845 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:09:29,845 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:09:29,855 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:09:29,855 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:09:45,540 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:09:45,541 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:16:27,150 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:16:27,157 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:16:29,190 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:16:29,190 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:16:29,213 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:16:29,213 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:16:29,213 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:16:29,213 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 9, 51, 29, 213355), 'iat': datetime.datetime(2025, 7, 8, 9, 16, 29, 213358)}
2025-07-08 02:16:29,213 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:16:31,474 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:16:31,474 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:16:31,474 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:16:45,063 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:16:45,065 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:16:47,418 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:16:47,421 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:16:49,446 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:16:49,446 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:16:49,482 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:16:49,482 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:16:49,482 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:16:49,482 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 9, 51, 49, 482763), 'iat': datetime.datetime(2025, 7, 8, 9, 16, 49, 482765)}
2025-07-08 02:16:49,484 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:16:51,155 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:16:51,155 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:16:51,156 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:16:51,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:16:51,606 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:16:51,607 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:16:51,607 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:16:51,607 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:16:51,618 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:16:51,618 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:16:51,619 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NjY0MDcsImlhdCI6MTc1MTk2NDYwN30.OKGnmJ1EWG-GkI5BJcbCYFw0eYH_62FTZ2eSjo7nZNo
2025-07-08 02:16:54,748 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:16:54,748 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:16:54,749 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:16:54,749 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751966407, 'iat': 1751964607}
2025-07-08 02:16:54,749 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:16:54,761 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:16:54,761 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:16:54,761 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NjY0MDcsImlhdCI6MTc1MTk2NDYwN30.OKGnmJ1EWG-GkI5BJcbCYFw0eYH_62FTZ2eSjo7nZNo
2025-07-08 02:16:57,277 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NjY0MDcsImlhdCI6MTc1MTk2NDYwN30.OKGnmJ1EWG-GkI5BJcbCYFw0eYH_62FTZ2eSjo7nZNo
2025-07-08 02:16:57,284 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NjY0MDcsImlhdCI6MTc1MTk2NDYwN30.OKGnmJ1EWG-GkI5BJcbCYFw0eYH_62FTZ2eSjo7nZNo
2025-07-08 02:17:05,694 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:17:05,694 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:17:05,694 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:17:05,694 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 8, 9, 47, 5, 694123), 'iat': datetime.datetime(2025, 7, 8, 9, 17, 5, 694129)}
2025-07-08 02:17:05,694 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:17:05,694 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NzEwMjUsImlhdCI6MTc1MTk2NjIyNX0.SpRzIu0ELquKMRVRwtQbmki6ijLEXSZ-_ebaOpk8kcw, Expiry (seconds): 604800
2025-07-08 02:17:05,695 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 02:17:06,874 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:17:06,874 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:17:06,874 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:17:06,874 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:17:06,874 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:17:06,874 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:17:06,875 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:17:06,875 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:17:06,875 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:17:06,875 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:17:06,881 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:17:06,881 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:17:06,881 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:17:06,889 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:17:06,889 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:17:06,890 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:17:06,892 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:17:06,892 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:17:06,892 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:17:06,892 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:17:06,896 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:17:06,896 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:17:06,896 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:17:06,911 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:17:06,912 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:17:06,913 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:17:06,921 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:17:06,922 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:17:06,922 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:17:06,923 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:17:06,923 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:17:06,931 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:17:06,931 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:17:07,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:17:07,293 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:17:07,293 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:17:07,294 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:17:07,294 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:17:07,301 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:17:07,302 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:17:09,045 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:17:09,046 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:17:09,046 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:17:09,186 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:17:09,186 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:17:09,186 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:17:09,187 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:17:09,187 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:17:09,194 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:17:09,194 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:18:03,659 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:18:03,660 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:18:03,661 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:18:03,661 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:18:03,661 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:18:03,677 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:18:03,677 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:18:18,169 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:18:18,170 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:18:18,172 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:18:18,173 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:18:18,173 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:18:18,190 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:18:18,191 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:18:22,990 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:18:22,990 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:18:22,992 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:18:22,992 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:18:22,992 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:18:22,996 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:18:22,997 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:18:34,210 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:18:34,210 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:18:34,210 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:18:34,210 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:18:34,210 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:18:34,214 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:18:34,215 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:18:41,297 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:18:41,298 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:33:17,137 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:33:17,141 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:33:19,170 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:33:19,171 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:33:19,178 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:33:19,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:33:19,178 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:33:19,178 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 10, 8, 19, 178007), 'iat': datetime.datetime(2025, 7, 8, 9, 33, 19, 178011)}
2025-07-08 02:33:19,178 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:33:30,881 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:33:30,882 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:33:30,882 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:34:07,257 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:34:07,257 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:34:07,258 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:34:07,258 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:34:07,258 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:34:07,269 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:34:07,270 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:34:12,406 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:34:12,407 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:34:12,408 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:34:12,409 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:34:12,409 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:34:12,415 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:34:12,416 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:34:22,044 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:34:22,044 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:34:22,046 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:34:22,046 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:34:22,046 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:34:22,050 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:34:22,050 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:34:29,254 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:34:29,257 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:35:45,401 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:35:45,405 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:35:47,431 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:35:47,431 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:35:47,436 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:35:47,436 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:35:47,436 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:35:47,436 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 10, 10, 47, 436398), 'iat': datetime.datetime(2025, 7, 8, 9, 35, 47, 436401)}
2025-07-08 02:35:47,436 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:35:49,190 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:35:49,191 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:35:49,191 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:35:49,192 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:35:49,192 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:35:49,392 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:35:49,393 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:35:52,660 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:35:52,660 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:35:52,660 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:04,215 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:36:04,216 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:36:04,216 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:04,216 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:04,216 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:36:04,216 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:36:04,216 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:36:04,216 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:04,216 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:04,216 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:36:04,232 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:36:04,233 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:36:04,233 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:36:04,277 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:36:04,277 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:36:04,278 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:04,278 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:04,278 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:36:04,278 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:36:04,278 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:36:04,278 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:04,278 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:04,278 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:36:04,287 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:36:04,287 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:36:04,289 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:36:04,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:36:04,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:36:04,293 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:04,293 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:04,293 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:36:04,305 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:36:04,305 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:36:04,525 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:36:04,525 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:36:04,526 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:04,526 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:04,526 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:36:04,529 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:36:04,529 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:36:04,702 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:36:04,702 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:36:04,702 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:04,702 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:04,702 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:36:04,706 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:36:04,706 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:36:04,841 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:36:04,841 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:36:04,842 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:14,042 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:36:14,043 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:36:14,043 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:14,044 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:14,044 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:36:14,055 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:36:14,055 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:36:30,228 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:36:30,228 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:36:30,229 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:30,229 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:30,230 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:36:30,239 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:36:30,240 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:36:38,338 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:36:38,338 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:36:38,338 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:38,338 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:36:38,338 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:36:38,344 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:36:38,344 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:38:38,078 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:38:38,080 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:38:40,727 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:38:40,731 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:38:42,756 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:38:42,756 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:38:42,760 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:38:42,760 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:38:42,760 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:38:42,760 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 10, 13, 42, 760594), 'iat': datetime.datetime(2025, 7, 8, 9, 38, 42, 760597)}
2025-07-08 02:38:42,761 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:38:44,552 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:38:44,553 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:38:44,554 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:38:44,555 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:38:44,555 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:38:44,556 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:38:44,559 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:38:44,560 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:38:44,560 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:38:44,560 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:38:44,828 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:38:44,828 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:38:44,828 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:38:44,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:38:44,844 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:38:44,845 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:38:44,845 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:38:44,845 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:38:44,845 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:38:44,845 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:38:44,845 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:38:44,845 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:38:44,846 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:38:44,847 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:38:44,848 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:38:44,848 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:38:44,848 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:38:44,848 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:38:44,853 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:38:44,853 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:38:44,853 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:38:44,870 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:38:44,872 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:38:45,518 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:38:45,518 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:38:45,519 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:38:45,519 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:38:45,519 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:38:45,528 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:38:45,530 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:38:45,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:38:45,844 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:38:45,845 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:38:45,845 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:38:45,845 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:38:45,848 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:38:45,848 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:38:46,048 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:38:46,049 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:38:46,049 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:39:01,579 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:39:01,580 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:39:01,580 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:39:01,580 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:39:01,580 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:39:01,584 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:39:01,584 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:39:13,289 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:39:13,289 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:39:13,290 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:39:13,290 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:39:13,290 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:39:13,298 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:39:13,298 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:39:46,720 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:39:46,723 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:40:50,567 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:40:50,572 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:40:52,614 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:40:52,614 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:40:52,620 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:40:52,620 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:40:52,620 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:40:52,620 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 10, 15, 52, 620478), 'iat': datetime.datetime(2025, 7, 8, 9, 40, 52, 620483)}
2025-07-08 02:40:52,621 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:40:54,413 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:40:54,413 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:40:54,413 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:40:54,413 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:40:54,413 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:40:54,413 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:40:54,413 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:40:54,413 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:40:54,413 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:40:54,413 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:40:54,415 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:40:54,415 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:40:54,415 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:40:54,415 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:40:54,415 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:40:54,415 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:40:54,416 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:40:54,416 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:40:54,416 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:40:54,416 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:40:54,582 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:40:54,583 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:40:54,583 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:40:54,588 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:40:54,588 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:40:54,588 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:40:54,598 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:40:54,598 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:40:54,598 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:40:54,598 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:40:54,598 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:40:54,600 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:40:54,600 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:40:54,716 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:40:54,716 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:40:54,716 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:40:54,716 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:40:54,716 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:40:54,719 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:40:54,719 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:40:54,847 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:40:54,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:40:54,847 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:40:54,847 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:40:54,847 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:40:54,850 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:40:54,850 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:40:55,040 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:40:55,040 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:40:55,040 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:41:11,818 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:41:11,820 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:41:14,059 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:41:14,064 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:41:16,097 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:41:16,097 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:41:16,105 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:41:16,106 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:41:16,106 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:41:16,106 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 10, 16, 16, 105940), 'iat': datetime.datetime(2025, 7, 8, 9, 41, 16, 105945)}
2025-07-08 02:41:16,107 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:41:17,988 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:41:17,988 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:41:17,989 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:41:46,120 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:41:46,122 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:41:48,603 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:41:48,608 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:41:50,668 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:41:50,669 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:41:50,672 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:41:50,672 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:41:50,672 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:41:50,672 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 10, 16, 50, 672170), 'iat': datetime.datetime(2025, 7, 8, 9, 41, 50, 672172)}
2025-07-08 02:41:50,672 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:41:52,390 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:41:52,390 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:41:52,390 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:42:06,653 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:42:06,654 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:42:35,556 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:42:35,561 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:42:37,610 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:42:37,610 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:42:37,617 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:42:37,617 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:42:37,617 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:42:37,617 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 10, 17, 37, 617466), 'iat': datetime.datetime(2025, 7, 8, 9, 42, 37, 617471)}
2025-07-08 02:42:37,618 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:42:41,005 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:42:41,007 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:42:44,640 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:42:44,646 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:42:46,694 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:42:46,694 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:42:46,701 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:42:46,701 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:42:46,701 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:42:46,701 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 10, 17, 46, 701344), 'iat': datetime.datetime(2025, 7, 8, 9, 42, 46, 701347)}
2025-07-08 02:42:46,701 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:42:48,480 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:42:48,480 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:42:48,480 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:42:48,481 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:42:48,485 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:42:48,494 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:42:48,495 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:42:48,495 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:42:48,495 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:42:48,495 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:42:48,646 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:42:48,646 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:42:48,646 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:42:48,655 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:42:48,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:42:48,655 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:42:48,655 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:42:48,655 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:42:48,655 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:42:48,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:42:48,656 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:42:48,656 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:42:48,656 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:42:48,657 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:42:48,657 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:42:48,657 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:42:48,657 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:42:48,657 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:42:48,661 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:42:48,661 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:42:48,661 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:42:48,666 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:42:48,667 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:42:48,782 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:42:48,783 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:42:48,783 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:42:48,783 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:42:48,783 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:42:48,785 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:42:48,786 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:42:48,887 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:42:48,887 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:42:48,888 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:42:48,888 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:42:48,888 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:42:48,890 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:42:48,890 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:42:49,101 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:42:49,101 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:42:49,102 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:43:07,159 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:43:07,159 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:43:07,160 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:43:07,160 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:43:07,160 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:43:07,163 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:43:07,163 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:43:20,226 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:43:20,226 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:43:20,226 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:43:20,226 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:43:20,227 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:43:20,250 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:43:20,250 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:44:22,172 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:44:22,176 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:44:25,103 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:44:25,106 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:44:27,154 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:44:27,155 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:44:27,158 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:44:27,158 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:44:27,158 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:44:27,158 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 10, 19, 27, 158464), 'iat': datetime.datetime(2025, 7, 8, 9, 44, 27, 158468)}
2025-07-08 02:44:27,159 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:44:28,757 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:44:28,757 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:44:28,758 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:07,949 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:45:07,951 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:45:11,770 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:45:11,773 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:45:13,813 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:45:13,813 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:45:13,823 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:45:13,823 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:45:13,823 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:45:13,823 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 10, 20, 13, 823133), 'iat': datetime.datetime(2025, 7, 8, 9, 45, 13, 823139)}
2025-07-08 02:45:13,824 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:45:15,760 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:45:15,763 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:45:15,764 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:15,765 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:15,765 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:45:15,765 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:45:15,765 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:45:15,768 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:15,777 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:15,790 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:45:15,834 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:45:15,835 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:45:15,836 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:16,167 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:45:16,167 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:45:16,168 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:45:16,203 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:45:16,204 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:45:16,204 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:16,205 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:16,205 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:45:16,205 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:45:16,205 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:45:16,206 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:16,206 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:16,207 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:45:16,210 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:45:16,210 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:45:16,211 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:16,212 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:16,212 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:45:16,224 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:45:16,225 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:45:16,225 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:45:16,252 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:45:16,252 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:45:16,641 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:45:16,641 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:45:16,642 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:16,642 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:16,642 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:45:16,650 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:45:16,650 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:45:16,968 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:45:16,986 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:45:16,988 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:17,005 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:45:17,006 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:45:17,007 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:17,007 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:17,007 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:45:17,016 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:45:17,016 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:45:39,140 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:45:39,140 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:45:39,141 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:39,141 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:39,142 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:45:39,148 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:45:39,148 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:45:52,539 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:45:52,540 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:45:52,540 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:52,541 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751968025, 'iat': 1751966225}
2025-07-08 02:45:52,541 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:45:52,550 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:45:52,550 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:46:00,484 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:46:00,489 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:48:04,273 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:48:04,280 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:48:06,316 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:48:06,317 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:48:06,327 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:48:06,327 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:48:06,327 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:48:06,327 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 10, 23, 6, 327086), 'iat': datetime.datetime(2025, 7, 8, 9, 48, 6, 327092)}
2025-07-08 02:48:06,328 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:48:09,225 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:48:09,226 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:48:09,226 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 02:48:09,261 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 02:48:09,809 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:48:09,809 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:48:09,810 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 02:48:09,811 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 02:48:10,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:48:10,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:48:10,630 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 02:48:15,964 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:48:15,965 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:48:15,966 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 02:48:16,118 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:48:16,118 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:48:16,120 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 02:48:16,124 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 02:48:17,808 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:48:17,810 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:48:17,811 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 02:48:17,817 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 02:48:22,017 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:48:22,017 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:48:22,019 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 02:48:23,578 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:48:23,578 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:48:23,579 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 02:48:23,584 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 02:48:27,190 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:48:27,191 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:48:27,191 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:48:27,191 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 8, 10, 18, 27, 190664), 'iat': datetime.datetime(2025, 7, 8, 9, 48, 27, 190674)}
2025-07-08 02:48:27,191 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:48:27,191 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NzI5MDcsImlhdCI6MTc1MTk2ODEwN30.lAFzqz_nznrShUoyw_5PuHFle6RDWZRwe4J0OBz-F_Y, Expiry (seconds): 604800
2025-07-08 02:48:27,194 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 02:48:28,309 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:48:28,310 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:48:28,311 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:48:28,311 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:48:28,311 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:48:28,311 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:48:28,311 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:48:28,312 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:48:28,312 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:48:28,312 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:48:28,320 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:48:28,320 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:48:28,320 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:48:28,335 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:48:28,336 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:48:28,337 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:48:28,337 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:48:28,338 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:48:28,339 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:48:28,340 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:48:28,341 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:48:28,341 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:48:28,341 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:48:28,349 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:48:28,350 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:48:28,350 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:48:28,356 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:48:28,356 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:48:28,357 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:48:28,357 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:48:28,357 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:48:28,369 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:48:28,370 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:48:28,653 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:48:28,653 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:48:28,654 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:48:28,654 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:48:28,654 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:48:28,657 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:48:28,657 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:48:28,919 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:48:28,919 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:48:28,919 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:48:28,919 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:48:28,919 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:48:28,924 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:48:28,924 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:48:28,980 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:48:28,980 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:48:28,980 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:48:31,048 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:48:31,049 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:48:31,049 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:48:31,049 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:48:31,049 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:48:31,052 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:48:31,052 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:48:54,348 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:48:54,349 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:48:58,685 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:48:58,693 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:49:00,714 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:49:00,714 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:49:00,723 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:49:00,724 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:49:00,724 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:49:00,724 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 10, 24, 0, 723931), 'iat': datetime.datetime(2025, 7, 8, 9, 49, 0, 723936)}
2025-07-08 02:49:00,724 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:49:03,358 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:49:03,359 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:49:07,959 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:49:07,967 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:49:10,020 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:49:10,020 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:49:10,026 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:49:10,026 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:49:10,026 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:49:10,026 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 10, 24, 10, 26734), 'iat': datetime.datetime(2025, 7, 8, 9, 49, 10, 26739)}
2025-07-08 02:49:10,027 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:49:11,812 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:49:11,812 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:49:11,813 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:52:11,284 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:52:11,288 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:52:16,018 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:52:16,023 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:52:18,045 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:52:18,045 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:52:18,052 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:52:18,052 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:52:18,052 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:52:18,052 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 10, 27, 18, 52152), 'iat': datetime.datetime(2025, 7, 8, 9, 52, 18, 52157)}
2025-07-08 02:52:18,053 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:52:21,195 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:52:21,203 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:52:21,203 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:52:21,204 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:52:21,211 - INFO - app.core.security - Redis connection closed.
2025-07-08 02:54:12,664 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 02:54:12,671 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 02:54:14,710 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 02:54:14,711 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 02:54:14,717 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:54:14,717 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:54:14,717 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:54:14,717 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 10, 29, 14, 717569), 'iat': datetime.datetime(2025, 7, 8, 9, 54, 14, 717574)}
2025-07-08 02:54:14,718 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:54:16,745 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:54:16,745 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:54:16,749 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:54:17,099 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:54:17,099 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:54:17,101 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:54:17,101 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:54:17,101 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:54:17,124 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:54:17,125 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:54:36,718 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:54:36,719 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:54:36,720 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:54:36,721 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751969907, 'iat': 1751968107}
2025-07-08 02:54:36,721 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 02:54:36,732 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 02:54:36,733 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 02:54:41,428 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 02:54:41,429 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 02:54:41,429 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 02:54:41,429 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 8, 10, 24, 41, 428812), 'iat': datetime.datetime(2025, 7, 8, 9, 54, 41, 428833)}
2025-07-08 02:54:41,430 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 02:54:41,431 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTI1NzMyODEsImlhdCI6MTc1MTk2ODQ4MX0.s1NgpbEwpHhuBhagqTnDgUZMr4B61-N4c4eWbIvX5Tg, Expiry (seconds): 604800
2025-07-08 02:54:41,463 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-08 02:54:42,711 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:54:42,711 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:54:42,712 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:54:42,712 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:54:42,712 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:54:42,712 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:54:42,712 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:54:42,713 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:54:42,713 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:54:42,713 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 02:54:42,723 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 02:54:42,723 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 02:54:42,724 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-08 02:54:42,739 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:54:42,739 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:54:42,740 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:54:42,740 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:54:42,740 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:54:42,740 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:54:42,740 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:54:42,741 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:54:42,741 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:54:42,742 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 02:54:42,756 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:54:42,757 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:54:42,758 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:54:42,758 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:54:42,759 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 02:54:42,801 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 02:54:42,802 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 02:54:42,805 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-08 02:54:42,835 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 02:54:42,842 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 02:54:43,297 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:54:43,298 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:54:43,298 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:54:43,299 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:54:43,299 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 02:54:43,314 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 02:54:43,314 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 02:54:43,654 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:54:43,657 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:54:43,657 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:54:43,805 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:54:43,805 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:54:43,806 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:54:43,806 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:54:43,806 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 02:54:43,834 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 02:54:43,834 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 02:54:50,850 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:54:50,851 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:54:50,852 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:54:50,852 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:54:50,852 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 02:54:50,864 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 02:54:50,864 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 02:55:01,063 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:55:01,064 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:55:01,064 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:55:01,065 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:55:01,066 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 02:55:01,090 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 02:55:01,091 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 02:55:21,640 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:55:21,640 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:55:21,641 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:55:21,642 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:55:21,642 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 02:55:21,642 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:55:21,642 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:55:21,643 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:55:21,644 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:55:21,645 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 02:55:21,718 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 02:55:21,726 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 02:55:21,726 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-08 02:55:30,140 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:55:30,140 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:55:30,141 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:55:30,141 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:55:30,141 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 02:55:30,158 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 02:55:30,158 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 02:55:38,829 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:55:38,829 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:55:38,830 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:55:38,831 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:55:38,833 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 02:55:38,855 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 02:55:38,856 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 02:55:44,629 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 02:55:44,629 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 02:55:44,630 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:55:44,630 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751970281, 'iat': 1751968481}
2025-07-08 02:55:44,631 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 02:55:44,639 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 02:55:44,639 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 02:55:50,516 - INFO - app.core.security - Closing Redis connection...
2025-07-08 02:55:50,519 - INFO - app.core.security - Redis connection closed.
2025-07-08 04:16:17,663 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 04:16:17,667 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 04:16:19,689 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 04:16:19,690 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 04:16:19,702 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 04:16:19,702 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 04:16:19,702 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 04:16:19,702 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 11, 51, 19, 702504), 'iat': datetime.datetime(2025, 7, 8, 11, 16, 19, 702508)}
2025-07-08 04:16:19,704 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 04:16:23,302 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:16:23,302 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:16:23,303 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751974140, 'iat': 1751972340}
2025-07-08 04:18:52,115 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:18:52,115 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:18:52,115 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751974140, 'iat': 1751972340}
2025-07-08 04:18:52,116 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751974140, 'iat': 1751972340}
2025-07-08 04:18:52,116 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 04:18:52,123 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 04:18:52,123 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:18:52,124 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzQxNDAsImlhdCI6MTc1MTk3MjM0MH0.YOFSh_tc-JgjV0unnZlvmOIyDiJPjqFh3ZztVtYTrFQ
2025-07-08 04:18:52,125 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzQxNDAsImlhdCI6MTc1MTk3MjM0MH0.YOFSh_tc-JgjV0unnZlvmOIyDiJPjqFh3ZztVtYTrFQ
2025-07-08 04:18:54,995 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 04:18:54,995 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 04:18:54,996 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 04:18:54,996 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 8, 11, 48, 54, 995418), 'iat': datetime.datetime(2025, 7, 8, 11, 18, 54, 995430)}
2025-07-08 04:18:54,996 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 04:18:54,997 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NzgzMzQsImlhdCI6MTc1MTk3MzUzNH0.0al8pzCy5zDvgkHWmJwJAbKaOS7Xx5RjCq5_ylgzqu0, Expiry (seconds): 604800
2025-07-08 04:18:55,086 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 04:18:56,346 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:18:56,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:18:56,355 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:18:56,357 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:18:56,359 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 04:18:56,360 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:18:56,361 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:18:56,364 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:18:56,364 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:18:56,364 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 04:18:56,380 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 04:18:56,380 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:18:56,381 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:18:56,418 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:18:56,420 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:18:56,423 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:18:56,425 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:18:56,425 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 04:18:56,426 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:18:56,426 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:18:56,429 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:18:56,430 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:18:56,430 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 04:18:56,446 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 04:18:56,447 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:18:56,447 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:18:56,461 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:18:56,461 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:18:56,462 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:18:56,462 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:18:56,462 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 04:18:56,479 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 04:18:56,480 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:18:56,755 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:18:56,755 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:18:56,755 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:18:56,755 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:18:56,755 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 04:18:56,761 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 04:18:56,762 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:18:57,076 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:18:57,077 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:18:57,077 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:18:57,100 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:18:57,100 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:18:57,103 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:18:57,104 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:18:57,109 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 04:18:57,132 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 04:18:57,134 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:20:06,463 - INFO - app.core.security - Closing Redis connection...
2025-07-08 04:20:06,464 - INFO - app.core.security - Redis connection closed.
2025-07-08 04:39:34,165 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 04:39:34,168 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 04:39:36,182 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 04:39:36,182 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 04:39:36,194 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 04:39:36,194 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 04:39:36,194 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 04:39:36,194 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 12, 14, 36, 194033), 'iat': datetime.datetime(2025, 7, 8, 11, 39, 36, 194035)}
2025-07-08 04:39:36,198 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 04:39:38,646 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:39:38,647 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:39:38,649 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:39:54,228 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:39:54,228 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:39:54,229 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:39:54,229 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:39:54,229 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 04:39:54,229 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:39:54,229 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:39:54,230 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:39:54,230 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:39:54,230 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 04:39:54,237 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 04:39:54,237 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:39:54,237 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:39:54,288 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:39:54,289 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:39:54,289 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:39:54,289 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:39:54,289 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 04:39:54,289 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:39:54,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:39:54,290 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:39:54,290 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:39:54,290 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 04:39:54,295 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 04:39:54,295 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:39:54,296 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:39:54,299 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:39:54,299 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:39:54,300 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:39:54,300 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:39:54,300 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 04:39:54,312 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 04:39:54,312 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:39:54,668 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:39:54,668 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:39:54,669 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:39:54,669 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:39:54,669 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 04:39:54,691 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 04:39:54,691 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:39:55,140 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:39:55,140 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:39:55,141 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:39:55,141 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:39:55,141 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 04:39:55,146 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 04:39:55,146 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:39:55,238 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:39:55,239 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:39:55,239 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751975334, 'iat': 1751973534}
2025-07-08 04:40:53,876 - INFO - app.core.security - Closing Redis connection...
2025-07-08 04:40:53,877 - INFO - app.core.security - Redis connection closed.
2025-07-08 04:52:41,007 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 04:52:41,011 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 04:52:43,035 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 04:52:43,035 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 04:52:43,039 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 04:52:43,039 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 04:52:43,039 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 04:52:43,039 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 12, 27, 43, 39103), 'iat': datetime.datetime(2025, 7, 8, 11, 52, 43, 39108)}
2025-07-08 04:52:43,039 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 04:53:00,021 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:53:00,021 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:53:00,022 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 04:53:00,037 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 04:53:00,064 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:53:00,065 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:53:00,065 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 04:53:00,068 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 04:53:00,099 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:53:00,099 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:53:00,099 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 04:53:00,101 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 04:53:00,229 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:53:00,229 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:53:00,230 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 04:53:00,231 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 04:53:00,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:53:00,242 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:53:00,242 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752578334, 'iat': 1751973534}
2025-07-08 04:53:00,242 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NzgzMzQsImlhdCI6MTc1MTk3MzUzNH0.0al8pzCy5zDvgkHWmJwJAbKaOS7Xx5RjCq5_ylgzqu0
2025-07-08 04:53:00,252 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NzgzMzQsImlhdCI6MTc1MTk3MzUzNH0.0al8pzCy5zDvgkHWmJwJAbKaOS7Xx5RjCq5_ylgzqu0
2025-07-08 04:53:00,255 - INFO - app.core.security - Refresh token deleted from Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1NzgzMzQsImlhdCI6MTc1MTk3MzUzNH0.0al8pzCy5zDvgkHWmJwJAbKaOS7Xx5RjCq5_ylgzqu0
2025-07-08 04:53:04,288 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 04:53:04,289 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 04:53:04,289 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 04:53:04,289 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 8, 12, 23, 4, 288599), 'iat': datetime.datetime(2025, 7, 8, 11, 53, 4, 288796)}
2025-07-08 04:53:04,290 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 04:53:04,290 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1ODAzODQsImlhdCI6MTc1MTk3NTU4NH0.b2BXrTUBQO1QDQBvifOufKYjvCB-5n-oXZN02Ha_Po8, Expiry (seconds): 604800
2025-07-08 04:53:04,297 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 04:53:05,418 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:53:05,418 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:53:05,418 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 04:53:05,418 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 04:53:05,419 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 04:53:05,419 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:53:05,419 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:53:05,419 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 04:53:05,420 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 04:53:05,420 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 04:53:05,429 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 04:53:05,430 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:53:05,430 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:53:05,441 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:53:05,442 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:53:05,442 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 04:53:05,442 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 04:53:05,442 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 04:53:05,442 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:53:05,442 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:53:05,443 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 04:53:05,443 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 04:53:05,443 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 04:53:05,445 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:53:05,445 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:53:05,446 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 04:53:05,446 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 04:53:05,446 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 04:53:05,456 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 04:53:05,456 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:53:05,456 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:53:05,462 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 04:53:05,462 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:53:05,740 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:53:05,740 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:53:05,740 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 04:53:05,740 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 04:53:05,741 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 04:53:05,745 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 04:53:05,745 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:53:06,297 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:53:06,297 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:53:06,297 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 04:53:06,297 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 04:53:06,297 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 04:53:06,301 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 04:53:06,302 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 04:53:06,361 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:53:06,361 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:53:06,362 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 04:54:52,053 - INFO - app.core.security - Closing Redis connection...
2025-07-08 04:54:52,053 - INFO - app.core.security - Redis connection closed.
2025-07-08 04:57:50,278 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 04:57:50,281 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 04:57:52,308 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 04:57:52,308 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 04:57:52,312 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 04:57:52,312 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 04:57:52,312 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 04:57:52,312 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 12, 32, 52, 312029), 'iat': datetime.datetime(2025, 7, 8, 11, 57, 52, 312035)}
2025-07-08 04:57:52,312 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 04:57:58,687 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 04:57:58,687 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 04:57:58,687 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 04:58:27,043 - INFO - app.core.security - Closing Redis connection...
2025-07-08 04:58:27,043 - INFO - app.core.security - Redis connection closed.
2025-07-08 05:08:09,361 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 05:08:09,364 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 05:08:11,396 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 05:08:11,396 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 05:08:11,401 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 05:08:11,401 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 05:08:11,401 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 05:08:11,401 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 12, 43, 11, 401499), 'iat': datetime.datetime(2025, 7, 8, 12, 8, 11, 401501)}
2025-07-08 05:08:11,401 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 05:08:15,300 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:08:15,300 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:08:15,301 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 05:08:24,328 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:08:24,328 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:08:24,329 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 05:08:24,329 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 05:08:24,329 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:08:24,345 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:08:24,345 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:08:52,336 - INFO - app.core.security - Closing Redis connection...
2025-07-08 05:08:52,337 - INFO - app.core.security - Redis connection closed.
2025-07-08 05:13:13,885 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 05:13:13,888 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 05:13:15,913 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 05:13:15,913 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 05:13:15,916 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 05:13:15,916 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 05:13:15,917 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 05:13:15,917 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 12, 48, 15, 916945), 'iat': datetime.datetime(2025, 7, 8, 12, 13, 15, 916947)}
2025-07-08 05:13:15,917 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 05:13:18,394 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:13:18,394 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:13:18,394 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 05:13:28,804 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:13:28,804 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:13:28,805 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 05:13:28,805 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 05:13:28,805 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:13:28,823 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:13:28,823 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:13:38,832 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:13:38,832 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:13:38,832 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 05:13:38,832 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 05:13:38,832 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:13:38,846 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:13:38,846 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:13:49,328 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:13:49,329 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:13:49,329 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 05:13:49,329 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 05:13:49,329 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:13:49,332 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:13:49,332 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:13:55,210 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:13:55,211 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:13:55,211 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 05:13:55,211 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751977384, 'iat': 1751975584}
2025-07-08 05:13:55,211 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:13:55,214 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:13:55,214 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:13:55,214 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzczODQsImlhdCI6MTc1MTk3NTU4NH0.aCuOaTHlaNlw5TW-BzSkCK4cnODeAyX_IynzuE5uFw4
2025-07-08 05:13:55,215 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NzczODQsImlhdCI6MTc1MTk3NTU4NH0.aCuOaTHlaNlw5TW-BzSkCK4cnODeAyX_IynzuE5uFw4
2025-07-08 05:13:57,476 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 05:13:57,477 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 05:13:57,477 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 05:13:57,477 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 8, 12, 43, 57, 476655), 'iat': datetime.datetime(2025, 7, 8, 12, 13, 57, 476664)}
2025-07-08 05:13:57,477 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 05:13:57,477 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTI1ODE2MzcsImlhdCI6MTc1MTk3NjgzN30.vIXYDVfpbJjOUXSAVRz_U5nd_JSNgiVALi4T1zaCJqk, Expiry (seconds): 604800
2025-07-08 05:13:59,138 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-08 05:14:00,288 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:14:00,289 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:14:00,289 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:14:00,289 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:14:00,289 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:14:00,289 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:14:00,289 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:14:00,290 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:14:00,290 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:14:00,290 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 05:14:00,294 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 05:14:00,294 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 05:14:00,294 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-08 05:14:00,302 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:14:00,302 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:14:00,302 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:14:00,302 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:14:00,302 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:14:00,302 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:14:00,302 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:14:00,303 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:14:00,303 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:14:00,303 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 05:14:00,307 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 05:14:00,308 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 05:14:00,308 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-08 05:14:00,314 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:14:00,315 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:14:00,315 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:14:00,316 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:14:00,316 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 05:14:00,324 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 05:14:00,325 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 05:14:00,469 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:14:00,469 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:14:00,469 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:14:00,470 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:14:00,470 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 05:14:00,472 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 05:14:00,472 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 05:14:00,588 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:14:00,588 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:14:00,588 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:14:00,588 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:14:00,588 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 05:14:00,591 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 05:14:00,591 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 05:14:00,788 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:14:00,788 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:14:00,788 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:17:16,239 - INFO - app.core.security - Closing Redis connection...
2025-07-08 05:17:16,241 - INFO - app.core.security - Redis connection closed.
2025-07-08 05:23:28,773 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 05:23:28,776 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 05:23:30,803 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 05:23:30,803 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 05:23:30,806 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 05:23:30,806 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 05:23:30,806 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 05:23:30,806 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 12, 58, 30, 806852), 'iat': datetime.datetime(2025, 7, 8, 12, 23, 30, 806854)}
2025-07-08 05:23:30,808 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 05:23:33,051 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:23:33,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:23:33,051 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:24:11,832 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:24:11,833 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:24:11,833 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:24:11,833 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:24:11,833 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:24:11,833 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:24:11,833 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:24:11,834 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:24:11,834 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:24:11,834 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 05:24:11,843 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 05:24:11,843 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 05:24:11,843 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-08 05:24:11,866 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:24:11,866 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:24:11,866 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:24:11,867 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:24:11,867 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:24:11,867 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:24:11,867 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:24:11,867 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:24:11,868 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:24:11,868 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 05:24:11,873 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 05:24:11,873 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 05:24:11,873 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-08 05:24:12,058 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:24:12,058 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:24:12,059 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:24:12,059 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:24:12,059 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 05:24:12,066 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 05:24:12,066 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 05:24:12,320 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:24:12,320 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:24:12,321 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:24:12,322 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:24:12,322 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 05:24:12,327 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 05:24:12,327 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 05:24:12,583 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:24:12,584 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:24:12,584 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:24:12,584 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:24:12,584 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 05:24:12,589 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 05:24:12,589 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 05:24:12,803 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:24:12,803 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:24:12,803 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:24:42,186 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:24:42,186 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:24:42,186 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:24:42,187 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751978637, 'iat': 1751976837}
2025-07-08 05:24:42,187 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-08 05:24:42,197 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-08 05:24:42,197 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-08 05:24:42,198 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5Nzg2MzcsImlhdCI6MTc1MTk3NjgzN30.r3mPYYpAUFgxu8kUkMxchfOojTaU_kkBR2j-IOM_l9c
2025-07-08 05:24:42,201 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5Nzg2MzcsImlhdCI6MTc1MTk3NjgzN30.r3mPYYpAUFgxu8kUkMxchfOojTaU_kkBR2j-IOM_l9c
2025-07-08 05:24:45,898 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 05:24:45,898 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 05:24:45,899 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 05:24:45,899 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 8, 12, 54, 45, 898592), 'iat': datetime.datetime(2025, 7, 8, 12, 24, 45, 898622)}
2025-07-08 05:24:45,901 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 05:24:45,902 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1ODIyODUsImlhdCI6MTc1MTk3NzQ4NX0.2GPToXmU4uOQZn5g3rR6YcCA4Tvkx6tlO1n3-0UOH6U, Expiry (seconds): 604800
2025-07-08 05:24:46,586 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 05:24:47,694 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:24:47,694 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:24:47,695 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:24:47,695 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:24:47,695 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:24:47,695 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:24:47,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:24:47,695 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:24:47,695 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:24:47,695 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:24:47,702 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:24:47,702 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:24:47,702 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:24:47,708 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:24:47,708 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:24:47,709 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:24:47,709 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:24:47,709 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:24:47,709 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:24:47,709 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:24:47,709 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:24:47,709 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:24:47,709 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:24:47,711 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:24:47,712 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:24:47,712 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:24:47,713 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:24:47,713 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:24:47,718 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:24:47,719 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:24:47,720 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:24:47,723 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:24:47,723 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:24:47,928 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:24:47,928 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:24:47,929 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:24:47,929 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:24:47,929 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:24:47,932 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:24:47,932 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:24:48,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:24:48,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:24:48,293 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:24:48,293 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:24:48,293 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:24:48,297 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:24:48,297 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:24:48,463 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:24:48,463 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:24:48,463 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:30:48,726 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:30:48,726 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:30:48,726 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:30:48,726 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:30:48,727 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:30:48,729 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:30:48,730 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:30:49,120 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:30:49,121 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:30:49,121 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:30:49,121 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979285, 'iat': 1751977485}
2025-07-08 05:30:49,122 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:30:49,127 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:30:49,127 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:30:59,095 - INFO - app.core.security - Closing Redis connection...
2025-07-08 05:30:59,097 - INFO - app.core.security - Redis connection closed.
2025-07-08 05:32:24,932 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 05:32:24,937 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 05:32:26,975 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 05:32:26,975 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 05:32:26,980 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 05:32:26,980 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 05:32:26,980 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 05:32:26,980 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 13, 7, 26, 980435), 'iat': datetime.datetime(2025, 7, 8, 12, 32, 26, 980437)}
2025-07-08 05:32:26,980 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 05:32:29,624 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 05:32:29,624 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 05:32:29,624 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 05:32:29,625 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 8, 13, 2, 29, 624449), 'iat': datetime.datetime(2025, 7, 8, 12, 32, 29, 624460)}
2025-07-08 05:32:29,625 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 05:32:29,625 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1ODI3NDksImlhdCI6MTc1MTk3Nzk0OX0.QBZ-P54JdXBke-SxhbwLU770FtKaCrbwZ1sIwF1MpFs, Expiry (seconds): 604800
2025-07-08 05:32:34,888 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 05:32:36,009 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:32:36,023 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:32:36,028 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:36,029 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:36,029 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:32:36,029 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:32:36,029 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:32:36,029 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:36,030 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:36,030 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:32:36,038 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:32:36,040 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:32:36,041 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:32:36,052 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:32:36,052 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:32:36,053 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:36,053 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:36,053 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:32:36,054 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:32:36,054 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:32:36,054 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:36,054 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:36,054 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:32:36,057 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:32:36,057 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:32:36,058 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:36,058 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:36,059 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:32:36,086 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:32:36,086 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:32:36,086 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:32:36,099 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:32:36,099 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:32:36,396 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:32:36,396 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:32:36,396 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:36,396 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:36,397 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:32:36,401 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:32:36,401 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:32:36,744 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:32:36,744 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:32:36,744 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:36,951 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:32:36,951 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:32:36,952 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:36,952 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:36,953 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:32:36,979 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:32:36,979 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:32:54,978 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:32:54,978 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:32:54,978 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:54,978 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:54,978 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:32:54,978 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:32:54,978 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:32:54,978 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:54,978 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:54,978 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:32:54,982 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:32:54,982 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:32:54,982 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:32:55,000 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:32:55,000 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:32:55,000 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:55,000 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:55,000 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:32:55,001 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:32:55,001 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:32:55,001 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:55,001 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:55,001 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:32:55,007 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:32:55,007 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:32:55,007 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:32:55,423 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:32:55,423 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:32:55,424 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:55,424 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:55,424 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:32:55,428 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:32:55,428 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:32:55,576 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:32:55,576 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:32:55,577 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:55,577 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:55,578 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:32:55,581 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:32:55,581 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:32:55,716 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:32:55,716 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:32:55,717 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:55,717 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:32:55,717 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:32:55,720 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:32:55,720 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:32:55,887 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:32:55,887 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:32:55,888 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:17,800 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:33:17,800 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:33:17,800 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:17,800 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:17,800 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:33:17,812 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:33:17,813 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:33:25,601 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:33:25,601 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:33:25,601 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:25,601 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:25,601 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:33:25,604 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:33:25,604 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:33:29,161 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:33:29,161 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:33:29,161 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:29,161 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:29,161 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:33:29,165 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:33:29,166 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:33:34,674 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:33:34,674 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:33:34,675 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:34,675 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:34,675 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:33:34,677 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:33:34,677 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:33:37,116 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:33:37,117 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:33:37,117 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:37,117 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:37,117 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:33:37,120 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:33:37,120 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:33:41,494 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:33:41,494 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:33:41,495 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:41,495 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:41,495 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:33:41,495 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:33:41,495 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:33:41,495 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:41,495 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:41,495 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:33:41,497 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:33:41,497 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:33:41,497 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:33:42,074 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:33:42,074 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:33:42,074 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:42,074 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:42,074 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:33:42,075 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:33:42,075 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:33:42,075 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:42,075 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:42,075 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:33:42,078 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:33:42,078 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:33:42,078 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:33:42,617 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:33:42,617 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:33:42,617 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:42,617 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:42,617 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:33:42,617 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:33:42,617 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:33:42,617 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:42,617 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:42,617 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:33:42,620 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:33:42,620 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:33:42,621 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:33:43,189 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:33:43,189 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:33:43,190 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:43,190 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:43,190 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:33:43,191 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:33:43,191 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:33:43,191 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:43,191 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:43,191 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:33:43,193 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:33:43,193 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:33:43,193 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:33:43,761 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:33:43,761 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:33:43,762 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:43,762 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:43,762 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:33:43,762 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:33:43,762 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:33:43,762 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:43,762 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:43,762 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:33:43,765 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:33:43,766 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:33:43,766 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:33:48,059 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:33:48,059 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:33:48,059 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:48,060 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:48,060 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:33:48,060 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:33:48,060 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:33:48,060 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:48,060 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:33:48,060 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:33:48,062 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:33:48,062 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:33:48,062 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:33:54,306 - INFO - app.core.security - Closing Redis connection...
2025-07-08 05:33:54,306 - INFO - app.core.security - Redis connection closed.
2025-07-08 05:35:56,697 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 05:35:56,700 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 05:35:58,718 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 05:35:58,718 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 05:35:58,722 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 05:35:58,722 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 05:35:58,722 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 05:35:58,722 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 13, 10, 58, 722050), 'iat': datetime.datetime(2025, 7, 8, 12, 35, 58, 722052)}
2025-07-08 05:35:58,722 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 05:36:00,341 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:36:00,341 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:36:00,341 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:38,640 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:37:38,640 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:37:38,641 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:38,641 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:38,641 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:37:38,651 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:37:38,651 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:37:40,928 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:37:40,928 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:37:40,929 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:40,929 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:40,929 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:37:40,932 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:37:40,932 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:37:46,378 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:37:46,380 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:37:46,381 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:46,381 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:46,381 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:37:46,386 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:37:46,386 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:37:51,337 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:37:51,337 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:37:51,338 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:51,338 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:51,338 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:37:51,344 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:37:51,344 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:37:56,108 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:37:56,108 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:37:56,108 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:56,108 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:56,108 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:37:56,108 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:37:56,109 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:37:56,109 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:56,109 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:56,109 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:37:56,113 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:37:56,113 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:37:56,114 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:37:56,731 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:37:56,731 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:37:56,732 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:56,732 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:56,732 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:37:56,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:37:56,732 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:37:56,733 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:56,733 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:56,733 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:37:56,745 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:37:56,746 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:37:56,747 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:37:57,363 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:37:57,363 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:37:57,363 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:57,363 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:57,363 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:37:57,363 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:37:57,364 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:37:57,364 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:57,364 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:57,364 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:37:57,369 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:37:57,369 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:37:57,369 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:37:57,978 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:37:57,978 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:37:57,979 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:57,979 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:57,979 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:37:57,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:37:57,979 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:37:57,979 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:57,979 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751979749, 'iat': 1751977949}
2025-07-08 05:37:57,979 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:37:57,984 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:37:57,984 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:37:57,984 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:38:07,751 - INFO - app.core.security - Closing Redis connection...
2025-07-08 05:38:07,752 - INFO - app.core.security - Redis connection closed.
2025-07-08 05:50:15,910 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 05:50:15,913 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 05:50:17,938 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 05:50:17,938 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 05:50:17,948 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 05:50:17,948 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 05:50:17,949 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 05:50:17,949 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 13, 25, 17, 948880), 'iat': datetime.datetime(2025, 7, 8, 12, 50, 17, 948884)}
2025-07-08 05:50:17,951 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 05:50:25,884 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 05:50:25,884 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 05:50:25,884 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 05:50:25,884 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 8, 13, 20, 25, 884055), 'iat': datetime.datetime(2025, 7, 8, 12, 50, 25, 884064)}
2025-07-08 05:50:25,884 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 05:50:25,885 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1ODM4MjUsImlhdCI6MTc1MTk3OTAyNX0.-lxpwtwP8FKKaMrE5lxbYR4rnLjmsDEKAqKIl4oBlhE, Expiry (seconds): 604800
2025-07-08 05:50:27,930 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 05:50:29,137 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:50:29,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:50:29,138 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:29,139 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:29,139 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:50:29,139 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:50:29,139 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:50:29,140 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:29,140 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:29,140 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:50:29,152 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:50:29,152 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:50:29,152 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:50:29,166 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:50:29,166 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:50:29,168 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:29,168 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:29,169 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:50:29,169 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:50:29,169 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:50:29,170 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:29,170 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:29,170 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:50:29,184 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:50:29,184 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:50:29,185 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:29,185 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:29,185 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:50:29,196 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:50:29,197 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:50:29,198 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:50:29,212 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:50:29,212 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:50:29,467 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:50:29,467 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:50:29,468 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:29,468 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:29,469 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:50:29,473 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:50:29,474 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:50:29,806 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:50:29,806 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:50:29,807 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:29,948 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:50:29,948 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:50:29,949 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:29,949 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:29,949 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:50:29,953 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:50:29,953 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:50:40,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:50:40,631 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:50:40,632 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:40,632 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:40,633 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:50:40,636 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:50:40,637 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:50:45,647 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:50:45,647 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:50:45,647 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:45,648 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:45,648 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:50:45,653 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:50:45,653 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:50:49,849 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:50:49,849 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:50:49,850 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:49,850 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:49,850 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:50:49,855 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:50:49,855 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:50:54,854 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:50:54,854 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:50:54,855 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:54,855 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:50:54,855 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:50:54,859 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:50:54,860 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:07,801 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:07,801 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:07,802 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:07,802 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:07,802 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:51:07,802 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:07,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:07,803 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:07,803 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:07,803 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:51:07,808 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:51:07,808 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:07,808 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:07,815 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:07,815 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:07,816 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:07,816 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:07,816 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:51:07,816 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:07,816 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:07,816 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:07,817 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:07,817 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:51:07,822 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:51:07,822 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:07,822 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:08,136 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:08,136 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:08,136 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:08,136 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:08,136 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:51:08,141 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:51:08,142 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:08,427 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:08,427 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:08,427 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:08,427 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:08,427 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:51:08,430 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:51:08,431 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:08,634 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:08,634 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:08,635 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:08,635 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:08,635 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:51:08,638 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:51:08,638 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:08,738 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:08,738 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:08,739 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:34,704 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:34,704 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:34,705 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:34,705 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:34,705 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:51:34,705 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:34,705 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:34,706 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:34,707 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:34,707 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:51:34,712 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:51:34,712 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:34,713 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:40,419 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:40,420 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:40,420 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:40,421 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:40,421 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:51:40,421 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:40,421 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:40,422 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:40,422 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:40,422 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:51:40,425 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:51:40,425 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:40,425 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:40,432 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:40,432 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:40,432 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:40,433 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:40,433 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:51:40,433 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:40,433 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:40,433 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:40,433 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:40,433 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:51:40,442 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:51:40,443 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:40,443 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:40,450 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:40,450 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:40,453 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:40,453 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:40,453 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:51:40,458 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:51:40,459 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:40,701 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:40,701 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:40,701 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:40,701 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:40,702 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:51:40,705 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:51:40,706 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:40,939 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:40,939 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:40,939 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:40,939 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:40,939 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:51:40,943 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:51:40,944 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:41,010 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:41,010 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:41,010 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:50,910 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:50,910 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:50,910 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:50,911 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:50,911 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:51:50,911 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:50,911 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:50,911 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:50,912 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:50,912 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:51:50,917 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:51:50,917 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:50,917 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:53,124 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:53,124 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:53,124 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:53,124 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:53,125 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:51:53,125 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:53,125 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:53,125 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:53,125 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:53,126 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:51:53,132 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:51:53,132 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:53,132 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:55,193 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:55,193 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:55,194 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:55,194 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:55,194 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:51:55,194 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:55,194 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:55,194 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:55,195 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:55,195 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:51:55,201 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:51:55,201 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:55,201 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:55,235 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:55,235 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:55,235 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:55,236 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:55,236 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:51:55,236 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:55,236 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:55,237 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:55,237 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:55,237 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:51:55,239 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:55,239 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:55,242 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:55,242 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:55,242 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:51:55,249 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:51:55,249 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:55,250 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:55,257 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:51:55,257 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:55,509 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:55,509 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:55,510 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:55,510 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:55,510 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:51:55,515 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:51:55,515 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:55,790 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:55,791 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:55,791 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:55,791 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:51:55,791 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:51:55,797 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:51:55,797 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:51:55,984 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:51:55,984 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:51:55,985 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:52:07,824 - INFO - app.core.security - Closing Redis connection...
2025-07-08 05:52:07,825 - INFO - app.core.security - Redis connection closed.
2025-07-08 05:56:37,951 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 05:56:37,956 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 05:56:39,989 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 05:56:39,989 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 05:56:39,994 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 05:56:39,994 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 05:56:39,994 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 05:56:39,994 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 13, 31, 39, 994158), 'iat': datetime.datetime(2025, 7, 8, 12, 56, 39, 994160)}
2025-07-08 05:56:39,994 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 05:56:42,860 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:56:42,860 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:56:42,860 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:58:11,637 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:58:11,637 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:58:11,637 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:58:11,637 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:58:11,637 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 05:58:11,638 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:58:11,638 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:58:11,638 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:58:11,638 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:58:11,638 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:58:11,642 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:58:11,642 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:58:11,642 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:58:24,505 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:58:24,505 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:58:24,506 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:58:24,506 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:58:24,506 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:58:24,510 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:58:24,510 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:58:29,239 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:58:29,239 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:58:29,239 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:58:29,239 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:58:29,239 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:58:29,241 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:58:29,241 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 05:58:56,918 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 05:58:56,918 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 05:58:56,918 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:58:56,918 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751980825, 'iat': 1751979025}
2025-07-08 05:58:56,919 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 05:58:56,923 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 05:58:56,923 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:00:03,349 - INFO - app.core.security - Closing Redis connection...
2025-07-08 06:00:03,350 - INFO - app.core.security - Redis connection closed.
2025-07-08 06:38:14,538 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 06:38:14,541 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 06:38:16,564 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 06:38:16,565 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 06:38:16,579 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 06:38:16,579 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 06:38:16,580 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 06:38:16,580 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 14, 13, 16, 579931), 'iat': datetime.datetime(2025, 7, 8, 13, 38, 16, 579933)}
2025-07-08 06:38:16,585 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 06:38:20,579 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:38:20,579 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:38:20,580 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752583825, 'iat': 1751979025}
2025-07-08 06:38:20,580 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1ODM4MjUsImlhdCI6MTc1MTk3OTAyNX0.-lxpwtwP8FKKaMrE5lxbYR4rnLjmsDEKAqKIl4oBlhE
2025-07-08 06:38:20,603 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:38:20,603 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:38:20,603 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 06:38:22,666 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:38:22,666 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:38:22,666 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752583825, 'iat': 1751979025}
2025-07-08 06:38:22,666 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1ODM4MjUsImlhdCI6MTc1MTk3OTAyNX0.-lxpwtwP8FKKaMrE5lxbYR4rnLjmsDEKAqKIl4oBlhE
2025-07-08 06:38:24,642 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1ODM4MjUsImlhdCI6MTc1MTk3OTAyNX0.-lxpwtwP8FKKaMrE5lxbYR4rnLjmsDEKAqKIl4oBlhE
2025-07-08 06:38:25,942 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:38:25,943 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:38:25,943 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 06:38:26,671 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1ODM4MjUsImlhdCI6MTc1MTk3OTAyNX0.-lxpwtwP8FKKaMrE5lxbYR4rnLjmsDEKAqKIl4oBlhE
2025-07-08 06:38:28,691 - INFO - app.core.security - Refresh token deleted from Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1ODM4MjUsImlhdCI6MTc1MTk3OTAyNX0.-lxpwtwP8FKKaMrE5lxbYR4rnLjmsDEKAqKIl4oBlhE
2025-07-08 06:38:28,722 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1ODM4MjUsImlhdCI6MTc1MTk3OTAyNX0.-lxpwtwP8FKKaMrE5lxbYR4rnLjmsDEKAqKIl4oBlhE
2025-07-08 06:38:31,263 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:38:31,263 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:38:31,263 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 06:38:37,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:38:37,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:38:37,293 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 06:38:37,794 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:38:37,794 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:38:37,794 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752583825, 'iat': 1751979025}
2025-07-08 06:38:37,794 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1ODM4MjUsImlhdCI6MTc1MTk3OTAyNX0.-lxpwtwP8FKKaMrE5lxbYR4rnLjmsDEKAqKIl4oBlhE
2025-07-08 06:38:37,795 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1ODM4MjUsImlhdCI6MTc1MTk3OTAyNX0.-lxpwtwP8FKKaMrE5lxbYR4rnLjmsDEKAqKIl4oBlhE
2025-07-08 06:38:42,612 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:38:42,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:38:42,612 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 06:38:45,665 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:38:45,665 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:38:45,666 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 06:38:45,668 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 06:38:46,185 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:38:46,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:38:46,186 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 06:38:46,187 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 06:38:46,707 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:38:46,707 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:38:46,708 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 06:38:46,711 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 06:38:47,926 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:38:47,927 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:38:47,927 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 06:38:53,288 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:38:53,288 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:38:53,289 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 06:38:54,476 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:38:54,476 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:38:54,476 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752583825, 'iat': 1751979025}
2025-07-08 06:38:54,476 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1ODM4MjUsImlhdCI6MTc1MTk3OTAyNX0.-lxpwtwP8FKKaMrE5lxbYR4rnLjmsDEKAqKIl4oBlhE
2025-07-08 06:38:54,477 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1ODM4MjUsImlhdCI6MTc1MTk3OTAyNX0.-lxpwtwP8FKKaMrE5lxbYR4rnLjmsDEKAqKIl4oBlhE
2025-07-08 06:38:55,578 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:38:55,578 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:38:55,579 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 06:38:55,581 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 06:38:58,849 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 06:38:58,849 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 06:38:58,849 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 06:38:58,849 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 8, 14, 8, 58, 849020), 'iat': datetime.datetime(2025, 7, 8, 13, 38, 58, 849051)}
2025-07-08 06:38:58,850 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 06:38:58,850 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1ODY3MzgsImlhdCI6MTc1MTk4MTkzOH0.Mj6g0tMzeksZGdS3pKRO6lpV2wY75XQfgpsOhU3e-Uc, Expiry (seconds): 604800
2025-07-08 06:38:58,855 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 06:39:00,072 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:00,072 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:00,073 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:00,073 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:00,073 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 06:39:00,074 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:00,074 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:00,079 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:00,079 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:00,079 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 06:39:00,123 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 06:39:00,125 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:00,125 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:00,184 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:00,184 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:00,185 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:00,185 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:00,185 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 06:39:00,185 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:00,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:00,185 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:00,186 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:00,186 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 06:39:00,193 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 06:39:00,194 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:00,194 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:00,199 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:00,199 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:00,201 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:00,201 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:00,201 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 06:39:00,219 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 06:39:00,220 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:00,819 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:00,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:00,820 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:00,820 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:00,820 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 06:39:00,824 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 06:39:00,824 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:01,129 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:01,129 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:01,130 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:01,130 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:01,130 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 06:39:01,142 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 06:39:01,142 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:01,226 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:01,226 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:01,226 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:07,647 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:07,647 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:07,647 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:07,647 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:07,647 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 06:39:07,648 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:07,648 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:07,648 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:07,648 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:07,648 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 06:39:07,652 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 06:39:07,653 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:07,653 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:08,322 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:08,322 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:08,323 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:08,323 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:08,323 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 06:39:08,323 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:08,323 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:08,323 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:08,323 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:08,323 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 06:39:08,333 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 06:39:08,334 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:08,334 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:08,945 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:08,945 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:08,946 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:08,947 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:08,947 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 06:39:08,947 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:08,947 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:08,947 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:08,947 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:08,948 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 06:39:08,951 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 06:39:08,951 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:08,951 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:15,022 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:15,022 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:15,023 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:15,023 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:15,023 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 06:39:15,027 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 06:39:15,027 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:17,595 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:17,595 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:17,596 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:17,596 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:17,596 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 06:39:17,605 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 06:39:17,605 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:21,194 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:21,194 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:21,194 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:21,195 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:21,195 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 06:39:21,195 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:21,195 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:21,195 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:21,195 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:21,196 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 06:39:21,199 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 06:39:21,200 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:21,200 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:21,208 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:21,208 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:21,208 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:21,208 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:21,208 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 06:39:21,209 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:21,209 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:21,209 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:21,209 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:21,209 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 06:39:21,212 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 06:39:21,212 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:21,213 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:21,225 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:21,225 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:21,226 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:21,226 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:21,226 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 06:39:21,232 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 06:39:21,233 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:21,446 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:21,446 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:21,446 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:21,446 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:21,446 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 06:39:21,450 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 06:39:21,451 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:21,637 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:21,637 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:21,637 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:21,637 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:39:21,637 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 06:39:21,644 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 06:39:21,644 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 06:39:21,762 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:39:21,762 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:39:21,763 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:41:06,586 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 06:41:06,586 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 06:41:06,587 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:41:06,587 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751983738, 'iat': 1751981938}
2025-07-08 06:41:06,587 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 06:41:06,592 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 06:41:06,593 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:06:45,273 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 09:06:45,279 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 09:06:47,315 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 09:06:47,315 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 09:06:47,358 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 09:06:47,358 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 09:06:47,358 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 09:06:47,358 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 16, 41, 47, 358648), 'iat': datetime.datetime(2025, 7, 8, 16, 6, 47, 358652)}
2025-07-08 09:06:47,364 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 09:06:54,470 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:06:54,470 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:06:54,471 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751991555, 'iat': 1751989755}
2025-07-08 09:06:59,915 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:06:59,915 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:06:59,916 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751991555, 'iat': 1751989755}
2025-07-08 09:06:59,916 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751991555, 'iat': 1751989755}
2025-07-08 09:06:59,916 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:06:59,963 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:06:59,963 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:06:59,964 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5OTE1NTUsImlhdCI6MTc1MTk4OTc1NX0.Y19O087p3nmuT-ggI_sYnLhqlRfFjD1G7M7BwLAEs2I
2025-07-08 09:07:01,574 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:07:01,574 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:07:01,575 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751991555, 'iat': 1751989755}
2025-07-08 09:07:01,575 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751991555, 'iat': 1751989755}
2025-07-08 09:07:01,575 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:07:01,616 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:07:01,616 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:07:01,616 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5OTE1NTUsImlhdCI6MTc1MTk4OTc1NX0.Y19O087p3nmuT-ggI_sYnLhqlRfFjD1G7M7BwLAEs2I
2025-07-08 09:07:02,354 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5OTE1NTUsImlhdCI6MTc1MTk4OTc1NX0.Y19O087p3nmuT-ggI_sYnLhqlRfFjD1G7M7BwLAEs2I
2025-07-08 09:07:02,400 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5OTE1NTUsImlhdCI6MTc1MTk4OTc1NX0.Y19O087p3nmuT-ggI_sYnLhqlRfFjD1G7M7BwLAEs2I
2025-07-08 09:07:06,434 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 09:07:06,435 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 09:07:06,435 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 09:07:06,435 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 8, 16, 37, 6, 434669), 'iat': datetime.datetime(2025, 7, 8, 16, 7, 6, 434682)}
2025-07-08 09:07:06,435 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 09:07:06,435 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1OTU2MjYsImlhdCI6MTc1MTk5MDgyNn0.DdZv-EHv2WUbNOApx9hKG4-zqKBsHXm-jyQ9cu9NzRo, Expiry (seconds): 604800
2025-07-08 09:07:06,436 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 09:07:07,531 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:07:07,531 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:07:07,532 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:07:07,532 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:07:07,532 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 09:07:07,532 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:07:07,532 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:07:07,532 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:07:07,532 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:07:07,532 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:07:07,535 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:07:07,535 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:07:07,535 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:07:07,554 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:07:07,554 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:07:07,555 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:07:07,555 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:07:07,555 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 09:07:07,555 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:07:07,555 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:07:07,555 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:07:07,555 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:07:07,555 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:07:07,562 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:07:07,562 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:07:07,562 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:07:07,564 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:07:07,564 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:07:07,565 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:07:07,565 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:07:07,565 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:07:07,572 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:07:07,573 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:07:07,766 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:07:07,766 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:07:07,766 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:07:07,766 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:07:07,767 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:07:07,770 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:07:07,770 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:07:07,889 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:07:07,889 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:07:07,889 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:07:07,889 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:07:07,889 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:07:07,892 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:07:07,892 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:07:08,080 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:07:08,080 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:07:08,080 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:20:33,038 - INFO - app.core.security - Closing Redis connection...
2025-07-08 09:20:33,039 - INFO - app.core.security - Redis connection closed.
2025-07-08 09:32:17,867 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 09:32:17,871 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 09:32:19,901 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 09:32:19,901 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 09:32:19,905 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 09:32:19,905 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 09:32:19,905 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 09:32:19,905 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 17, 7, 19, 905093), 'iat': datetime.datetime(2025, 7, 8, 16, 32, 19, 905096)}
2025-07-08 09:32:19,905 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 09:32:24,186 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:32:24,186 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:32:24,187 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:32:33,560 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:32:33,560 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:32:33,560 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:32:33,560 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:32:33,560 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 09:32:33,561 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:32:33,561 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:32:33,561 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:32:33,561 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:32:33,561 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:32:33,601 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:32:33,601 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:32:33,601 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:32:33,646 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:32:33,647 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:32:33,648 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:32:33,648 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:32:33,648 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 09:32:33,648 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:32:33,648 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:32:33,649 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:32:33,649 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:32:33,649 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:32:33,665 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:32:33,666 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:32:33,666 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:32:33,672 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:32:33,673 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:32:33,707 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:32:33,707 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:32:33,708 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:32:33,726 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:32:33,727 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:32:34,051 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:32:34,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:32:34,052 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:32:34,052 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:32:34,052 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:32:34,056 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:32:34,056 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:32:34,364 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:32:34,364 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:32:34,365 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:32:34,365 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:32:34,365 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:32:34,389 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:32:34,389 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:32:34,390 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:32:34,415 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:32:34,415 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:33:15,075 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:33:15,075 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:33:15,075 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:15,075 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:15,075 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:33:15,090 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:33:15,090 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:33:19,874 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:33:19,874 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:33:19,875 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:19,875 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:19,875 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:33:19,880 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:33:19,881 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:33:37,953 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:33:37,953 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:33:37,954 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:37,954 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:37,954 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 09:33:37,954 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:33:37,954 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:33:37,955 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:37,955 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:37,955 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:33:37,961 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:33:37,962 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:33:37,962 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:33:37,973 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:33:37,974 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:33:37,974 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:37,975 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:37,975 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 09:33:37,975 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:33:37,975 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:33:37,975 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:37,975 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:37,975 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:33:37,983 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:33:37,983 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:33:37,983 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:37,984 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:37,984 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:33:37,987 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:33:37,988 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:33:37,988 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:33:37,990 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:33:37,991 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:33:38,203 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:33:38,203 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:33:38,203 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:38,203 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:38,203 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:33:38,206 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:33:38,206 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:33:38,654 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:33:38,654 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:33:38,654 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:38,654 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:38,654 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:33:38,660 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:33:38,661 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:33:38,969 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:33:38,969 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:33:38,969 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:33:53,201 - INFO - app.core.security - Closing Redis connection...
2025-07-08 09:33:53,204 - INFO - app.core.security - Redis connection closed.
2025-07-08 09:36:57,761 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 09:36:57,766 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 09:36:59,811 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 09:36:59,811 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 09:36:59,818 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 09:36:59,818 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 09:36:59,818 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 09:36:59,818 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 17, 11, 59, 818689), 'iat': datetime.datetime(2025, 7, 8, 16, 36, 59, 818693)}
2025-07-08 09:36:59,819 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 09:37:02,424 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:02,424 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:02,425 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751992626, 'iat': 1751990826}
2025-07-08 09:37:09,166 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:09,167 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:09,168 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 09:37:09,182 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 09:37:15,262 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:15,262 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:15,263 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 09:37:15,267 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 09:37:18,908 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 09:37:18,909 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 09:37:18,909 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 09:37:18,910 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 8, 17, 7, 18, 908864), 'iat': datetime.datetime(2025, 7, 8, 16, 37, 18, 908886)}
2025-07-08 09:37:18,910 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 09:37:18,912 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1OTc0MzgsImlhdCI6MTc1MTk5MjYzOH0.7EDKMhP1WiCvmgKMIChb4RNXllWmlwtAxQ1mqszVIbM, Expiry (seconds): 604800
2025-07-08 09:37:18,916 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 09:37:20,101 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:20,101 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:20,101 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:20,102 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:20,102 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 09:37:20,102 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:20,102 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:20,102 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:20,102 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:20,103 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:37:20,110 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:37:20,110 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:20,110 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:20,118 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:20,118 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:20,118 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:20,119 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:20,119 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 09:37:20,119 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:20,119 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:20,119 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:20,120 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:20,120 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:37:20,122 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:20,123 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:20,123 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:20,123 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:20,123 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:37:20,129 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:37:20,130 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:20,131 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:20,136 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:37:20,137 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:20,429 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:20,429 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:20,429 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:20,430 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:20,430 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:37:20,434 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:37:20,434 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:20,967 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:20,967 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:20,968 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:20,968 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:20,968 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:37:20,981 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:20,981 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:20,981 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:20,984 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:37:20,985 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:29,649 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:29,649 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:29,649 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:29,650 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:29,650 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 09:37:29,650 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:29,650 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:29,650 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:29,650 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:29,651 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:37:29,655 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:37:29,655 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:29,655 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:30,319 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:30,320 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:30,320 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:30,320 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:30,320 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 09:37:30,321 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:30,321 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:30,321 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:30,321 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:30,321 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:37:30,329 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:37:30,330 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:30,330 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:39,762 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:39,762 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:39,764 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:39,764 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:39,765 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:37:39,779 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:37:39,779 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:45,329 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:45,329 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:45,329 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:45,329 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:45,329 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:37:45,334 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:37:45,334 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:53,971 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:53,971 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:53,971 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:53,972 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:53,972 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 09:37:53,972 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:53,972 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:53,972 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:53,972 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:53,973 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:37:53,979 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:37:53,979 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:53,979 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:53,988 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:53,988 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:53,989 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:53,990 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:53,990 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 09:37:53,990 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:53,990 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:53,991 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:53,991 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:53,991 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:37:53,995 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:37:53,995 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:53,995 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:54,007 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:54,007 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:54,008 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:54,008 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:54,008 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:37:54,018 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:37:54,019 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:54,273 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:54,274 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:54,274 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:54,274 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:54,274 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:37:54,280 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:37:54,280 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:54,508 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:54,508 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:54,509 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:54,509 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:37:54,509 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 09:37:54,513 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 09:37:54,514 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 09:37:54,759 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 09:37:54,759 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 09:37:54,760 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 09:38:11,549 - INFO - app.core.security - Closing Redis connection...
2025-07-08 09:38:11,551 - INFO - app.core.security - Redis connection closed.
2025-07-08 09:44:17,670 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 09:44:17,675 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 09:44:19,730 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 09:44:19,730 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 09:44:19,737 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 09:44:19,737 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 09:44:19,737 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 09:44:19,737 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 17, 19, 19, 737037), 'iat': datetime.datetime(2025, 7, 8, 16, 44, 19, 737043)}
2025-07-08 09:44:19,737 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 09:44:28,477 - INFO - app.core.security - Closing Redis connection...
2025-07-08 09:44:28,478 - INFO - app.core.security - Redis connection closed.
2025-07-08 10:00:44,291 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 10:00:44,295 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 10:00:46,345 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 10:00:46,345 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 10:00:46,352 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 10:00:46,353 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 10:00:46,353 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 10:00:46,353 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 17, 35, 46, 352967), 'iat': datetime.datetime(2025, 7, 8, 17, 0, 46, 352972)}
2025-07-08 10:00:46,353 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 10:00:50,106 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:00:50,106 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:00:50,107 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 10:00:50,108 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 10:00:50,108 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:00:50,140 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:00:50,141 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:00:50,143 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5OTQ0MzgsImlhdCI6MTc1MTk5MjYzOH0.Xo6nhGQEIyuR0SzarN8I1ct-9wI38CIh5ASRbiG8YjU
2025-07-08 10:00:51,807 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:00:51,807 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:00:51,808 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 10:00:52,302 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:00:52,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:00:52,304 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 10:00:52,304 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 10:00:52,304 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:00:52,351 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:00:52,352 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:00:52,353 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5OTQ0MzgsImlhdCI6MTc1MTk5MjYzOH0.Xo6nhGQEIyuR0SzarN8I1ct-9wI38CIh5ASRbiG8YjU
2025-07-08 10:00:53,784 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:00:53,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:00:53,785 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 10:00:53,785 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751994438, 'iat': 1751992638}
2025-07-08 10:00:53,786 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:00:53,803 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:00:53,803 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:00:53,804 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5OTQ0MzgsImlhdCI6MTc1MTk5MjYzOH0.Xo6nhGQEIyuR0SzarN8I1ct-9wI38CIh5ASRbiG8YjU
2025-07-08 10:00:55,457 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5OTQ0MzgsImlhdCI6MTc1MTk5MjYzOH0.Xo6nhGQEIyuR0SzarN8I1ct-9wI38CIh5ASRbiG8YjU
2025-07-08 10:00:57,499 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5OTQ0MzgsImlhdCI6MTc1MTk5MjYzOH0.Xo6nhGQEIyuR0SzarN8I1ct-9wI38CIh5ASRbiG8YjU
2025-07-08 10:00:57,525 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5OTQ0MzgsImlhdCI6MTc1MTk5MjYzOH0.Xo6nhGQEIyuR0SzarN8I1ct-9wI38CIh5ASRbiG8YjU
2025-07-08 10:00:59,158 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 10:00:59,158 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 10:00:59,158 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 10:00:59,158 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 8, 17, 30, 59, 157987), 'iat': datetime.datetime(2025, 7, 8, 17, 0, 59, 158000)}
2025-07-08 10:00:59,159 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 10:00:59,160 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI1OTg4NTksImlhdCI6MTc1MTk5NDA1OX0._9YOtDICQBu8XkS0czXRSaU6rNDeKgDe0wGkbos4Jn4, Expiry (seconds): 604800
2025-07-08 10:00:59,907 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 10:01:01,482 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:01,482 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:01,483 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:01,483 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:01,484 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 10:01:01,484 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:01,484 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:01,485 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:01,485 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:01,485 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:01,491 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:01,492 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:01,492 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:01,504 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:01,504 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:01,505 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:01,505 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:01,505 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 10:01:01,506 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:01,506 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:01,507 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:01,507 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:01,507 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:01,539 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:01,539 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:01,540 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:01,540 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:01,540 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:01,556 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:01,556 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:01,560 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:01,568 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:01,568 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:01,959 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:01,959 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:01,961 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:01,961 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:01,961 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:01,967 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:01,967 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:02,299 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:02,299 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:02,300 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:03,802 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:03,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:03,804 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:03,804 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:03,804 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:03,840 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:03,841 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:12,895 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:12,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:12,897 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:12,897 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:12,898 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 10:01:12,898 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:12,898 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:12,899 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:12,899 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:12,899 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:12,913 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:12,914 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:12,914 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:13,805 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:13,806 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:13,806 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:13,807 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:13,807 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 10:01:13,808 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:13,808 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:13,809 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:13,809 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:13,809 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:13,847 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:13,848 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:13,848 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:17,531 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:17,531 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:17,533 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:17,533 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:17,533 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 10:01:17,533 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:17,533 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:17,539 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:17,540 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:17,540 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:17,567 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:17,567 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:17,568 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:17,585 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:17,585 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:17,586 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:17,587 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:17,587 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 10:01:17,587 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:17,587 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:17,588 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:17,588 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:17,588 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:17,598 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:17,598 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:17,599 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:17,600 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:17,600 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:17,607 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:17,607 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:17,608 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:17,633 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:17,634 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:18,127 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:18,128 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:18,129 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:18,129 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:18,129 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:18,141 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:18,141 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:18,969 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:18,969 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:18,970 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:18,974 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:18,975 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:18,975 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:18,976 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:18,976 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:18,994 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:18,994 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:28,494 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:28,494 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:28,495 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:28,495 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:28,496 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:28,524 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:28,525 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:31,378 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:31,380 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:31,381 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:31,381 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:31,381 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:31,402 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:31,403 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:34,568 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:34,570 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:34,571 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:34,571 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:34,572 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 10:01:34,572 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:34,572 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:34,573 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:34,575 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:34,576 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:34,586 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:34,586 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:34,586 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:34,597 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:34,598 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:34,599 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:34,599 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:34,599 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 10:01:34,599 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:34,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:34,600 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:34,600 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:34,601 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:34,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:34,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:34,610 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:34,610 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:34,610 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:34,628 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:34,631 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:34,631 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:34,642 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:34,643 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:35,139 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:35,140 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:35,141 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:35,141 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:35,141 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:35,148 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:35,148 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:35,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:35,609 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:35,610 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:35,610 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:01:35,610 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:01:35,619 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:01:35,619 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:01:35,781 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:01:35,781 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:01:35,782 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:04:14,254 - INFO - app.core.security - Closing Redis connection...
2025-07-08 10:04:14,258 - INFO - app.core.security - Redis connection closed.
2025-07-08 10:04:19,747 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 10:04:19,751 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 10:04:21,808 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 10:04:21,808 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 10:04:21,817 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 10:04:21,817 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 10:04:21,817 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 10:04:21,817 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 17, 39, 21, 817648), 'iat': datetime.datetime(2025, 7, 8, 17, 4, 21, 817652)}
2025-07-08 10:04:21,818 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 10:04:24,469 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:04:24,469 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:04:24,470 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:05:39,659 - INFO - app.core.security - Closing Redis connection...
2025-07-08 10:05:39,660 - INFO - app.core.security - Redis connection closed.
2025-07-08 10:11:32,807 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 10:11:32,810 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 10:11:34,854 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 10:11:34,854 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 10:11:34,863 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 10:11:34,863 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 10:11:34,863 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 10:11:34,863 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 17, 46, 34, 863434), 'iat': datetime.datetime(2025, 7, 8, 17, 11, 34, 863440)}
2025-07-08 10:11:34,864 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 10:11:37,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:11:37,949 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:11:37,949 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:11:41,964 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:11:41,965 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:11:41,965 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:11:41,966 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:11:41,966 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 10:11:41,966 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:11:41,966 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:11:41,966 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:11:41,966 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:11:41,967 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:11:41,985 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:11:41,985 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:11:41,985 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:12:27,187 - INFO - app.core.security - Closing Redis connection...
2025-07-08 10:12:27,189 - INFO - app.core.security - Redis connection closed.
2025-07-08 10:12:31,640 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 10:12:31,647 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 10:12:33,684 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 10:12:33,684 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 10:12:33,691 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 10:12:33,691 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 10:12:33,691 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 10:12:33,691 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 17, 47, 33, 691462), 'iat': datetime.datetime(2025, 7, 8, 17, 12, 33, 691467)}
2025-07-08 10:12:33,692 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 10:12:35,860 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:12:35,860 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:12:35,861 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:12:57,228 - INFO - app.core.security - Closing Redis connection...
2025-07-08 10:12:57,230 - INFO - app.core.security - Redis connection closed.
2025-07-08 10:13:01,693 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 10:13:01,701 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 10:13:03,737 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 10:13:03,737 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 10:13:03,747 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 10:13:03,747 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 10:13:03,747 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 10:13:03,747 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 17, 48, 3, 747360), 'iat': datetime.datetime(2025, 7, 8, 17, 13, 3, 747367)}
2025-07-08 10:13:03,748 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 10:13:09,096 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:13:09,097 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:13:09,097 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:13:27,527 - INFO - app.core.security - Closing Redis connection...
2025-07-08 10:13:27,528 - INFO - app.core.security - Redis connection closed.
2025-07-08 10:13:31,165 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 10:13:31,169 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 10:13:33,200 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 10:13:33,201 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 10:13:33,208 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 10:13:33,208 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 10:13:33,208 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 10:13:33,208 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 17, 48, 33, 208305), 'iat': datetime.datetime(2025, 7, 8, 17, 13, 33, 208310)}
2025-07-08 10:13:33,209 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 10:13:35,702 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:13:35,702 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:13:35,703 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:13:40,190 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:13:40,191 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:13:40,191 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:13:40,191 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:13:40,192 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 10:13:40,192 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:13:40,192 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:13:40,192 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:13:40,192 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:13:40,192 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:13:40,233 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:13:40,234 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:13:40,234 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:14:39,227 - INFO - app.core.security - Closing Redis connection...
2025-07-08 10:14:39,229 - INFO - app.core.security - Redis connection closed.
2025-07-08 10:16:29,538 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 10:16:29,544 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 10:16:31,579 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 10:16:31,580 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 10:16:31,585 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 10:16:31,585 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 10:16:31,586 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 10:16:31,586 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 8, 17, 51, 31, 585890), 'iat': datetime.datetime(2025, 7, 8, 17, 16, 31, 585894)}
2025-07-08 10:16:31,586 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 10:16:36,445 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:16:36,446 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:16:36,446 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:16:40,684 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:16:40,685 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:16:40,686 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:16:40,686 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:16:40,686 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 10:16:40,686 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:16:40,686 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:16:40,686 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:16:40,687 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:16:40,687 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:16:40,696 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:16:40,696 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:16:40,696 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:16:52,131 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:16:52,132 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:16:52,133 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:16:52,133 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:16:52,134 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:16:52,152 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:16:52,157 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:16:58,389 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:16:58,390 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:16:58,391 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:16:58,391 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:16:58,391 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:16:58,408 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:16:58,408 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:17:07,942 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:17:07,944 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:17:07,945 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:17:07,946 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:17:07,946 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 10:17:07,947 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:17:07,947 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:17:07,948 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:17:07,948 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:17:07,949 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:17:07,976 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:17:07,977 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:17:07,978 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:17:08,016 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:17:08,016 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:17:08,017 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:17:08,017 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:17:08,017 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 10:17:08,017 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:17:08,018 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:17:08,018 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:17:08,018 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:17:08,018 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:17:08,029 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:17:08,030 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:17:08,030 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:17:08,094 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:17:08,096 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:17:08,097 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:17:08,098 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:17:08,110 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:17:08,143 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:17:08,144 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:17:08,603 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:17:08,603 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:17:08,605 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:17:08,606 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:17:08,606 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:17:08,614 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:17:08,616 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:17:08,954 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:17:08,954 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:17:08,956 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:17:09,149 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 10:17:09,150 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 10:17:09,151 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:17:09,151 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751995859, 'iat': 1751994059}
2025-07-08 10:17:09,154 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 10:17:09,162 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 10:17:09,162 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 10:17:55,625 - INFO - app.core.security - Closing Redis connection...
2025-07-08 10:17:55,627 - INFO - app.core.security - Redis connection closed.
2025-07-08 20:38:46,876 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 20:38:46,880 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 20:38:48,915 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 20:38:48,915 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 20:38:48,919 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 20:38:48,919 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 20:38:48,919 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 20:38:48,920 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 9, 4, 13, 48, 919918), 'iat': datetime.datetime(2025, 7, 9, 3, 38, 48, 919920)}
2025-07-08 20:38:48,921 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 20:39:14,054 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:39:14,054 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:39:14,055 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 20:39:14,059 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 20:39:14,070 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:39:14,070 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:39:14,071 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 20:39:14,072 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 20:39:14,089 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:39:14,089 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:39:14,089 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 20:39:14,091 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 20:39:14,125 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:39:14,126 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:39:14,126 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 20:39:14,134 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 20:39:18,066 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 20:39:18,066 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 20:39:18,066 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 20:39:18,066 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 9, 4, 9, 18, 66166), 'iat': datetime.datetime(2025, 7, 9, 3, 39, 18, 66186)}
2025-07-08 20:39:18,067 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 20:39:18,067 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI2MzcxNTgsImlhdCI6MTc1MjAzMjM1OH0.IC6jxRBQ3sCrbNV79qXFm0BtHLgmKG6uGVCYBSX4MwA, Expiry (seconds): 604800
2025-07-08 20:39:18,068 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 20:39:19,129 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:39:19,129 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:39:19,129 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:39:19,130 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:39:19,130 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 20:39:19,130 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:39:19,130 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:39:19,131 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:39:19,131 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:39:19,131 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:39:19,136 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:39:19,136 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:39:19,136 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:39:19,146 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:39:19,146 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:39:19,147 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:39:19,147 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:39:19,147 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 20:39:19,147 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:39:19,148 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:39:19,148 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:39:19,148 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:39:19,148 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:39:19,153 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:39:19,154 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:39:19,154 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:39:19,161 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:39:19,162 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:39:19,164 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:39:19,164 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:39:19,167 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:39:19,177 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:39:19,179 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:39:19,459 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:39:19,459 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:39:19,460 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:39:19,460 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:39:19,460 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:39:19,464 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:39:19,464 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:39:19,759 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:39:19,759 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:39:19,759 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:39:19,759 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:39:19,760 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:39:19,764 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:39:19,764 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:39:19,940 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:39:19,940 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:39:19,941 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:39:31,913 - INFO - app.core.security - Closing Redis connection...
2025-07-08 20:39:31,915 - INFO - app.core.security - Redis connection closed.
2025-07-08 20:44:04,311 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 20:44:04,314 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 20:44:06,354 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 20:44:06,355 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 20:44:06,373 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 20:44:06,373 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 20:44:06,373 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 20:44:06,373 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 9, 4, 19, 6, 373076), 'iat': datetime.datetime(2025, 7, 9, 3, 44, 6, 373082)}
2025-07-08 20:44:06,373 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 20:44:12,649 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:44:12,649 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:44:12,650 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:21,110 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:44:21,110 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:44:21,110 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:21,110 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:21,110 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 20:44:21,110 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:44:21,110 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:44:21,110 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:21,111 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:21,111 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:44:21,115 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:44:21,115 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:44:21,115 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:44:22,962 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:44:22,963 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:44:22,963 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:22,963 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:22,963 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 20:44:22,963 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:44:22,963 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:44:22,964 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:22,964 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:22,964 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:44:22,968 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:44:22,969 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:44:22,969 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:44:29,659 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:44:29,659 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:44:29,660 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:29,660 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:29,660 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:44:29,664 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:44:29,664 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:44:31,848 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:44:31,848 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:44:31,848 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:31,848 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:31,848 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:44:31,850 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:44:31,850 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:44:34,996 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:44:34,996 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:44:34,997 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:34,997 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:34,997 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 20:44:34,997 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:44:34,997 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:44:34,997 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:34,997 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:34,998 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:44:35,002 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:44:35,002 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:44:35,002 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:44:35,027 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:44:35,028 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:44:35,028 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:35,028 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:35,028 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 20:44:35,029 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:44:35,029 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:44:35,029 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:35,029 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:35,029 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:44:35,031 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:44:35,032 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:44:35,032 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:35,032 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:35,032 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:44:35,036 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:44:35,036 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:44:35,036 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:44:35,040 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:44:35,041 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:44:35,144 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:44:35,144 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:44:35,144 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:35,144 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:35,144 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:44:35,146 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:44:35,146 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:44:35,226 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:44:35,226 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:44:35,227 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:35,227 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:35,227 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:44:35,229 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:44:35,229 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:44:35,455 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:44:35,455 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:44:35,455 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:44:45,721 - INFO - app.core.security - Closing Redis connection...
2025-07-08 20:44:45,723 - INFO - app.core.security - Redis connection closed.
2025-07-08 20:47:46,643 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 20:47:46,647 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 20:47:48,678 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 20:47:48,678 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 20:47:48,684 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 20:47:48,684 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 20:47:48,684 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 20:47:48,684 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 9, 4, 22, 48, 684185), 'iat': datetime.datetime(2025, 7, 9, 3, 47, 48, 684189)}
2025-07-08 20:47:48,684 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 20:47:53,034 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:47:53,034 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:47:53,034 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:48:10,286 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:48:10,286 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:48:10,287 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:48:10,287 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:48:10,287 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 20:48:10,287 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:48:10,287 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:48:10,287 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:48:10,287 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:48:10,287 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:48:10,289 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:48:10,289 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:48:10,289 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:48:10,848 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:48:10,848 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:48:10,849 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:48:10,849 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:48:10,849 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 20:48:10,849 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:48:10,849 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:48:10,849 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:48:10,849 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:48:10,849 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:48:10,850 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:48:10,850 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:48:10,851 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:48:15,621 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:48:15,621 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:48:15,622 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:48:15,622 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:48:15,622 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:48:15,623 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:48:15,623 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:48:17,704 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:48:17,704 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:48:17,704 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:48:17,704 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:48:17,704 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:48:17,706 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:48:17,706 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:48:38,372 - INFO - app.core.security - Closing Redis connection...
2025-07-08 20:48:38,373 - INFO - app.core.security - Redis connection closed.
2025-07-08 20:50:18,079 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 20:50:18,085 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 20:50:20,113 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 20:50:20,114 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 20:50:20,119 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 20:50:20,119 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 20:50:20,119 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 20:50:20,119 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 9, 4, 25, 20, 119468), 'iat': datetime.datetime(2025, 7, 9, 3, 50, 20, 119471)}
2025-07-08 20:50:20,119 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 20:50:21,974 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:50:21,974 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:50:21,974 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034158, 'iat': 1752032358}
2025-07-08 20:50:26,567 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 20:50:26,567 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 20:50:26,568 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 20:50:26,568 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 9, 4, 20, 26, 567185), 'iat': datetime.datetime(2025, 7, 9, 3, 50, 26, 567203)}
2025-07-08 20:50:26,569 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 20:50:26,570 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI2Mzc4MjYsImlhdCI6MTc1MjAzMzAyNn0.32k39hn_b0iOJGPdZJXMmnnkPp2LP1rUQeoElikbnYo, Expiry (seconds): 604800
2025-07-08 20:50:29,763 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 20:50:31,375 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:50:31,376 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:50:31,376 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:50:31,376 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:50:31,376 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 20:50:31,376 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:50:31,377 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:50:31,377 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:50:31,377 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:50:31,377 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:50:31,392 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:50:31,392 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:50:31,392 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:50:31,401 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:50:31,402 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:50:31,402 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:50:31,402 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:50:31,403 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 20:50:31,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:50:31,403 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:50:31,404 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:50:31,407 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:50:31,407 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:50:31,422 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:50:31,423 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:50:31,423 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:50:31,438 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:50:31,439 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:50:31,444 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:50:31,445 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:50:31,445 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:50:31,485 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:50:31,485 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:50:31,686 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:50:31,686 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:50:31,686 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:50:31,686 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:50:31,686 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:50:31,689 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:50:31,689 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:50:32,054 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:50:32,054 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:50:32,055 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:50:32,055 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:50:32,055 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:50:32,060 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:50:32,061 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:50:32,150 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:50:32,151 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:50:32,151 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:51:00,935 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:51:00,936 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:51:00,936 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:51:00,937 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:51:00,937 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 20:51:00,937 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:51:00,937 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:51:00,937 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:51:00,938 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:51:00,938 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:51:00,946 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:51:00,946 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:51:00,946 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:51:00,957 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:51:00,957 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:51:00,958 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:51:00,959 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:51:00,959 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 20:51:00,959 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:51:00,959 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:51:00,960 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:51:00,960 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:51:00,960 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:51:00,967 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:51:00,967 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:51:00,968 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:51:00,986 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:51:00,986 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:51:00,986 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:51:00,987 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:51:00,987 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:51:00,994 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:51:00,994 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:51:01,209 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:51:01,210 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:51:01,210 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:51:01,210 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:51:01,210 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:51:01,215 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:51:01,215 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:51:01,384 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:51:01,384 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:51:01,385 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:51:01,385 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:51:01,385 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:51:01,388 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:51:01,388 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:51:01,523 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:51:01,523 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:51:01,523 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:51:14,731 - INFO - app.core.security - Closing Redis connection...
2025-07-08 20:51:14,733 - INFO - app.core.security - Redis connection closed.
2025-07-08 20:55:24,267 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 20:55:24,272 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 20:55:26,301 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 20:55:26,301 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 20:55:26,307 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 20:55:26,308 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 20:55:26,308 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 20:55:26,308 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 9, 4, 30, 26, 307942), 'iat': datetime.datetime(2025, 7, 9, 3, 55, 26, 307946)}
2025-07-08 20:55:26,309 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 20:55:33,647 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:55:33,647 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:55:33,648 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:55:42,621 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 20:55:42,621 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 20:55:42,622 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:55:42,622 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 20:55:42,623 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 20:55:42,646 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 20:55:42,646 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 20:56:12,920 - INFO - app.core.security - Closing Redis connection...
2025-07-08 20:56:12,921 - INFO - app.core.security - Redis connection closed.
2025-07-08 21:03:17,946 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 21:03:17,949 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 21:03:19,975 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 21:03:19,975 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 21:03:19,978 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 21:03:19,978 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 21:03:19,978 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 21:03:19,978 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 9, 4, 38, 19, 978592), 'iat': datetime.datetime(2025, 7, 9, 4, 3, 19, 978594)}
2025-07-08 21:03:19,979 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 21:03:23,689 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:03:23,689 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:03:23,689 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:45,746 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:03:45,747 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:03:45,747 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:45,747 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:45,747 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:03:45,747 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:03:45,747 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:03:45,748 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:45,748 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:45,748 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:03:45,755 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:03:45,755 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:03:45,755 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:03:46,394 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:03:46,394 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:03:46,394 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:46,394 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:46,394 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:03:46,394 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:03:46,394 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:03:46,394 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:46,394 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:46,394 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:03:46,397 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:03:46,397 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:03:46,397 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:03:46,996 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:03:46,997 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:03:46,997 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:46,997 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:46,997 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:03:46,997 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:03:46,997 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:03:46,997 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:46,997 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:46,997 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:03:47,000 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:03:47,000 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:03:47,000 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:03:52,415 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:03:52,416 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:03:52,416 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:52,416 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:52,416 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:03:52,419 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:03:52,419 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:03:54,587 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:03:54,587 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:03:54,587 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:54,587 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:54,587 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:03:54,590 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:03:54,590 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:03:56,657 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:03:56,657 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:03:56,658 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:56,658 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:03:56,658 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:03:56,661 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:03:56,661 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:04:05,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:04:05,179 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:04:05,179 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:04:05,179 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:04:05,179 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:04:05,182 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:04:05,182 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:04:07,703 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:04:07,705 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:04:07,705 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:04:07,705 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752034826, 'iat': 1752033026}
2025-07-08 21:04:07,705 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:04:07,709 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:04:07,709 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:04:13,365 - INFO - app.core.security - Closing Redis connection...
2025-07-08 21:04:13,368 - INFO - app.core.security - Redis connection closed.
2025-07-08 21:13:07,991 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 21:13:07,995 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 21:13:10,049 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 21:13:10,049 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 21:13:10,052 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 21:13:10,052 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 21:13:10,052 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 21:13:10,052 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 9, 4, 48, 10, 52440), 'iat': datetime.datetime(2025, 7, 9, 4, 13, 10, 52442)}
2025-07-08 21:13:10,052 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 21:13:18,361 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 21:13:18,361 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 21:13:18,362 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 21:13:18,362 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 9, 4, 43, 18, 361593), 'iat': datetime.datetime(2025, 7, 9, 4, 13, 18, 361602)}
2025-07-08 21:13:18,362 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 21:13:18,363 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI2MzkxOTgsImlhdCI6MTc1MjAzNDM5OH0.RTiQDvyw9rMA15yXRV8EG9VbeIoIAMl7_XBvXXPfV3I, Expiry (seconds): 604800
2025-07-08 21:13:20,403 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 21:13:21,541 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:21,541 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:21,541 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:21,541 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:21,541 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:13:21,541 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:21,541 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:21,541 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:21,542 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:21,542 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:13:21,546 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:13:21,547 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:13:21,547 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:13:21,571 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:21,572 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:21,573 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:21,573 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:21,573 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:13:21,573 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:21,573 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:21,574 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:21,574 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:21,574 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:13:21,581 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:21,581 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:21,581 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:21,581 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:21,581 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:13:21,585 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:13:21,586 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:13:21,586 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:13:21,601 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:13:21,601 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:13:21,784 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:21,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:21,784 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:21,784 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:21,785 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:13:21,786 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:13:21,787 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:13:21,888 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:21,888 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:21,889 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:21,889 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:21,889 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:13:21,892 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:13:21,892 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:13:22,121 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:22,121 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:22,121 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:33,970 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:33,970 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:33,970 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:33,970 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:33,970 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:13:33,970 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:33,970 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:33,970 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:33,971 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:33,971 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:13:33,973 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:13:33,973 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:13:33,973 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:13:34,551 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:34,552 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:34,552 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:34,552 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:34,552 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:13:34,552 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:34,552 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:34,552 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:34,552 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:34,552 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:13:34,554 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:13:34,554 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:13:34,554 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:13:35,120 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:35,120 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:35,120 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:35,120 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:35,121 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:13:35,121 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:35,121 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:35,121 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:35,121 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:35,121 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:13:35,123 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:13:35,123 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:13:35,123 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:13:35,725 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:35,726 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:35,726 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:35,726 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:35,727 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:13:35,727 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:35,727 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:35,727 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:35,727 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:35,727 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:13:35,734 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:13:35,734 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:13:35,734 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:13:36,313 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:36,313 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:36,313 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:36,313 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:36,314 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:13:36,314 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:36,314 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:36,314 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:36,314 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:36,314 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:13:36,320 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:13:36,320 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:13:36,321 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:13:53,253 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:13:53,253 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:13:53,253 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:53,253 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:13:53,254 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:13:53,258 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:13:53,258 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:14:59,295 - INFO - app.core.security - Closing Redis connection...
2025-07-08 21:14:59,296 - INFO - app.core.security - Redis connection closed.
2025-07-08 21:20:32,784 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 21:20:32,788 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 21:20:34,821 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 21:20:34,821 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 21:20:34,824 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 21:20:34,825 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 21:20:34,825 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 21:20:34,825 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 9, 4, 55, 34, 824950), 'iat': datetime.datetime(2025, 7, 9, 4, 20, 34, 824952)}
2025-07-08 21:20:34,825 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 21:20:41,648 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:20:41,648 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:20:41,648 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:20:53,091 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:20:53,092 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:20:53,092 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:20:53,092 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:20:53,092 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:20:53,099 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:20:53,099 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:20:58,816 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:20:58,816 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:20:58,816 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:20:58,816 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:20:58,816 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:20:58,825 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:20:58,825 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:21:03,814 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:21:03,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:21:03,815 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:03,815 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:03,815 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:21:03,820 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:21:03,820 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:21:24,194 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:21:24,194 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:21:24,195 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:24,195 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:24,195 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:21:24,197 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:21:24,197 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:21:42,667 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:21:42,668 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:21:42,668 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:42,668 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:42,668 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:21:42,668 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:21:42,668 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:21:42,668 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:42,668 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:42,668 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:21:42,670 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:21:42,671 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:21:42,671 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:21:46,125 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:21:46,126 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:21:46,126 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:46,126 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:46,126 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:21:46,126 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:21:46,126 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:21:46,127 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:46,127 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:46,127 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:21:46,129 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:21:46,130 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:21:46,130 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:21:48,834 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:21:48,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:21:48,834 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:48,834 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:48,834 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:21:48,834 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:21:48,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:21:48,834 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:48,834 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:48,834 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:21:48,836 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:21:48,836 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:21:48,836 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:21:50,527 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:21:50,527 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:21:50,527 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:50,527 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:50,527 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:21:50,527 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:21:50,527 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:21:50,528 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:50,528 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:21:50,528 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:21:50,530 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:21:50,530 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:21:50,530 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:22:34,472 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:22:34,472 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:22:34,472 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:34,472 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:34,472 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:22:34,472 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:22:34,472 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:22:34,472 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:34,472 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:34,472 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:22:34,474 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:22:34,474 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:22:34,474 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:22:34,481 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:22:34,481 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:22:34,481 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:34,481 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:34,481 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:22:34,481 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:22:34,481 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:22:34,482 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:34,482 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:34,482 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:22:34,483 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:22:34,484 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:22:34,484 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:22:34,487 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:22:34,487 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:22:34,487 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:34,487 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:34,487 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:22:34,489 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:22:34,489 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:22:34,591 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:22:34,591 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:22:34,592 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:34,592 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:34,592 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:22:34,594 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:22:34,594 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:22:34,894 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:22:34,894 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:22:34,895 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:34,895 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:34,895 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:22:34,898 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:22:34,898 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:22:34,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:22:34,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:22:34,899 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:48,366 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:22:48,366 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:22:48,366 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:48,367 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:48,367 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:22:48,368 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:22:48,368 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:22:52,171 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:22:52,172 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:22:52,172 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:52,172 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:52,172 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:22:52,175 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:22:52,175 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:22:55,858 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:22:55,858 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:22:55,859 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:55,859 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:55,859 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:22:55,860 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:22:55,860 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:22:58,039 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:22:58,039 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:22:58,039 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:58,039 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:22:58,039 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:22:58,041 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:22:58,041 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:23:02,016 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:23:02,016 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:23:02,016 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:02,016 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:02,016 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:23:02,019 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:23:02,019 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:23:09,249 - INFO - app.core.security - Closing Redis connection...
2025-07-08 21:23:09,249 - INFO - app.core.security - Redis connection closed.
2025-07-08 21:23:16,607 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 21:23:16,614 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 21:23:18,634 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 21:23:18,634 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 21:23:18,638 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 21:23:18,638 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 21:23:18,638 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 21:23:18,638 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 9, 4, 58, 18, 638576), 'iat': datetime.datetime(2025, 7, 9, 4, 23, 18, 638579)}
2025-07-08 21:23:18,639 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 21:23:20,985 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:23:20,985 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:23:20,985 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:24,362 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:23:24,362 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:23:24,363 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:24,363 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:24,363 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:23:24,363 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:23:24,363 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:23:24,363 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:24,363 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:24,363 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:23:24,371 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:23:24,372 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:23:24,372 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:23:41,021 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:23:41,021 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:23:41,022 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:41,022 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:41,022 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:23:41,022 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:23:41,022 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:23:41,022 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:41,023 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:41,023 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:23:41,028 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:23:41,029 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:23:41,029 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:23:49,412 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:23:49,412 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:23:49,412 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:49,413 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:49,413 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:23:49,413 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:23:49,413 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:23:49,413 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:49,413 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:49,413 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:23:49,415 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:23:49,415 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:23:49,415 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:23:51,080 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:23:51,080 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:23:51,080 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:51,081 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:51,081 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:23:51,081 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:23:51,081 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:23:51,081 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:51,081 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:51,081 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:23:51,082 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:23:51,083 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:23:51,083 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:23:52,370 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:23:52,370 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:23:52,370 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:52,370 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:52,370 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:23:52,370 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:23:52,370 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:23:52,371 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:52,371 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:52,371 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:23:52,373 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:23:52,373 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:23:52,373 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:23:53,913 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:23:53,913 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:23:53,913 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:53,913 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:53,913 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:23:53,913 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:23:53,913 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:23:53,913 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:53,913 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:23:53,913 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:23:53,915 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:23:53,915 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:23:53,916 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:24:00,969 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:24:00,970 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:24:00,970 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:24:00,970 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:24:00,970 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:24:00,975 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:24:00,975 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:24:12,151 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:24:12,152 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:24:12,152 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:24:12,152 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:24:12,152 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:24:12,154 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:24:12,154 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:24:24,675 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:24:24,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:24:24,675 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:24:24,675 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:24:24,675 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:24:24,680 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:24:24,680 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:24:34,512 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:24:34,513 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:24:34,513 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:24:34,513 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:24:34,513 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:24:34,515 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:24:34,515 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:24:41,443 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:24:41,444 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:24:41,444 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:24:41,444 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:24:41,444 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:24:41,444 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:24:41,444 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:24:41,445 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:24:41,445 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:24:41,445 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:24:41,447 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:24:41,448 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:24:41,448 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:24:47,671 - INFO - app.core.security - Closing Redis connection...
2025-07-08 21:24:47,673 - INFO - app.core.security - Redis connection closed.
2025-07-08 21:25:26,676 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 21:25:26,681 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 21:25:28,720 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 21:25:28,720 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 21:25:28,724 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 21:25:28,724 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 21:25:28,725 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 21:25:28,725 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 9, 5, 0, 28, 724942), 'iat': datetime.datetime(2025, 7, 9, 4, 25, 28, 724944)}
2025-07-08 21:25:28,725 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 21:25:30,688 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:25:30,688 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:25:30,689 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:25:30,689 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:25:30,689 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:25:30,689 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:25:30,689 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:25:30,689 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:25:30,690 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:25:30,690 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:25:30,711 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:25:30,711 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:25:30,712 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:25:30,739 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:25:30,739 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:25:30,740 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:25:30,740 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:25:30,741 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:25:30,741 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:25:30,741 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:25:30,741 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:25:30,742 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:25:30,742 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:25:30,747 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:25:30,748 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:25:30,748 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:25:30,760 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:25:30,761 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:25:30,761 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:25:30,761 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:25:30,761 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:25:30,767 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:25:30,767 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:25:30,988 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:25:30,988 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:25:30,989 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:25:30,989 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:25:30,989 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:25:30,992 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:25:30,992 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:25:31,158 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:25:31,158 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:25:31,158 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:25:31,158 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:25:31,158 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:25:31,161 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:25:31,161 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:25:31,339 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:25:31,339 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:25:31,339 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:25:52,404 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:25:52,404 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:25:52,404 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:25:52,405 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:25:52,405 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:25:52,410 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:25:52,411 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:26:08,715 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:26:08,715 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:26:08,716 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:26:08,716 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:26:08,716 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:26:08,721 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:26:08,721 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:26:15,826 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:26:15,826 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:26:15,827 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:26:15,827 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:26:15,827 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:26:15,833 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:26:15,833 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:26:35,847 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:26:35,848 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:26:35,848 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:26:35,848 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:26:35,848 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:26:35,853 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:26:35,853 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:26:44,096 - INFO - app.core.security - Closing Redis connection...
2025-07-08 21:26:44,096 - INFO - app.core.security - Redis connection closed.
2025-07-08 21:26:51,624 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 21:26:51,629 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 21:26:53,687 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 21:26:53,687 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 21:26:53,692 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 21:26:53,692 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 21:26:53,692 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 21:26:53,692 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 9, 5, 1, 53, 692187), 'iat': datetime.datetime(2025, 7, 9, 4, 26, 53, 692190)}
2025-07-08 21:26:53,692 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 21:26:55,982 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:26:55,982 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:26:55,983 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:27:06,087 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:27:06,087 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:27:06,087 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:27:06,087 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:27:06,087 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:27:06,097 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:27:06,097 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:27:38,940 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:27:38,940 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:27:38,940 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:27:38,940 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:27:38,940 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:27:38,944 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:27:38,944 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:27:55,131 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:27:55,132 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:27:55,132 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:27:55,132 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:27:55,132 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:27:55,149 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:27:55,149 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:27:59,933 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:27:59,933 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:27:59,934 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:27:59,934 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:27:59,934 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:27:59,940 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:27:59,940 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:28:08,600 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:28:08,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:28:08,601 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:28:08,601 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:28:08,601 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:28:08,605 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:28:08,605 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:28:21,871 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:28:21,871 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:28:21,872 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:28:21,872 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:28:21,872 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:28:21,878 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:28:21,878 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:28:35,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:28:35,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:28:35,862 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:28:35,863 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:28:35,863 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:28:35,871 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:28:35,872 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:28:51,445 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:28:51,445 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:28:51,445 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:28:51,445 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752036198, 'iat': 1752034398}
2025-07-08 21:28:51,445 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:28:51,447 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:28:51,447 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:29:00,798 - INFO - app.core.security - Closing Redis connection...
2025-07-08 21:29:00,799 - INFO - app.core.security - Redis connection closed.
2025-07-08 21:43:45,623 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 21:43:45,629 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 21:43:47,650 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 21:43:47,651 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 21:43:47,656 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 21:43:47,656 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 21:43:47,656 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 21:43:47,656 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 9, 5, 18, 47, 656469), 'iat': datetime.datetime(2025, 7, 9, 4, 43, 47, 656474)}
2025-07-08 21:43:47,657 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 21:43:53,973 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:43:53,973 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:43:53,974 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 21:43:59,336 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:43:59,336 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:43:59,337 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 21:44:05,639 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:05,639 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:05,639 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 21:44:08,675 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:08,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:08,675 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-08 21:44:08,676 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-08 21:44:11,996 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 21:44:11,996 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 21:44:11,996 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 21:44:11,996 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 9, 5, 14, 11, 995950), 'iat': datetime.datetime(2025, 7, 9, 4, 44, 11, 995966)}
2025-07-08 21:44:11,997 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 21:44:11,997 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI2NDEwNTEsImlhdCI6MTc1MjAzNjI1MX0.vPKc_EkAG5D-XBWaH-Kl0DsKn6hWWnsCdbX7V5ZIFRA, Expiry (seconds): 604800
2025-07-08 21:44:11,999 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 21:44:13,164 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:13,164 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:13,164 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:13,164 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:13,164 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:44:13,164 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:13,164 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:13,165 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:13,165 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:13,165 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:44:13,169 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:44:13,169 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:44:13,169 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:44:13,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:13,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:13,179 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:13,179 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:13,179 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:44:13,179 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:13,179 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:13,180 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:13,180 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:13,180 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:44:13,185 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:44:13,186 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:44:13,186 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:44:13,189 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:13,189 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:13,192 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:13,192 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:13,192 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:44:13,201 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:44:13,202 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:44:13,487 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:13,488 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:13,489 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:13,490 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:13,490 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:44:13,496 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:44:13,496 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:44:13,725 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:13,726 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:13,726 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:13,726 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:13,726 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:44:13,735 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:44:13,735 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:44:13,813 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:13,813 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:13,814 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:19,954 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:19,954 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:19,954 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:19,954 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:19,954 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:44:19,955 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:19,955 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:19,955 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:19,955 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:19,955 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:44:19,959 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:44:19,960 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:44:19,960 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:44:20,580 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:20,580 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:20,580 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:20,581 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:20,581 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:44:20,581 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:20,581 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:20,581 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:20,581 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:20,581 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:44:20,584 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:44:20,585 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:44:20,585 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:44:21,223 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:21,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:21,224 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:21,225 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:21,225 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:44:21,225 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:21,225 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:21,225 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:21,225 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:21,226 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:44:21,234 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:44:21,234 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:44:21,235 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:44:26,611 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:26,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:26,611 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:26,612 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:26,612 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:44:26,612 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:26,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:26,613 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:26,613 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:26,613 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:44:26,617 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:44:26,617 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:44:26,617 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:44:33,988 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:33,988 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:33,989 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:33,989 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:33,989 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:44:33,999 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:44:33,999 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:44:40,076 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:40,076 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:40,076 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:40,077 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:40,077 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:44:40,085 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:44:40,085 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:44:58,408 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:44:58,408 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:44:58,409 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:58,409 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:44:58,409 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:44:58,415 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:44:58,415 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:45:18,486 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:45:18,487 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:45:18,487 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:45:18,487 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:45:18,487 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:45:18,487 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:45:18,487 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:45:18,487 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:45:18,488 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:45:18,488 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:45:18,492 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:45:18,492 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:45:18,492 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:49:55,401 - INFO - app.core.security - Closing Redis connection...
2025-07-08 21:49:55,402 - INFO - app.core.security - Redis connection closed.
2025-07-08 21:51:26,388 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 21:51:26,392 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 21:51:28,445 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 21:51:28,445 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 21:51:28,452 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 21:51:28,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 21:51:28,452 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 21:51:28,452 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 9, 5, 26, 28, 452432), 'iat': datetime.datetime(2025, 7, 9, 4, 51, 28, 452439)}
2025-07-08 21:51:28,453 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 21:51:34,003 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:51:34,003 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:51:34,004 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:51:34,004 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:51:34,004 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:51:34,035 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:51:34,035 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:51:34,035 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIwMzgwNTEsImlhdCI6MTc1MjAzNjI1MX0.9VnfHLxrgdYU7y3W-YLdgY764eiiYvsvdt4sbYBhcTA
2025-07-08 21:51:35,369 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:51:35,369 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:51:35,369 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:51:35,993 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:51:35,994 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:51:35,994 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:51:35,995 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038051, 'iat': 1752036251}
2025-07-08 21:51:35,995 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:51:36,027 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:51:36,027 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:51:36,028 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIwMzgwNTEsImlhdCI6MTc1MjAzNjI1MX0.9VnfHLxrgdYU7y3W-YLdgY764eiiYvsvdt4sbYBhcTA
2025-07-08 21:51:36,452 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIwMzgwNTEsImlhdCI6MTc1MjAzNjI1MX0.9VnfHLxrgdYU7y3W-YLdgY764eiiYvsvdt4sbYBhcTA
2025-07-08 21:51:38,500 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIwMzgwNTEsImlhdCI6MTc1MjAzNjI1MX0.9VnfHLxrgdYU7y3W-YLdgY764eiiYvsvdt4sbYBhcTA
2025-07-08 21:51:39,830 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 21:51:39,831 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 21:51:39,831 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 21:51:39,832 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 9, 5, 21, 39, 830904), 'iat': datetime.datetime(2025, 7, 9, 4, 51, 39, 830916)}
2025-07-08 21:51:39,832 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 21:51:39,833 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI2NDE0OTksImlhdCI6MTc1MjAzNjY5OX0.XsiTTeAfcYx0PZ7txpV6rEFVq-MbK2G4zDAdfNeG3vc, Expiry (seconds): 604800
2025-07-08 21:51:40,616 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 21:51:41,742 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:51:41,742 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:51:41,742 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:51:41,742 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:51:41,742 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:51:41,742 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:51:41,742 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:51:41,743 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:51:41,743 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:51:41,743 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:51:41,747 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:51:41,747 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:51:41,747 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:51:41,755 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:51:41,755 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:51:41,756 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:51:41,756 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:51:41,756 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:51:41,756 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:51:41,756 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:51:41,756 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:51:41,756 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:51:41,756 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:51:41,760 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:51:41,760 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:51:41,760 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:51:41,768 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:51:41,768 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:51:41,770 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:51:41,770 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:51:41,770 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:51:41,775 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:51:41,775 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:51:42,045 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:51:42,045 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:51:42,046 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:51:42,046 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:51:42,046 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:51:42,051 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:51:42,051 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:51:42,238 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:51:42,238 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:51:42,238 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:51:42,238 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:51:42,238 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:51:42,242 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:51:42,242 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:51:42,364 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:51:42,364 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:51:42,365 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:52:10,684 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:52:10,684 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:52:10,684 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:52:10,684 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:52:10,684 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:52:10,687 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:52:10,688 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:52:16,225 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:52:16,225 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:52:16,226 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:52:16,226 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:52:16,226 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:52:16,231 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:52:16,232 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:52:39,779 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:52:39,779 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:52:39,779 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:52:39,780 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:52:39,780 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:52:39,786 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:52:39,787 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:53:11,276 - INFO - app.core.security - Closing Redis connection...
2025-07-08 21:53:11,277 - INFO - app.core.security - Redis connection closed.
2025-07-08 21:53:22,315 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-08 21:53:22,319 - INFO - app.core.security - Redis connection details:
  Host: localhost
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-08 21:53:24,365 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-08 21:53:24,365 - INFO - app.core.security - [SUCCESS] Connected to Redis at localhost (127.0.0.1):6379
2025-07-08 21:53:24,369 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 21:53:24,369 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 21:53:24,369 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 21:53:24,369 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 9, 5, 28, 24, 369055), 'iat': datetime.datetime(2025, 7, 9, 4, 53, 24, 369057)}
2025-07-08 21:53:24,369 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 21:53:26,612 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:53:26,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:53:26,613 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:53:26,613 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038499, 'iat': 1752036699}
2025-07-08 21:53:26,613 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:53:26,708 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:53:26,708 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:53:26,708 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIwMzg0OTksImlhdCI6MTc1MjAzNjY5OX0.ozC4V_g1gFfZhzRpwKnWZpOCplPbAKX-Ijt1ITZ6KMs
2025-07-08 21:53:32,486 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIwMzg0OTksImlhdCI6MTc1MjAzNjY5OX0.ozC4V_g1gFfZhzRpwKnWZpOCplPbAKX-Ijt1ITZ6KMs
2025-07-08 21:53:33,672 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-08 21:53:33,673 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-08 21:53:33,673 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-08 21:53:33,673 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 9, 5, 23, 33, 672688), 'iat': datetime.datetime(2025, 7, 9, 4, 53, 33, 672699)}
2025-07-08 21:53:33,673 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-08 21:53:33,674 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTI2NDE2MTMsImlhdCI6MTc1MjAzNjgxM30.y03JiZVZz5yXZgMD8uUtOUpImaEegioJZIIJZeNSI40, Expiry (seconds): 604800
2025-07-08 21:53:34,523 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-08 21:53:35,668 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:53:35,668 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:53:35,668 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:35,669 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:35,669 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:53:35,669 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:53:35,669 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:53:35,669 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:35,670 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:35,670 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:53:35,675 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:53:35,675 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:53:35,675 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:53:35,683 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:53:35,684 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:53:35,685 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:35,685 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:35,685 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:53:35,685 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:53:35,685 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:53:35,686 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:35,686 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:35,686 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:53:35,689 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:53:35,689 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:53:35,689 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:53:35,696 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:53:35,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:53:35,696 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:35,697 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:35,697 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:53:35,702 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:53:35,702 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:53:35,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:53:35,979 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:53:35,979 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:35,980 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:35,980 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:53:35,983 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:53:35,983 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:53:36,429 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:53:36,430 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:53:36,430 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:36,430 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:36,430 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:53:36,434 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:53:36,434 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:53:36,515 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:53:36,515 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:53:36,516 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:47,510 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:53:47,510 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:53:47,513 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:47,513 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:47,513 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:53:47,513 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:53:47,514 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:53:47,514 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:47,515 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:47,515 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:53:47,548 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:53:47,548 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:53:47,548 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:53:47,568 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:53:47,568 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:53:47,569 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:47,569 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:47,569 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-08 21:53:47,569 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:53:47,569 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:53:47,569 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:47,569 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:47,570 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:53:47,575 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:53:47,576 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:53:47,576 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:53:47,580 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:53:47,581 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:53:47,581 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:47,582 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:47,582 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:53:47,594 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:53:47,594 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:53:47,808 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:53:47,808 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:53:47,808 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:47,808 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:47,809 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:53:47,815 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:53:47,815 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:53:48,041 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:53:48,042 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:53:48,042 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:48,042 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:53:48,042 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-08 21:53:48,047 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-08 21:53:48,047 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-08 21:53:48,121 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-08 21:53:48,121 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-08 21:53:48,122 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752038613, 'iat': 1752036813}
2025-07-08 21:54:22,759 - INFO - app.core.security - Closing Redis connection...
2025-07-08 21:54:22,762 - INFO - app.core.security - Redis connection closed.
